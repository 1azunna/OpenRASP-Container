webpackJsonp([1],{"9M+g":function(t,a){},Jmt5:function(t,a){},NHnr:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var s=e("7+uW"),n={render:function(){var t=this.$createElement,a=this._self._c||t;return a("div",{attrs:{id:"app"}},[a("RouterView")],1)},staticRenderFns:[]},i=e("VU/8")({name:"App"},n,!1,null,null,null).exports,r=e("/ocq"),l=e("lbHh"),o=e.n(l),c=e("NYxO"),d=e("//Fk"),u=e.n(d),_=e("mtWM"),p=e.n(_),v={1002:"Agent registration",1003:"Agent delete",1004:"Reset AppSecret",1005:"Deliver general configuration",1006:"Distribute whitelist configuration",1007:"Send algorithm configuration",1008:"Send alarm configuration",1009:"Send detection plug-in",1010:"Upload plugin",1011:"Remove plugin",1012:"Create application",1013:"Delete application",1014:"Update application information",1015:"Reset plugin configuration"},m=[{name:"X-Frame-Options",descr:"click hijacking protection",options:[{name:"Do not open",value:void 0},{name:"Reject (deny)",value:"deny"},{name:"Only allow same origin (sameorigin)",value:"sameorigin"}]},{name:"X-Content-Type-Options",descr:"MIME sniffing protection",options:[{name:"Do not open",value:void 0},{name:"Open",value:"nosniff"}]},{name:"X-XSS-Protection",descr:"XSS Auditor protection",options:[{name:"Do not open",value:void 0},{name:"Intercept mode",value:"1; mode=block"}]},{name:"X-Download-Options",descr:"File download protection",options:[{name:"Do not open",value:void 0},{name:"Close automatic operation (noopen)",value:"noopen"}]}],h={3001:"Cookie httpOnly check",3002:"Process start account check",3003:"Background weak password check",3004:"Insecure default application check",3005:"Open Directory Check",3006:"Database connection account audit",3007:"JBoss background no authentication check",3009:"Web root directory sensitive files leaked",4001:"allow_url_include configuration audit",4002:"expose_php configuration audit",4003:"display_errors configuration audit",4004:"yaml.decode_php configuration audit"},f={sql:"SQL injection",sql_exception:"SQL statement exception",eval:"EVAL code execution",loadLibrary:"Class library loading",command:"Command execution",xxe:"XXE external entity loading",directory:"Directory traversal",rename:"File rename",readFile:"Any file read",deleteFile:"Any file delete",include:"Any file includes",writeFile:"Any file write",ssrf:"SSRF request forgery",ssrfRedirect:"SSRF request forgery (after redirection)",ognl:"OGNL code execution",webdav:"Any file upload (PUT)",fileUpload:"Any file upload",deserialization:"Transformer deserialization",xss_echo:"Echo XSS cross-site scripting attack",xss_userinput:"BODY XSS cross-site scripting attack",webshell_callable:"WebShell-Deformed Backdoor",webshell_eval:"WebShell-Chinese Kitchen Knife",webshell_command:"WebShell-command execution",webshell_file_put_contents:"WebShell-Backdoor upload",webshell_ld_preload:"WebShell-LD_PRELOAD backdoor",response:"HTTP response sampling detection",request:"Request start",link:"File link"},g={block:"Intercept request",log:"Record log"};function b(t,a){return t.replace(/\s/g,"").split(a).filter(function(t){return t})}function y(t){var a=!1;try{new RegExp(t)}catch(t){a="Regular expression error:"+t.toString()}return a}function k(t){return g[t]||t}function C(t){return"webshell"==t?"WebShell website backdoor":"xss"==t?"XSS cross-site scripting attack":f[t]||t}var w=p.a.create({baseURL:"/",timeout:8e3});w.interceptors.request.use(function(t){return t},function(t){console.error(t),u.a.reject(t)}),w.interceptors.response.use(function(t){var a=t.data;return 0!==a.status?(401===a.status?(o.a.set("RASP_AUTH_ID",null),"login"!==Va.currentRoute.name&&Va.push({name:"login",query:{redirect:location.href}})):alert(t.config.url+"Interface error:"+a.status+"-"+a.description),u.a.reject(a)):a.data},function(t){return alert("HTTP request error: response code "+t.response.status),console.error(t),u.a.reject(t)}),s.default.use(c.a);var x=new c.a.Store({state:{app_list:[],current_app:{},app_count:0,sticky:!0},mutations:{setCurrentApp:function(t,a){this.state.current_app=a},setAppList:function(t,a){this.state.app_list=a},setAppListCount:function(t,a){this.state.app_count=a},setSticky:function(t,a){this.state.sticky=a}},actions:{loadAppList:function(t,a){var e=t.commit;w.post("v1/api/app/get",{page:1,perpage:50}).then(function(t){var s=t.data,n=t.total;if(e("setAppList",s),e("setAppListCount",n),a){var i=s.find(function(t){return t.id===a});i?e("setCurrentApp",i):w.post("v1/api/app/get",{app_id:a}).then(function(t){t?e("setCurrentApp",t):(alert("Not this app: "+a),e("setCurrentApp",s[0]))})}else e("setCurrentApp",s[0])})}},getters:{app_list:function(t){return t.app_list},app_count:function(t){return t.app_count},current_app:function(t){return t.current_app},sticky:function(t){return t.sticky}}}),P={name:"Login",data:function(){return{username:"openrasp",password:"",title:"OpenRASP management background login",logo:""}},mounted:function(){this.updateLogo()},methods:{updateLogo:function(){var t=this;p.a.get("static/frontend.json").then(function(a){try{var e=a.data;e.enable&&(t.title=e.title,t.logo=e.logo,document.title=e.title)}catch(t){console.log(t)}}).catch(function(t){})},doLogin:function(){var t=this;return w.post("v1/user/login",{username:this.username,password:this.password}).then(function(a){t.$route.query.redirect?location.href=t.$route.query.redirect:t.$router.replace({name:"dashboard"})})}}},A={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"container"},[e("div",{staticClass:"row",staticStyle:{height:"100vh"}},[e("div",{staticClass:"col col-login m-auto"},[t.logo?e("div",{staticClass:"text-center mb-6"},[e("img",{staticStyle:{width:"100px"},attrs:{src:t.logo}})]):t._e(),t._v(" "),e("form",{staticClass:"card",on:{submit:function(a){return t.doLogin()}}},[e("div",{staticClass:"card-body p-6"},[e("div",{staticClass:"card-title text-center"},[t._v("\n            "+t._s(t.title)+"\n          ")]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n              username\n            ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.username,expression:"username",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.username},on:{input:function(a){a.target.composing||(t.username=a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[t._m(0),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],staticClass:"form-control",attrs:{type:"password",placeholder:"enter password",autocomplete:"off"},domProps:{value:t.password},on:{input:function(a){a.target.composing||(t.password=a.target.value)}}})]),t._v(" "),e("div",{staticClass:"form-footer"},[e("button",{staticClass:"btn btn-primary btn-block",attrs:{type:"submit",plain:!0},on:{click:function(a){return a.preventDefault(),t.doLogin()}}},[t._v("\n              log in\n            ")])])])])])])])},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("label",{staticClass:"form-label"},[this._v("\n              password\n              "),a("a",{staticClass:"float-right small",attrs:{href:"https://rasp.baidu.com/doc/install/panel.html#forget-password",target:"_blank"}},[this._v("\n                forget password?\n              ")])])}]},S=e("VU/8")(P,A,!1,null,null,null).exports,D=e("Dd8w"),E=e.n(D),j=e("0+QU"),M=e.n(j),q={name:"TopAttackType",components:{VueC3:M.a},data:function(){return{data:[],category_handler:new s.default}},methods:{setData:function(t){this.data=t;var a={size:{height:192},data:{columns:t,type:"pie",names:f},axis:{},legend:{show:!1},padding:{bottom:0,top:0}};this.category_handler.$emit("init",a)}}},N={render:function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticStyle:{height:"12rem"}},[a("VueC3",{directives:[{name:"show",rawName:"v-show",value:this.data.length,expression:"data.length"}],attrs:{handler:this.category_handler}}),this._v(" "),a("p",{directives:[{name:"show",rawName:"v-show",value:!this.data.length,expression:"! data.length"}],staticClass:"text-center",staticStyle:{display:"flex","justify-content":"center",height:"100%","align-items":"center"}},[this._v("\n    No data\n  ")])],1)},staticRenderFns:[]},R=e("VU/8")(q,N,!1,null,null,null).exports,U={name:"TopAttackUa",components:{VueC3:M.a},data:function(){return{source_handler:new s.default,data:[]}},methods:{setData:function(t){this.data=t;var a={size:{height:192},data:{columns:this.data,type:"donut",names:f},axis:{x:{tick:{width:200}}},legend:{show:!1},padding:{bottom:0,top:0},tooltip:{format:{name:function(t,a,e,s){return t.length>70?t.substr(0,70)+" ...":t}}}};this.source_handler.$emit("init",a)}}},T={render:function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticStyle:{height:"12rem"}},[a("VueC3",{directives:[{name:"show",rawName:"v-show",value:this.data.length,expression:"data.length"}],attrs:{handler:this.source_handler}}),this._v(" "),a("p",{directives:[{name:"show",rawName:"v-show",value:!this.data.length,expression:"! data.length"}],staticClass:"text-center",staticStyle:{display:"flex","justify-content":"center",height:"100%","align-items":"center"}},[this._v("\n    No data\n  ")])],1)},staticRenderFns:[]},L=e("VU/8")(U,T,!1,null,null,null).exports,O={name:"EventTrend",components:{VueC3:M.a},data:function(){return{trend_handler:new s.default}},methods:{setData:function(t){var a=this;t.data[0].unshift("Intercept request"),t.data[1].unshift("Log");var e={size:{height:250},data:{columns:t.data,type:"area",groups:[["data1","data2"]],colors:{data1:"#467fcf",data2:"#5eba00"},names:{data1:"Number of interceptions",data2:"Number of logs"}},axis:{y:{padding:{bottom:0},show:!1,tick:{outer:!1}},x:{padding:{left:0,right:0},show:!1}},legend:{position:"inset",padding:0,inset:{anchor:"top-left",x:20,y:8,step:10}},tooltip:{format:{title:function(e){return a.moment(t.labels[e]).format("YYYY-MM-DD")}}},padding:{bottom:0,left:-1,right:-1},point:{show:!1}};this.trend_handler.$emit("init",e)}}},I={render:function(){var t=this.$createElement;return(this._self._c||t)("VueC3",{staticStyle:{height:"15rem"},attrs:{handler:this.trend_handler}})},staticRenderFns:[]},F={name:"Dashboard",components:{TopAttackType:R,TopAttackUa:L,EventTrend:e("VU/8")(O,I,!1,null,null,null).exports},data:function(){return{}},computed:E()({},Object(c.c)(["current_app"])),watch:{current_app:function(){this.loadChartData()}},mounted:function(){this.current_app.id&&this.loadChartData()},methods:{loadChartData:function(){var t=this,a={app_id:this.current_app.id,size:10,start_time:1e3*this.moment().subtract(1,"months").unix(),end_time:1e3*this.moment().unix(),interval:"day",time_zone:"+08:00"};this.request.post("v1/api/log/attack/aggr/type",a).then(function(a){t.$refs.top_attack_type.setData(a)}),this.request.post("v1/api/log/attack/aggr/ua",a).then(function(a){t.$refs.top_attack_ua.setData(a)}),this.request.post("v1/api/log/attack/aggr/time",a).then(function(a){t.$refs.event_trend.setData(a)})}}},H={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"my-3 my-md-5"},[e("div",{staticClass:"container"},[t._e(),t._v(" "),e("div",{staticClass:"row row-cards"},[e("div",{staticClass:"col-lg-6"},[e("div",{staticClass:"card"},[t._m(6),t._v(" "),e("EventTrend",{ref:"event_trend"})],1)]),t._v(" "),e("div",{staticClass:"col-md-6"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-sm-6"},[e("div",{staticClass:"card"},[t._m(7),t._v(" "),e("div",{staticClass:"card-body"},[e("TopAttackUa",{ref:"top_attack_ua"})],1)])]),t._v(" "),e("div",{staticClass:"col-sm-6"},[e("div",{staticClass:"card"},[t._m(8),t._v(" "),e("div",{staticClass:"card-body"},[e("TopAttackType",{ref:"top_attack_type"})],1)])])])])])])])},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"col-6 col-sm-4 col-lg-2"},[a("div",{staticClass:"card"},[a("div",{staticClass:"card-body p-3 text-center"},[a("div",{staticClass:"text-right text-green"},[this._v("\n              6%\n              "),a("i",{staticClass:"fe fe-chevron-up"})]),this._v(" "),a("div",{staticClass:"h1 m-0"},[a("span",{staticClass:"text-danger"},[this._v("\n                1\n              ")])]),this._v(" "),a("div",{staticClass:"text-muted mb-4"},[this._v("\n              Untreated\n            ")])])])])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"col-6 col-sm-4 col-lg-2"},[a("div",{staticClass:"card"},[a("div",{staticClass:"card-body p-3 text-center"},[a("div",{staticClass:"text-right text-red"},[this._v("\n              -3%\n              "),a("i",{staticClass:"fe fe-chevron-down"})]),this._v(" "),a("div",{staticClass:"h1 m-0"},[this._v("\n              17\n            ")]),this._v(" "),a("div",{staticClass:"text-muted mb-4"},[this._v("\n              Number of interceptions\n            ")])])])])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"col-6 col-sm-4 col-lg-2"},[a("div",{staticClass:"card"},[a("div",{staticClass:"card-body p-3 text-center"},[a("div",{staticClass:"text-right text-green"},[this._v("\n              9%\n              "),a("i",{staticClass:"fe fe-chevron-up"})]),this._v(" "),a("div",{staticClass:"h1 m-0"},[this._v("\n              7\n            ")]),this._v(" "),a("div",{staticClass:"text-muted mb-4"},[this._v("\n             Number of releases\n            ")])])])])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"col-6 col-sm-4 col-lg-2"},[a("div",{staticClass:"card"},[a("div",{staticClass:"card-body p-3 text-center"},[a("div",{staticClass:"text-right text-green"},[this._v("\n              3%\n              "),a("i",{staticClass:"fe fe-chevron-up"})]),this._v(" "),a("div",{staticClass:"h1 m-0"},[this._v("\n              1\n            ")]),this._v(" "),a("div",{staticClass:"text-muted mb-4"},[this._v("\n              Online host\n            ")])])])])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"col-6 col-sm-4 col-lg-2"},[a("div",{staticClass:"card"},[a("div",{staticClass:"card-body p-3 text-center"},[a("div",{staticClass:"text-right text-red"},[this._v("\n              -2%\n              "),a("i",{staticClass:"fe fe-chevron-down"})]),this._v(" "),a("div",{staticClass:"h1 m-0"},[this._v("\n              3\n            ")]),this._v(" "),a("div",{staticClass:"text-muted mb-4"},[this._v("\n              Missing host\n            ")])])])])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"col-6 col-sm-4 col-lg-2"},[a("div",{staticClass:"card"},[a("div",{staticClass:"card-body p-3 text-center"},[a("div",{staticClass:"text-right text-red"},[this._v("\n              -1%\n              "),a("i",{staticClass:"fe fe-chevron-down"})]),this._v(" "),a("div",{staticClass:"h1 m-0"},[this._v("\n              10d\n            ")]),this._v(" "),a("div",{staticClass:"text-muted mb-4"},[this._v("\n              operation hours\n            ")])])])])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"card-header"},[a("h3",{staticClass:"card-title"},[this._v("\n             Attack trend\n            ")])])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"card-header"},[a("h3",{staticClass:"card-title"},[this._v("\n                 TOP 10 attacks on UA\n                ")])])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"card-header"},[a("h3",{staticClass:"card-title"},[this._v("\n                 TOP 10 attack types\n                ")])])}]},z=e("VU/8")(F,H,!1,null,null,null).exports,V=e("fZjL"),Y=e.n(V),B=e("PJh5"),W=e.n(B),X={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",["3001"==t.data.policy_id?e("div",[e("div",{staticClass:"h6"},[t._v("\n            Configuration file path\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.policy_params.config_file)+"\n        ")]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n            Problem Description\n        ")]),t._v(" "),t._m(0)]):t._e(),t._v(" "),"3005"==t.data.policy_id?e("div",[e("div",{staticClass:"h6"},[t._v("\n            Configuration file path\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.policy_params.config_file)+"\n        ")]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n            Problem Description\n        ")]),t._v(" "),t._m(1)]):t._e(),t._v(" "),"3007"==t.data.policy_id?e("div",[e("div",{staticClass:"h6"},[t._v("\n            Configuration file path\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.policy_params.config_file)+"\n        ")]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n            Problem Description\n        ")]),t._v(" "),t._m(2)]):t._e(),t._v(" "),"3002"==t.data.policy_id?e("div",[e("div",{staticClass:"h6"},[t._v("\n            Process PID\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.policy_params.pid)+"\n        ")]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n            Problem Description\n        ")]),t._v(" "),t._m(3)]):t._e(),t._v(" "),"3003"==t.data.policy_id?e("div",[t.data.policy_params.config_file?e("div",[e("div",{staticClass:"h6"},[t._v("\n                Configuration file path\n            ")]),t._v(" "),e("p",[t._v("\n                "+t._s(t.data.policy_params.config_file)+"\n            ")])]):t._e(),t._v(" "),t.data.policy_params.hostname&&t.data.policy_params.port?e("div",[e("div",{staticClass:"h6"},[t._v("\n                server information\n            ")]),t._v(" "),e("p",[t._v("\n                "+t._s(t.data.policy_params.hostname)+":"+t._s(t.data.policy_params.port)+"\n            ")])]):t._e(),t._v(" "),t.data.policy_params.socket?e("div",[e("div",{staticClass:"h6"},[t._v("\n                server information\n            ")]),t._v(" "),e("p",[t._v("\n                "+t._s(t.data.policy_params.socket)+"\n            ")])]):t._e(),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n            Weak password\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.policy_params.username)+":"+t._s(t.data.policy_params.password)+"\n        ")]),t._v(" "),t.data.stack_trace&&t.data.stack_trace.length?e("div",[e("div",{staticClass:"h6"},[t._v("\n                Application stack\n            ")]),t._v(" "),e("pre",[t._v(t._s(t.data.stack_trace))])]):t._e(),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n            Problem Description\n        ")]),t._v(" "),t.data.policy_params.server?e("p",[t._v("\n            "+t._s(t.data.policy_params.server)+" There is a weak password. If the account is blasted, there is a risk of data leakage.\n            "),e("a",{attrs:{href:"https://rasp.baidu.com/doc/usage/security_policy.html#3003",target:"_blank"}},[t._v("Click here")]),t._v(" to learn more.\n        ")]):t.data.policy_params.type?e("p",[t._v("\n            "+t._s(t.data.policy_params.type)+" There is a weak password.\n            "),e("a",{attrs:{href:"https://rasp.baidu.com/doc/usage/security_policy.html#3003",target:"_blank"}},[t._v("Click here")]),t._v(" to learn more.\n        ")]):e("p",[t._v("\n            There is a weak password in the Tomcat management background. If the management background is exposed to the outside, there is a risk of intrusion.\n            "),e("a",{attrs:{href:"https://rasp.baidu.com/doc/usage/security_policy.html#3003",target:"_blank"}},[t._v("Click here")]),t._v(" to learn more.\n        ")])]):t._e(),t._v(" "),"3004"==t.data.policy_id?e("div",[e("div",{staticClass:"h6"},[t._v("\n            webapps path\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.policy_params.path)+"\n        ")]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n            List of default apps not deleted\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.policy_params.apps.join(", "))+"\n        ")]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n            Problem Description\n        ")]),t._v(" "),t._m(4)]):t._e(),t._v(" "),"3006"==t.data.policy_id?e("div",[e("div",{staticClass:"h6"},[t._v("\n            Database type\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.policy_params.server)+"\n        ")]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n            username\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.policy_params.username)+"\n        ")]),t._v(" "),t.data.policy_params.connectionString?e("div",{staticClass:"h6"},[t._v("\n            connectionString\n        ")]):t._e(),t._v(" "),t.data.policy_params.connectionString?e("p",[t._v("\n            "+t._s(t.data.policy_params.connectionString)+"\n        ")]):t._e(),t._v(" "),t.data.policy_params.socket?e("div",{staticClass:"h6"},[t._v("\n            UNIX socket path\n        ")]):t._e(),t._v(" "),t.data.policy_params.socket?e("p",[t._v("\n            "+t._s(t.data.policy_params.socket)+"\n        ")]):t._e(),t._v(" "),t.data.stack_trace&&t.data.stack_trace.length?e("div",[e("div",{staticClass:"h6"},[t._v("\n                Application stack\n            ")]),t._v(" "),e("pre",[t._v(t._s(t.data.stack_trace))])]):t._e(),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n            Problem Description\n        ")]),t._v(" "),t._m(5)]):t._e(),t._v(" "),"3009"==t.data.policy_id?e("div",[e("div",{staticClass:"h6"},[t._v("\n            Problem Description\n        ")]),t._v(" "),t._m(6),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n            Web root directory\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.policy_params.webroot)+"\n        ")]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n            List of sensitive files\n        ")]),t._v(" "),e("ul",t._l(t.data.policy_params.files,function(a,s){return e("li",{key:s},[t._v("\n                "+t._s(a)+"\n            ")])}),0)]):t._e(),t._v(" "),"4001"==t.data.policy_id?e("div",[e("div",{staticClass:"h6"},[t._v("\n            Problem Description\n        ")]),t._v(" "),t._m(7)]):t._e(),t._v(" "),"4002"==t.data.policy_id?e("div",[e("div",{staticClass:"h6"},[t._v("\n            Problem Description\n        ")]),t._v(" "),t._m(8)]):t._e(),t._v(" "),"4003"==t.data.policy_id?e("div",[e("div",{staticClass:"h6"},[t._v("\n            Problem Description\n        ")]),t._v(" "),t._m(9)]):t._e(),t._v(" "),"4004"==t.data.policy_id?e("div",[e("div",{staticClass:"h6"},[t._v("\n            Problem Description\n        ")]),t._v(" "),t._m(10)]):t._e()])},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("p",[this._v("\n            JSESSIONID does not enable httpOnly. If enabled, the server's protection against XSS can be improved.\n            "),a("a",{attrs:{href:"https://rasp.baidu.com/doc/usage/security_policy.html#3001",target:"_blank"}},[this._v("Click here")]),this._v(" to learn more.\n        ")])},function(){var t=this.$createElement,a=this._self._c||t;return a("p",[this._v("\n            Enabling the Directory Listing function may reveal sensitive information such as project code and configuration.\n            "),a("a",{attrs:{href:"https://rasp.baidu.com/doc/usage/security_policy.html#3005",target:"_blank"}},[this._v("Click here")]),this._v(" to learn more.\n        ")])},function(){var t=this.$createElement,a=this._self._c||t;return a("p",[this._v("\n            Starting the application server with root/Administrator/system authority will cause huge risks.\n            "),a("a",{attrs:{href:"https://rasp.baidu.com/doc/usage/security_policy.html#3007",target:"_blank"}},[this._v("Click here")]),this._v(" to learn more.\n        ")])},function(){var t=this.$createElement,a=this._self._c||t;return a("p",[this._v("\n            Starting the application server with root privileges will create huge risks.\n            "),a("a",{attrs:{href:"https://rasp.baidu.com/doc/usage/security_policy.html#3002",target:"_blank"}},[this._v("Click here")]),this._v(" to learn more.\n        ")])},function(){var t=this.$createElement,a=this._self._c||t;return a("p",[this._v("\n            Failure to delete tomcat's default app will more or less leak sensitive information or cause the risk of external exposure to the management background.\n            "),a("a",{attrs:{href:"https://rasp.baidu.com/doc/usage/security_policy.html#3004",target:"_blank"}},[this._v("Click here")]),this._v(" to learn more.\n        ")])},function(){var t=this.$createElement,a=this._self._c||t;return a("p",[this._v("\n            When there are SQL injection vulnerabilities, using a high-privileged account to connect to the database will bring greater risks and leak more data.\n            "),a("a",{attrs:{href:"https://rasp.baidu.com/doc/usage/security_policy.html#3004",target:"_blank"}},[this._v("Click here")]),this._v(" to learn more.\n        ")])},function(){var t=this.$createElement,a=this._self._c||t;return a("p",[this._v("\n            There are compressed packages or other sensitive files in the web root directory. If downloaded by the outside world, the source code and website backup may be leaked, increasing the risk of website intrusion.\n            "),a("a",{attrs:{href:"https://rasp.baidu.com/doc/usage/security_policy.html#3009",target:"_blank"}},[this._v("Click here")]),this._v(" to learn more.\n        ")])},function(){var t=this.$createElement,a=this._self._c||t;return a("p",[this._v("\n            allow_url_include is not closed. When the application has vulnerabilities such as file inclusion and arbitrary file reading, enabling this configuration will make the application more vulnerable to intrusion.\n            "),a("a",{attrs:{href:"https://rasp.baidu.com/doc/usage/security_policy.html#4001",target:"_blank"}},[this._v("Click here")]),this._v(" to learn more.\n        ")])},function(){var t=this.$createElement,a=this._self._c||t;return a("p",[this._v("\n            Expose_php is not closed, it will reveal the PHP version number.\n            "),a("a",{attrs:{href:"https://rasp.baidu.com/doc/usage/security_policy.html#4002",target:"_blank"}},[this._v("Click here")]),this._v(" to learn more.\n        ")])},function(){var t=this.$createElement,a=this._self._c||t;return a("p",[this._v("\n            The display_errors is not closed, and the user can see the error message of the PHP program in the foreground.\n            "),a("a",{attrs:{href:"https://rasp.baidu.com/doc/usage/security_policy.html#4002",target:"_blank"}},[this._v("Click here")]),this._v(" to learn more.\n        ")])},function(){var t=this.$createElement,a=this._self._c||t;return a("p",[this._v("\n            yaml.decode_php is not closed and will allow YAML to deserialize PHP objects. If the application has vulnerabilities, the server can be compromised.\n            "),a("a",{attrs:{href:"https://rasp.baidu.com/doc/usage/security_policy.html#4002",target:"_blank"}},[this._v("Click here")]),this._v(" to learn more.\n        ")])}]},J={name:"baselineDetailModal",data:function(){return{tabIndex:0,tabs:["报警信息","资产信息"],data:{}}},methods:{showModal:function(t){this.tabIndex=0,this.data=t,this.$refs.baseline_params.setData(t),$("#showBaselineDetailModal").modal()}},components:{baseline_params:e("VU/8")({name:"baseline_params",data:function(){return{data:{policy_params:{}}}},methods:{setData:function(t){this.data=t,t.policy_params||(t.policy_params={}),!t.stack_trace&&t.policy_params.stack&&(t.stack_trace=t.policy_params.stack.join("\n"))}}},X,!1,null,null,null).exports}},Q={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"modal no-fade",attrs:{id:"showBaselineDetailModal",tabindex:"-1",role:"dialog"}},[e("div",{staticClass:"modal-dialog modal-lg",attrs:{role:"document"}},[e("div",{staticClass:"modal-content"},[t._m(0),t._v(" "),e("div",{staticClass:"modal-body",staticStyle:{"padding-top":"0"}},[e("ul",{staticClass:"nav nav-tabs",attrs:{id:"myTab",role:"tablist"}},t._l(t.tabs,function(a,s){return e("li",{key:s,staticClass:"nav-item"},[e("a",{class:{"nav-link":!0,active:t.tabIndex==s},attrs:{href:"javascript:"},on:{click:function(a){t.tabIndex=s}}},[t._v("\n              "+t._s(a)+"\n            ")])])}),0),t._v(" "),e("br"),t._v(" "),e("div",{staticClass:"tab-content",attrs:{id:"myTabContent"}},[e("div",{class:{"tab-pane":!0,fade:!0,show:0==t.tabIndex,active:0==t.tabIndex}},[e("div",{staticClass:"h6"},[t._v("\n              Alarm time\n            ")]),t._v(" "),e("p",[t._v(t._s(t.moment(t.data.event_time).format("YYYY-MM-DD HH:mm:ss")))]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n              Alarm message\n            ")]),t._v(" "),e("p",[t._v("\n              ["+t._s(t.data.policy_id)+"] "+t._s(t.data.message)+"\n            ")]),t._v(" "),e("baseline_params",{ref:"baseline_params"})],1),t._v(" "),e("div",{class:{"tab-pane":!0,fade:!0,show:1==t.tabIndex,active:1==t.tabIndex}},[e("div",{staticClass:"h6"},[t._v("\n              Host name\n            ")]),t._v(" "),e("p",[t._v(t._s(t.data.server_hostname))]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n              Server IP\n            ")]),t._v(" "),e("ul",t._l(t.data.server_nic,function(a){return e("li",{key:a.name},[t._v(t._s(a.name)+": "+t._s(a.ip))])}),0),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n              RASP version\n            ")]),t._v(" "),e("p",[t._v("\n              "+t._s(t.data.rasp_version)+"\n            ")]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n              App version\n            ")]),t._v(" "),e("p",[t._v(t._s(t.data.server_type)+"/"+t._s(t.data.server_version))])])])]),t._v(" "),t._m(1)])])])},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"modal-header"},[a("h5",{staticClass:"modal-title"},[this._v("Baseline details")]),this._v(" "),a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}})])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"modal-footer"},[a("button",{staticClass:"btn btn-primary",attrs:{"data-dismiss":"modal"}},[this._v("关闭")])])}]},K=e("VU/8")(J,Q,!1,null,null,null).exports,G=(e("PL/P"),{name:"DatePicker",data:function(){return{start:W()().subtract(1,"months").startOf("day"),end:W()().endOf("day")}},mounted:function(){var t=this;window.$(this.$refs.daterangepicker).daterangepicker({startDate:this.start,endDate:this.end},function(a,e,s){t.start=a,t.end=e,t.$emit("selected"),t.$emit("change",{start:a,end:e})})}}),Z={render:function(){var t=this.$createElement;return(this._self._c||t)("input",{ref:"daterangepicker",staticClass:"form-control",staticStyle:{width:"210px"},attrs:{type:"text",name:"daterange",autocomplete:"off"}})},staticRenderFns:[]},tt=e("VU/8")(G,Z,!1,null,null,null).exports,at=(e("RiEM"),{name:"Baseline",components:{baselineDetailModal:K,DatePicker:tt},data:function(){return{data:[],loading:!1,currentPage:1,hostname:"",total:0,baseline_types:h,message:"",selected:Y()(h)}},computed:E()({},Object(c.c)(["current_app"])),watch:{current_app:function(){this.loadEvents(1)},selected:function(){this.loadEvents(1)}},mounted:function(){this.current_app.id&&this.loadEvents(1)},methods:{ceil:Math.ceil,selectAll:function(t){var a=t.target;this.selected=a.checked?Y()(this.baseline_types):[]},showBaselineDetailModal:function(t){this.$refs.baselineDetailModal.showModal(t)},loadEvents:function(t){var a=this,e={data:{app_id:this.current_app.id,start_time:this.$refs.datePicker.start.valueOf(),end_time:this.$refs.datePicker.end.valueOf(),policy_id:this.selected,message:this.message},page:t,perpage:10};return this.hostname&&(e.data.server_hostname=this.hostname),this.loading=!0,this.request.post("v1/api/log/policy/search",e).then(function(e){a.currentPage=t,a.data=e.data,a.total=e.total,a.loading=!1})}}}),et={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"my-3 my-md-5"},[e("div",{staticClass:"container"},[e("div",{staticClass:"page-header"},[e("h1",{staticClass:"page-title"},[t._v("\n        Baseline check\n      ")]),t._v(" "),e("div",{staticClass:"page-options d-flex"},[e("div",{staticClass:"input-icon ml-2"},[t._m(0),t._v(" "),e("DatePicker",{ref:"datePicker",on:{selected:function(a){return t.loadEvents(1)}}})],1),t._v(" "),e("b-dropdown",{staticClass:"ml-2",attrs:{text:"Baseline type",left:""}},[e("b-container",{staticStyle:{width:"500px"}},[e("b-form-row",[e("b-col",[e("label",{staticClass:"custom-switch"},[e("input",{staticClass:"custom-switch-input",attrs:{type:"checkbox",checked:""},on:{change:t.selectAll}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v("\n                    select all\n                  ")])])]),t._v(" "),e("div",{staticClass:"w-100"}),t._v(" "),t._l(t.baseline_types,function(a,s,n){return[e("b-col",{key:s},[e("label",{staticClass:"custom-switch"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.selected,expression:"selected"}],staticClass:"custom-switch-input",attrs:{type:"checkbox"},domProps:{value:s,checked:Array.isArray(t.selected)?t._i(t.selected,s)>-1:t.selected},on:{change:function(a){var e=t.selected,n=a.target,i=!!n.checked;if(Array.isArray(e)){var r=s,l=t._i(e,r);n.checked?l<0&&(t.selected=e.concat([r])):l>-1&&(t.selected=e.slice(0,l).concat(e.slice(l+1)))}else t.selected=i}}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v("\n                      "+t._s(a)+"\n                    ")])])]),t._v(" "),n%2==1?e("div",{staticClass:"w-100"}):t._e()]})],2)],1)],1),t._v(" "),e("div",{staticClass:"input-icon ml-2"},[t._m(1),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.hostname,expression:"hostname",modifiers:{trim:!0}}],staticClass:"form-control w-10",attrs:{type:"text",placeholder:"搜索主机或者IP"},domProps:{value:t.hostname},on:{keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.loadEvents(1)},input:function(a){a.target.composing||(t.hostname=a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"input-icon ml-2"},[t._m(2),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.message,expression:"message",modifiers:{trim:!0}}],staticClass:"form-control w-10",attrs:{type:"text",placeholder:"过滤消息"},domProps:{value:t.message},on:{keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.loadEvents(1)},input:function(a){a.target.composing||(t.message=a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("button",{staticClass:"btn btn-primary ml-2",on:{click:function(a){return t.loadEvents(1)}}},[t._v("\n          search for\n        ")])],1)]),t._v(" "),e("div",{staticClass:"card"},[e("div",{staticClass:"card-body"},[t.loading?e("vue-loading",{attrs:{type:"spiningDubbles",color:"rgb(90, 193, 221)",size:{width:"50px",height:"50px"}}}):t._e(),t._v(" "),!t.loading&&t.total>0?e("nav",[e("ul",{staticClass:"pagination pull-left"},[e("li",{staticClass:"active"},[e("span",{staticStyle:{"margin-top":"0.5em",display:"block"}},[e("strong",[t._v(t._s(t.total))]),t._v("The results show that"+t._s(t.currentPage)+" / "+t._s(t.ceil(t.total/10))+" 页\n              ")])])]),t._v(" "),e("b-pagination",{attrs:{align:"right","total-rows":t.total,"per-page":10},on:{change:function(a){return t.loadEvents(a)}},model:{value:t.currentPage,callback:function(a){t.currentPage=a},expression:"currentPage"}})],1):t._e(),t._v(" "),t.loading?t._e():e("table",{staticClass:"table table-hover table-bordered"},[t._m(3),t._v(" "),e("tbody",t._l(t.data,function(a){return e("tr",{key:a.id},[e("td",{attrs:{nowrap:""}},[t._v("\n                "+t._s(t.moment(a.event_time).format("YYYY-MM-DD"))+"\n                "),e("br"),t._v("\n                "+t._s(t.moment(a.event_time).format("HH:mm:ss"))+"\n              ")]),t._v(" "),e("td",{attrs:{nowrap:""}},[t._v("\n                "+t._s(a.server_type)+"/"+t._s(a.server_version)+"\n              ")]),t._v(" "),e("td",{attrs:{nowrap:""}},[t._v("\n                "+t._s(a.server_hostname)+"\n              ")]),t._v(" "),e("td",[t._v("\n                ["+t._s(a.policy_id)+"] "+t._s(a.message)+"\n              ")]),t._v(" "),e("td",{attrs:{nowrap:""}},[e("a",{attrs:{href:"javascript:"},on:{click:function(e){return t.showBaselineDetailModal(a)}}},[t._v("\n                  see details\n                ")])])])}),0)]),t._v(" "),!t.loading&&t.total>10?e("nav",[e("ul",{staticClass:"pagination pull-left"},[e("li",{staticClass:"active"},[e("span",{staticStyle:{"margin-top":"0.5em",display:"block"}},[e("strong",[t._v(t._s(t.total))]),t._v(" The results show that"+t._s(t.currentPage)+" / "+t._s(t.ceil(t.total/10))+" 页\n              ")])])]),t._v(" "),e("b-pagination",{attrs:{align:"right","total-rows":t.total,"per-page":10},on:{change:function(a){return t.loadEvents(a)}},model:{value:t.currentPage,callback:function(a){t.currentPage=a},expression:"currentPage"}})],1):t._e(),t._v(" "),t.loading||0!=t.total?t._e():e("p",{staticClass:"text-center"},[t._v("No data")])],1)])]),t._v(" "),e("baselineDetailModal",{ref:"baselineDetailModal"})],1)},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("span",{staticClass:"input-icon-addon"},[a("i",{staticClass:"fe fe-calendar"})])},function(){var t=this.$createElement,a=this._self._c||t;return a("span",{staticClass:"input-icon-addon"},[a("i",{staticClass:"fe fe-search"})])},function(){var t=this.$createElement,a=this._self._c||t;return a("span",{staticClass:"input-icon-addon"},[a("i",{staticClass:"fe fe-search"})])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("thead",[e("tr",[e("th",{attrs:{nowrap:""}},[t._v("\n                Alarm time\n              ")]),t._v(" "),e("th",{attrs:{nowrap:""}},[t._v("\n               Application information\n              ")]),t._v(" "),e("th",{attrs:{nowrap:""}},[t._v("\n               Host information\n              ")]),t._v(" "),e("th",[t._v("\n               Alarm content\n              ")]),t._v(" "),e("th",[t._v("\n                operating\n              ")])])])}]},st=e("VU/8")(at,et,!1,null,null,null).exports,nt={name:"CrashDetailModal",data:function(){return{tabIndex:0,data:{url:"",stack_md5:"",stack_trace:""}}},methods:{showModal:function(t){this.tabIndex=0,this.data=t,this.data.stack_trace=t.crash_log.replace(/(^\s*)|(\s*$)/g,""),$("#showCrashDetailModal").modal()},env2str:function(t){var a="";for(var e in t)a=a+e+"="+t[e]+"\n";return a}}},it={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"modal no-fade",attrs:{id:"showCrashDetailModal",tabindex:"-1",role:"dialog"}},[e("div",{staticClass:"modal-dialog modal-lg",attrs:{role:"document"}},[e("div",{staticClass:"modal-content"},[t._m(0),t._v(" "),e("div",{staticClass:"modal-body",staticStyle:{"padding-top":"0","padding-bottom":"0"}},[t._m(1),t._v(" "),e("br"),t._v(" "),e("div",{staticClass:"tab-content",attrs:{id:"myTabContent"}},[e("div",{staticClass:"tab-pane fade show active",attrs:{id:"crash",role:"tabpanel","aria-labelledby":"crash-tab"}},[e("pre",{staticStyle:{"max-height":"400px","overflow-y":"scroll"}},[t._v(t._s(t.data.stack_trace))])]),t._v(" "),e("div",{staticClass:"tab-pane fade",attrs:{id:"basic",role:"tabpanel","aria-labelledby":"home-tab"}},[e("div",{staticClass:"h6"},[t._v("\n              Host name\n            ")]),t._v(" "),e("p",[t._v(t._s(t.data.hostname))]),t._v(" "),t.data.host_type?e("div",[e("div",{staticClass:"h6"},[t._v("\n                Container type\n              ")]),t._v(" "),e("p",[t._v(t._s(t.data.host_type))])]):t._e(),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n              Registration time\n            ")]),t._v(" "),e("p",[t._v(t._s(t.moment(1e3*t.data.register_time).format("YYYY-MM-DD HH:mm:ss")))]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n              Register IP\n            ")]),t._v(" "),e("p",{staticStyle:{"word-break":"break-all"}},[t._v("\n              "+t._s(t.data.register_ip)+"\n            ")]),t._v(" "),t.data.environ&&0!=Object.keys(t.data.environ).length?e("div",[e("div",{staticClass:"h6"},[t._v("\n                Environment variable\n              ")]),t._v(" "),e("pre",[t._v(t._s(t.env2str(t.data.environ)))])]):t._e()]),t._v(" "),e("div",{staticClass:"tab-pane fade",attrs:{id:"profile",role:"tabpanel","aria-labelledby":"profile-tab"}},[e("div",{staticClass:"h6"},[t._v("\n              Server version\n            ")]),t._v(" "),e("p",[t._v(t._s(t.data.language)+"/"+t._s(t.data.language_version))]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n              Agent version\n            ")]),t._v(" "),e("p",[t._v(t._s(t.data.version))]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n              Plugin version\n            ")]),t._v(" "),e("p",[t._v(t._s(t.data.plugin_version))]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n              RASP ID\n            ")]),t._v(" "),e("p",[t._v(t._s(t.data.id))])])])]),t._v(" "),t._m(2)])])])},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"modal-header"},[a("h5",{staticClass:"modal-title"},[this._v("\n          Crash details\n        ")]),this._v(" "),a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}})])},function(){var t=this.$createElement,a=this._self._c||t;return a("ul",{staticClass:"nav nav-tabs",attrs:{id:"myTab",role:"tablist"}},[a("li",{staticClass:"nav-item"},[a("a",{staticClass:"nav-link active",attrs:{id:"crash-tab","data-toggle":"tab",href:"#crash"}},[this._v("\n              Original log\n            ")])]),this._v(" "),a("li",{staticClass:"nav-item"},[a("a",{staticClass:"nav-link",attrs:{id:"home-tab","data-toggle":"tab",href:"#basic"}},[this._v("\n              Host information\n            ")])]),this._v(" "),a("li",{staticClass:"nav-item"},[a("a",{staticClass:"nav-link",attrs:{id:"profile-tab","data-toggle":"tab",href:"#profile"}},[this._v("\n              RASP information\n            ")])])])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"modal-footer"},[a("button",{staticClass:"btn btn-primary",attrs:{"data-dismiss":"modal"}},[this._v("\n          shut down\n        ")])])}]},rt={name:"Crash",components:{CrashDetailModal:e("VU/8")(nt,it,!1,null,null,null).exports,DatePicker:tt},data:function(){return{data:[],language_list:[{name:"Java",value:"java"},{name:"PHP",value:"php"}],loading:!1,currentPage:1,hostname:"",rasp_id:"",selected_language:["java","php"],crash_message:"",total:0}},computed:E()({},Object(c.c)(["current_app"])),watch:{current_app:function(){this.loadEvents(1)},selected:function(){this.loadEvents(1)},selected_language:function(){this.loadEvents(1)}},mounted:function(){this.current_app.id&&this.loadEvents(1)},methods:{ceil:Math.ceil,displayURL:function(t){return t.url?t.url.length>100?t.url.substring(0,100)+" ...":t.url:"-"},selectAll:function(t){var a=t.target;this.selected=a.checked?Y()(this.attack_types):[]},showEventDetail:function(t){this.$refs.crashDetailModal.showModal(t)},loadEvents:function(t){var a=this;return this.loading=!0,this.request.post("v1/api/log/crash/search",{data:{start_time:this.$refs.datePicker.start.valueOf(),end_time:this.$refs.datePicker.end.valueOf(),app_id:this.current_app.id,hostname:this.hostname,language:this.selected_language,rasp_id:this.rasp_id,crash_message:this.crash_message},page:t,perpage:10}).then(function(e){a.currentPage=t,a.data=e.data,a.total=e.total,a.loading=!1})}}},lt={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"my-3 my-md-5"},[e("div",{staticClass:"container"},[e("div",{staticClass:"page-header",staticStyle:{"flex-direction":"column",display:"flex"}},[e("div",{staticStyle:{display:"flex","flex-direction":"row","justify-content":"flex-start",width:"100%"}},[e("h1",{staticClass:"page-title",staticStyle:{"padding-top":"3px"}},[t._v("\n         Crash information\n        ")]),t._v(" "),e("div",{staticClass:"page-options d-flex",staticStyle:{"margin-top":"5px"}},[e("div",{staticClass:"input-icon ml-2"},[t._m(0),t._v(" "),e("DatePicker",{ref:"datePicker",on:{selected:function(a){return t.loadEvents(1)}}})],1),t._v(" "),e("div",{staticClass:"input-icon ml-2"},[t._m(1),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.hostname,expression:"hostname",modifiers:{trim:!0}}],staticClass:"form-control w-10",attrs:{type:"text",placeholder:"Host Name"},domProps:{value:t.hostname},on:{keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.loadEvents(1)},input:function(a){a.target.composing||(t.hostname=a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"input-icon ml-2"},[t._m(2),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.crash_message,expression:"crash_message",modifiers:{trim:!0}}],staticClass:"form-control w-10",staticStyle:{width:"210px"},attrs:{type:"text",placeholder:"Alarm Information"},domProps:{value:t.crash_message},on:{keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.loadEvents(1)},input:function(a){a.target.composing||(t.crash_message=a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("button",{staticClass:"btn btn-primary ml-2",staticStyle:{height:"38px"},on:{click:function(a){return t.loadEvents(1)}}},[t._v("\n            搜索\n          ")])])])]),t._v(" "),e("div",{staticClass:"card"},[e("div",{staticClass:"card-body"},[t.loading?e("VueLoading",{attrs:{type:"spiningDubbles",color:"rgb(90, 193, 221)",size:{width:"50px",height:"50px"}}}):t._e(),t._v(" "),!t.loading&&t.total>0?e("nav",[e("ul",{staticClass:"pagination pull-left"},[e("li",{staticClass:"active"},[e("span",{staticStyle:{"margin-top":"0.5em",display:"block"}},[e("strong",[t._v(t._s(t.total))]),t._v(" As a result, "+t._s(t.currentPage)+" /\n                "+t._s(t.ceil(t.total/10))+" 页\n              ")])])]),t._v(" "),e("b-pagination",{attrs:{align:"right","total-rows":t.total,"per-page":10},on:{change:function(a){return t.loadEvents(a)}},model:{value:t.currentPage,callback:function(a){t.currentPage=a},expression:"currentPage"}})],1):t._e(),t._v(" "),t.loading?t._e():e("table",{staticClass:"table table-striped table-bordered"},[t._m(3),t._v(" "),e("tbody",t._l(t.data,function(a){return e("tr",{key:a.id},[e("td",{attrs:{nowrap:""}},[t._v("\n                "+t._s(t.moment(a.event_time).format("YYYY-MM-DD"))+"\n                "),e("br"),t._v("\n                "+t._s(t.moment(a.event_time).format("HH:mm:ss"))+"\n              ")]),t._v(" "),e("td",[t._v("\n                "+t._s(a.hostname)+"\n              ")]),t._v(" "),e("td",{attrs:{nowrap:""}},[t._v("\n                "+t._s(a.language)+"/"+t._s(a.version)+" "),e("br"),t._v("\n                "+t._s(a.plugin_name?a.plugin_name:"official")+"/"+t._s(a.plugin_version)+"\n              ")]),t._v(" "),e("td",[t._v("\n                "+t._s(a.rasp_home)+"\n              ")]),t._v(" "),e("td",{staticStyle:{"word-break":"break-word"}},[t._v("\n                "+t._s(a.crash_message)+"\n              ")]),t._v(" "),e("td",{attrs:{nowrap:""}},[e("a",{attrs:{href:"javascript:"},on:{click:function(e){return t.showEventDetail(a)}}},[t._v("\n                see details\n                ")])])])}),0)]),t._v(" "),t.loading||0!=t.total?t._e():e("p",{staticClass:"text-center"},[t._v("No data yet")]),t._v(" "),!t.loading&&t.total>10?e("nav",[e("ul",{staticClass:"pagination pull-left"},[e("li",{staticClass:"active"},[e("span",{staticStyle:{"margin-top":"0.5em",display:"block"}},[e("strong",[t._v(t._s(t.total))]),t._v("The results show that "+t._s(t.currentPage)+" /\n                "+t._s(t.ceil(t.total/10))+"page\n              ")])])]),t._v(" "),e("b-pagination",{attrs:{align:"right","total-rows":t.total,"per-page":10},on:{change:function(a){return t.loadEvents(a)}},model:{value:t.currentPage,callback:function(a){t.currentPage=a},expression:"currentPage"}})],1):t._e()],1)])]),t._v(" "),e("CrashDetailModal",{ref:"crashDetailModal"})],1)},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("span",{staticClass:"input-icon-addon"},[a("i",{staticClass:"fe fe-calendar"})])},function(){var t=this.$createElement,a=this._self._c||t;return a("span",{staticClass:"input-icon-addon"},[a("i",{staticClass:"fe fe-search"})])},function(){var t=this.$createElement,a=this._self._c||t;return a("span",{staticClass:"input-icon-addon"},[a("i",{staticClass:"fe fe-search"})])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("thead",[e("tr",[e("th",[t._v("\n               Finally found time\n              ")]),t._v(" "),e("th",{attrs:{nowrap:""}},[t._v("\n               CPU name\n              ")]),t._v(" "),e("th",[t._v("\n               RASP version\n              ")]),t._v(" "),e("th",[t._v("\n               RASP directory\n              ")]),t._v(" "),e("th",{attrs:{nowrap:""}},[t._v("\n               Alarm information\n              ")]),t._v(" "),e("th",[t._v("\n               operating\n              ")])])])}]},ot=e("VU/8")(rt,lt,!1,null,null,null).exports,ct=e("mvHQ"),dt=e.n(ct),ut={name:"HostDetailModal",data:function(){return{data:{}}},methods:{showModal:function(t){this.data=t,$("#showHostDetailModal").modal()},env2str:function(t){var a="";for(var e in t)a=a+e+"="+t[e]+"\n";return a}}},_t={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"modal no-fade",attrs:{id:"showHostDetailModal",tabindex:"-1",role:"dialog"}},[e("div",{staticClass:"modal-dialog modal-lg",attrs:{role:"document"}},[e("div",{staticClass:"modal-content"},[t._m(0),t._v(" "),e("div",{staticClass:"modal-body",staticStyle:{"padding-top":"0"}},[t._m(1),t._v(" "),e("br"),t._v(" "),e("div",{staticClass:"tab-content",attrs:{id:"myTabContent"}},[e("div",{staticClass:"tab-pane fade show active",attrs:{id:"basic",role:"tabpanel","aria-labelledby":"home-tab"}},[e("div",{staticClass:"h6"},[t._v("\n              Host name\n            ")]),t._v(" "),e("p",[t._v(t._s(t.data.hostname))]),t._v(" "),t.data.host_type?e("div",[e("div",{staticClass:"h6"},[t._v("\n                Container type\n              ")]),t._v(" "),e("p",[t._v(t._s(t.data.host_type))])]):t._e(),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n              Registration time\n            ")]),t._v(" "),e("p",[t._v(t._s(t.moment(1e3*t.data.register_time).format("YYYY-MM-DD HH:mm:ss")))]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n              Register IP\n            ")]),t._v(" "),e("p",{staticStyle:{"word-break":"break-all"}},[t._v("\n              "+t._s(t.data.register_ip)+"\n            ")]),t._v(" "),t.data.environ&&0!=Object.keys(t.data.environ).length?e("div",[e("div",{staticClass:"h6"},[t._v("\n               Environment variable\n              ")]),t._v(" "),e("pre",[t._v(t._s(t.env2str(t.data.environ)))])]):t._e()]),t._v(" "),e("div",{staticClass:"tab-pane fade",attrs:{id:"profile",role:"tabpanel","aria-labelledby":"profile-tab"}},[e("div",{staticClass:"h6"},[t._v("\n              Server version\n            ")]),t._v(" "),e("p",[t._v(t._s(t.data.language)+"/"+t._s(t.data.language_version))]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n              Agent version\n            ")]),t._v(" "),e("p",[t._v(t._s(t.data.version))]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n              Plugin version\n            ")]),t._v(" "),e("p",[t._v(t._s(t.data.plugin_version))]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n              RASP ID\n            ")]),t._v(" "),e("p",[t._v(t._s(t.data.id))])])])]),t._v(" "),t._m(2)])])])},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"modal-header"},[a("h5",{staticClass:"modal-title"},[this._v("\n          Host details\n        ")]),this._v(" "),a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}})])},function(){var t=this.$createElement,a=this._self._c||t;return a("ul",{staticClass:"nav nav-tabs",attrs:{id:"myTab",role:"tablist"}},[a("li",{staticClass:"nav-item"},[a("a",{staticClass:"nav-link active",attrs:{id:"home-tab","data-toggle":"tab",href:"#basic"}},[this._v("\n              basic information\n            ")])]),this._v(" "),a("li",{staticClass:"nav-item"},[a("a",{staticClass:"nav-link",attrs:{id:"profile-tab","data-toggle":"tab",href:"#profile",role:"tab"}},[this._v("\n              RASP information\n            ")])])])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"modal-footer"},[a("button",{staticClass:"btn btn-primary",attrs:{"data-dismiss":"modal"}},[this._v("\n          关闭\n        ")])])}]},pt={name:"Hosts",components:{HostDetailModal:e("VU/8")(ut,_t,!1,null,null,null).exports},data:function(){return{data:[],loading:!1,currentVersion:"",agent_versions:[],currentPage:1,total:0,hostname:"",filter:{online:!0,offline:!0,language_java:!0,language_php:!0}}},computed:E()({},Object(c.c)(["current_app"])),watch:{current_app:function(){this.currentVersion="",this.loadRaspList(1)},currentVersion:function(){this.loadRaspList(1)},filter:{handler:function(){this.current_app.id&&(this.loadRaspList(1),localStorage.setItem("host_filter_status",dt()(this.filter)))},deep:!0}},mounted:function(){try{var t=JSON.parse(localStorage.getItem("host_filter_status"));"boolean"==typeof t.online&&"boolean"==typeof t.offline&&"boolean"==typeof t.language_java&&"boolean"==typeof t.language_php&&(this.filter=t)}catch(t){}this.current_app.id&&this.loadRaspList(1)},methods:{ceil:Math.ceil,getHref:function(){return"/v1/api/rasp/csv?app_id="+this.current_app.id+"&version="+this.currentVersion+"&online="+this.filter.online+"&offline="+this.filter.offline+"&hostname="+this.hostname+"&language_java="+this.filter.language_java+"&language_php="+this.filter.language_php},enumAgentVersion:function(){var t=this,a={data:{app_id:this.current_app.id},page:1,perpage:10};this.filter.online&&!this.filter.offline?a.data.online=!0:!this.filter.online&&this.filter.offline&&(a.data.online=!1),this.filter.language_java&&!this.filter.language_php?a.data.language="java":!this.filter.language_java&&this.filter.language_php&&(a.data.language="php"),this.request.post("v1/api/rasp/search/version",a).then(function(a){t.agent_versions=a.data,0==t.agent_versions.length&&t.currentVersion&&t.agent_versions.push({version:t.currentVersion,count:0})})},toHostStatus:function(){return this.filter.online&&this.filter.offline?": All":this.filter.online||this.filter.offline?this.filter.online?":Online only":": Offline only":""},toLanguageStatus:function(){return this.filter.language_java&&this.filter.language_php?":All":this.filter.language_java||this.filter.language_php?this.filter.language_java?": Java only":":PHP only":""},showHostDetail:function(t){this.$refs.showHostDetail.showModal(t)},loadRaspList:function(t){var a=this;if(!this.filter.online&&!this.filter.offline||!this.filter.language_java&&!this.filter.language_php)return this.currentPage=t,this.data=[],this.total=0,this.loading=!1,void(this.agent_versions=[]);this.enumAgentVersion();var e={data:{app_id:this.current_app.id},page:t,perpage:10};return this.currentVersion&&(e.data.version=this.currentVersion),this.hostname&&(e.data.hostname=this.hostname),this.filter.online&&!this.filter.offline?e.data.online=!0:!this.filter.online&&this.filter.offline&&(e.data.online=!1),this.filter.language_java&&!this.filter.language_php?e.data.language="java":!this.filter.language_java&&this.filter.language_php&&(e.data.language="php"),this.loading=!0,this.request.post("v1/api/rasp/search",e).then(function(e){a.currentPage=t,a.data=e.data,a.total=e.total,a.loading=!1})},setComment:function(t){var a=this,e=t.description,s=prompt("Enter a new note",e);null!=s&&this.request.post("v1/api/rasp/describe",{id:t.id,description:s}).then(function(t){a.loadRaspList(a.currentPage)})},doDelete:function(t){var a=this;if(confirm("Confirm to delete? Please uninstall OpenRASP Agent on the host before deleting")){var e={id:t.id,app_id:this.current_app.id};this.request.post("v1/api/rasp/delete",e).then(function(){return a.loadRaspList(1)})}},deleteExpired:function(){var t=this;if(confirm("Delete hosts offline for more than 7 days?")){var a={app_id:this.current_app.id,expire_time:604800};this.request.post("v1/api/rasp/delete",a).then(function(){return t.loadRaspList(1)})}}}},vt={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"my-3 my-md-5"},[e("div",{staticClass:"container"},[e("div",{staticClass:"page-header"},[e("h1",{staticClass:"page-title"},[t._v("\n        Agent management\n      ")]),t._v(" "),e("div",{staticClass:"page-options d-flex",staticStyle:{"margin-top":"5px"}},[e("select",{directives:[{name:"model",rawName:"v-model",value:t.currentVersion,expression:"currentVersion"}],staticClass:"form-control",on:{change:function(a){var e=Array.prototype.filter.call(a.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.currentVersion=a.target.multiple?e:e[0]}}},[e("option",{attrs:{value:""}},[t._v("\n          Version: All\n          ")]),t._v(" "),t._l(t.agent_versions,function(a){return e("option",{key:a.version,domProps:{value:a.version}},[t._v("\n            version:"+t._s(a.version)+" ("+t._s(a.count)+")\n          ")])})],2)]),t._v(" "),e("div",{staticClass:"page-options d-flex",staticStyle:{"margin-top":"5px","margin-left":"10px"}},[e("div",[e("b-dropdown",{attrs:{text:"status"+t.toHostStatus()}},[e("div",{staticClass:"row px-2"},[e("div",{staticClass:"col-6"},[e("label",{staticClass:"custom-switch"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.filter.online,expression:"filter.online"}],staticClass:"custom-switch-input",attrs:{type:"checkbox",checked:"filter.online"},domProps:{checked:Array.isArray(t.filter.online)?t._i(t.filter.online,null)>-1:t.filter.online},on:{change:[function(a){var e=t.filter.online,s=a.target,n=!!s.checked;if(Array.isArray(e)){var i=t._i(e,null);s.checked?i<0&&t.$set(t.filter,"online",e.concat([null])):i>-1&&t.$set(t.filter,"online",e.slice(0,i).concat(e.slice(i+1)))}else t.$set(t.filter,"online",n)},function(a){return t.$emit("selected")}]}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v("\n                  Online\n                  ")])])]),t._v(" "),e("div",{staticClass:"col-6"},[e("label",{staticClass:"custom-switch"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.filter.offline,expression:"filter.offline"}],staticClass:"custom-switch-input",attrs:{type:"checkbox",checked:"filter.offline"},domProps:{checked:Array.isArray(t.filter.offline)?t._i(t.filter.offline,null)>-1:t.filter.offline},on:{change:[function(a){var e=t.filter.offline,s=a.target,n=!!s.checked;if(Array.isArray(e)){var i=t._i(e,null);s.checked?i<0&&t.$set(t.filter,"offline",e.concat([null])):i>-1&&t.$set(t.filter,"offline",e.slice(0,i).concat(e.slice(i+1)))}else t.$set(t.filter,"offline",n)},function(a){return t.$emit("selected")}]}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v("\n                   Offline\n                  ")])])])])]),t._v(" "),e("b-dropdown",{staticStyle:{"margin-left":"10px"},attrs:{text:"Language"+t.toLanguageStatus()}},[e("div",{staticClass:"row px-2"},[e("div",{staticClass:"col-6"},[e("label",{staticClass:"custom-switch"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.filter.language_java,expression:"filter.language_java"}],staticClass:"custom-switch-input",attrs:{type:"checkbox",checked:"filter.language_java"},domProps:{checked:Array.isArray(t.filter.language_java)?t._i(t.filter.language_java,null)>-1:t.filter.language_java},on:{change:[function(a){var e=t.filter.language_java,s=a.target,n=!!s.checked;if(Array.isArray(e)){var i=t._i(e,null);s.checked?i<0&&t.$set(t.filter,"language_java",e.concat([null])):i>-1&&t.$set(t.filter,"language_java",e.slice(0,i).concat(e.slice(i+1)))}else t.$set(t.filter,"language_java",n)},function(a){return t.$emit("selected")}]}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v("\n                    Java\n                  ")])])]),t._v(" "),e("div",{staticClass:"col-6"},[e("label",{staticClass:"custom-switch"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.filter.language_php,expression:"filter.language_php"}],staticClass:"custom-switch-input",attrs:{type:"checkbox",checked:"filter.language_php"},domProps:{checked:Array.isArray(t.filter.language_php)?t._i(t.filter.language_php,null)>-1:t.filter.language_php},on:{change:[function(a){var e=t.filter.language_php,s=a.target,n=!!s.checked;if(Array.isArray(e)){var i=t._i(e,null);s.checked?i<0&&t.$set(t.filter,"language_php",e.concat([null])):i>-1&&t.$set(t.filter,"language_php",e.slice(0,i).concat(e.slice(i+1)))}else t.$set(t.filter,"language_php",n)},function(a){return t.$emit("selected")}]}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v("\n                    PHP\n                  ")])])])])])],1),t._v(" "),e("div",{staticClass:"input-icon ml-3"},[t._m(0),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.hostname,expression:"hostname",modifiers:{trim:!0}}],staticClass:"form-control w-10",attrs:{type:"text",placeholder:"Host Name/Remarks/IP/OS"},domProps:{value:t.hostname},on:{keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.loadRaspList(1)},input:function(a){a.target.composing||(t.hostname=a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("button",{staticClass:"btn btn-primary ml-2",on:{click:function(a){return t.loadRaspList(1)}}},[t._v("\n          search for\n        ")]),t._v(" "),e("a",{staticClass:"btn btn-primary ml-2",attrs:{href:t.getHref(),target:"_blank"}},[t._v("\n          Export\n        ")]),t._v(" "),e("button",{staticClass:"btn btn-info ml-2",on:{click:function(a){return t.deleteExpired()}}},[t._v("\n          Clean up\n        ")])])]),t._v(" "),e("div",{staticClass:"card"},[e("div",{staticClass:"card-body"},[t.loading?e("vue-loading",{attrs:{type:"spiningDubbles",color:"rgb(90, 193, 221)",size:{width:"50px",height:"50px"}}}):t._e(),t._v(" "),!t.loading&&t.total>0?e("nav",[e("ul",{staticClass:"pagination pull-left"},[e("li",{staticClass:"active"},[e("span",{staticStyle:{"margin-top":"0.5em",display:"block"}},[e("strong",[t._v(t._s(t.total))]),t._v(" The results show that "+t._s(t.currentPage)+" / "+t._s(t.ceil(t.total/10))+" page\n              ")])])]),t._v(" "),e("b-pagination",{attrs:{align:"right","total-rows":t.total,"per-page":10},on:{change:function(a){return t.loadRaspList(a)}},model:{value:t.currentPage,callback:function(a){t.currentPage=a},expression:"currentPage"}})],1):t._e(),t._v(" "),t.loading?t._e():e("table",{staticClass:"table table-hover table-bordered"},[t._m(1),t._v(" "),e("tbody",t._l(t.data,function(a){return e("tr",{key:a.id},[e("td",{staticStyle:{"min-width":"100px"}},[e("a",{attrs:{href:"javascript:"},on:{click:function(e){return t.showHostDetail(a)}}},[t._v(t._s(a.hostname))]),t._v(" "),a.description?e("span",[e("br"),t._v("["+t._s(a.description)+"]")]):t._e()]),t._v(" "),e("td",{attrs:{nowrap:""}},[t._v("\n                "+t._s(a.register_ip)+"\n              ")]),t._v(" "),e("td",{attrs:{nowrap:""}},[t._v("\n                "+t._s(a.language)+"/"+t._s(a.version)+" "),e("br"),t._v("\n                "+t._s(a.plugin_name?a.plugin_name:"official")+"/"+t._s(a.plugin_version)+"\n              ")]),t._v(" "),e("td",[t._v("\n                "+t._s(a.rasp_home)+"\n              ")]),t._v(" "),e("td",{attrs:{nowrap:""}},[t._v("\n                "+t._s(t.moment(1e3*a.last_heartbeat_time).format("YYYY-MM-DD"))+" "),e("br"),t._v("\n                "+t._s(t.moment(1e3*a.last_heartbeat_time).format("HH:mm:ss"))+"\n              ")]),t._v(" "),e("td",{attrs:{nowrap:""}},[a.online?t._e():e("span",{staticClass:"text-danger"},[t._v("\n                Offline\n                ")]),t._v(" "),a.online?e("span",[t._v("\n               normal\n                ")]):t._e()]),t._v(" "),e("td",{attrs:{nowrap:""}},[e("a",{attrs:{href:"javascript:"},on:{click:function(e){return t.setComment(a)}}},[t._v("\n                Remarks\n                ")]),t._v(" "),a.online?t._e():e("a",{attrs:{href:"javascript:"},on:{click:function(e){return t.doDelete(a)}}},[t._v("\n                delete\n                ")])])])}),0)]),t._v(" "),t.loading||0!=t.total?t._e():e("p",{staticClass:"text-center"},[t._v("No data")]),t._v(" "),!t.loading&&t.total>10?e("nav",[e("ul",{staticClass:"pagination pull-left"},[e("li",{staticClass:"active"},[e("span",{staticStyle:{"margin-top":"0.5em",display:"block"}},[e("strong",[t._v(t._s(t.total))]),t._v(" The results show that "+t._s(t.currentPage)+" / "+t._s(t.ceil(t.total/10))+" page\n              ")])])]),t._v(" "),e("b-pagination",{attrs:{align:"right","total-rows":t.total,"per-page":10},on:{change:function(a){return t.loadRaspList(a)}},model:{value:t.currentPage,callback:function(a){t.currentPage=a},expression:"currentPage"}})],1):t._e()],1)])]),t._v(" "),e("HostDetailModal",{ref:"showHostDetail"})],1)},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("span",{staticClass:"input-icon-addon"},[a("i",{staticClass:"fe fe-search"})])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("thead",[e("tr",[e("th",{attrs:{nowrap:""}},[t._v("\n              CPU name\n              ")]),t._v(" "),e("th",[t._v("\n               Register IP\n              ")]),t._v(" "),e("th",[t._v("\n              RASP version\n              ")]),t._v(" "),e("th",[t._v("\n               RASP directory\n              ")]),t._v(" "),e("th",[t._v("\n              Upper communication\n              ")]),t._v(" "),e("th",[t._v("\n              status\n              ")]),t._v(" "),e("th",[t._v("\n              operating\n              ")])])])}]},mt=e("VU/8")(pt,vt,!1,null,null,null).exports,ht=e("woOf"),ft=e.n(ht),gt={name:"AlarmSettings",props:{data:{type:Object,default:function(){return{general_config:{"inject.custom_headers":{}},whitelist_config:[],email_alarm_conf:{recv_addr:[]},ding_alarm_conf:{recv_user:[],recv_party:[]},http_alarm_conf:{recv_addr:[]},kafka_alarm_conf:{},general_alarm_conf:{}}}}},data:function(){return{attack_types:f,sendMethods:{}}},computed:E()({},Object(c.c)(["current_app","sticky"])),watch:{data:function(t,a){this.loadAlarmMethod()}},beforeMount:function(){this.resetAlarmMethods(!1)},methods:{loadAlarmMethod:function(){var t=this,a=t.data.attack_type_alarm_conf;a?(t.sendMethods.crash={},Y()(t.sendMethods).forEach(function(e){t.sendMethods[e]={ding:!1,http:!1,email:!1},a[e].forEach(function(a){t.sendMethods[e][a]=!0})})):this.resetAlarmMethods(!1)},resetAlarmMethods:function(t,a){var e=this;e.sendMethods.crash={email:!0},Y()(this.attack_types).forEach(function(a){e.sendMethods[a]||(e.sendMethods[a]={}),["email","ding","http"].forEach(function(s){e.sendMethods[a][s]=t})}),e.sendMethods=ft()({},e.sendMethods),a&&setTimeout(function(){return e.saveAlarmMethods()},500)},saveAlarmMethods:function(t){var a=this,e={app_id:a.current_app.id,attack_type_alarm_conf:{}};Y()(a.sendMethods).forEach(function(t){var s=a.sendMethods[t];e.attack_type_alarm_conf[t]=[],Y()(s).forEach(function(a){s[a]&&e.attack_type_alarm_conf[t].push(a)})}),this.request.post("v1/api/app/alarm/config",e).then(function(){alert("Alarm mode saved successfully")})},saveSettings:function(t){if("syslog"===t){try{this.data.general_config["syslog.facility"]=parseInt(this.data.general_config["syslog.facility"])}catch(t){this.data.general_config["syslog.facility"]=null}return e="Syslog alarm settings saved successfully",this.request.post("v1/api/app/general/config",{app_id:this.current_app.id,config:this.data.general_config}).then(function(){alert(e)})}var a={app_id:this.current_app.id},e="Alarm settings saved successfully";switch(t){case"email":a.email_alarm_conf=this.data.email_alarm_conf,"string"==typeof a.email_alarm_conf.recv_addr&&(a.email_alarm_conf.recv_addr=a.email_alarm_conf.recv_addr.split(/\s*[,;]\s*/).filter(function(t){return!!t})),e="Mail alarm settings saved successfully";break;case"ding":a.ding_alarm_conf=this.data.ding_alarm_conf,"string"==typeof a.ding_alarm_conf.recv_user&&(a.ding_alarm_conf.recv_user=a.ding_alarm_conf.recv_user.split(/\s*[,;]\s*/).filter(function(t){return!!t})),"string"==typeof a.ding_alarm_conf.recv_party&&(a.ding_alarm_conf.recv_party=a.ding_alarm_conf.recv_party.split(/\s*[,;]\s*/).filter(function(t){return!!t})),e="Dingding alarm settings saved successfully";break;case"http":a.http_alarm_conf=this.data.http_alarm_conf,"string"==typeof a.http_alarm_conf.recv_addr&&(a.http_alarm_conf.recv_addr=[a.http_alarm_conf.recv_addr]),e="HTTP push settings saved successfully";break;case"kafka":a.kafka_alarm_conf=this.data.kafka_alarm_conf,e="Kafka push settings saved successfully";break;case"general":a.general_alarm_conf=this.data.general_alarm_conf,e="General alarm settings saved successfully"}return this.request.post("v1/api/app/alarm/config",a).then(function(){alert(e)})},testSettings:function(t){var a=this;this.saveSettings(t).then(function(){return a.request.post("v1/api/app/"+t+"/test",{app_id:a.current_app.id})}).then(function(){return alert("Send successfully")})}}},bt={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("div",{staticClass:"card"},[t._m(0),t._v(" "),e("div",{staticClass:"card-body"},[t._l(t.attack_types,function(a,s){return e("div",{key:s},[e("div",{staticClass:"row",staticStyle:{"margin-top":"3px"}},[e("div",{staticClass:"col"},[e("label",{staticStyle:{"min-width":"220px"}},[t._v(t._s(a))])]),t._v(" "),e("div",{staticClass:"col"},[e("label",{staticClass:"custom-switch m-0"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.sendMethods[s].email,expression:"sendMethods[name].email"}],staticClass:"custom-switch-input",attrs:{type:"checkbox",value:"1"},domProps:{checked:Array.isArray(t.sendMethods[s].email)?t._i(t.sendMethods[s].email,"1")>-1:t.sendMethods[s].email},on:{change:function(a){var e=t.sendMethods[s].email,n=a.target,i=!!n.checked;if(Array.isArray(e)){var r=t._i(e,"1");n.checked?r<0&&t.$set(t.sendMethods[s],"email",e.concat(["1"])):r>-1&&t.$set(t.sendMethods[s],"email",e.slice(0,r).concat(e.slice(r+1)))}else t.$set(t.sendMethods[s],"email",i)}}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v("Email alarm")])])]),t._v(" "),e("div",{staticClass:"col"},[e("label",{staticClass:"custom-switch m-0"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.sendMethods[s].ding,expression:"sendMethods[name].ding"}],staticClass:"custom-switch-input",attrs:{type:"checkbox",value:"1"},domProps:{checked:Array.isArray(t.sendMethods[s].ding)?t._i(t.sendMethods[s].ding,"1")>-1:t.sendMethods[s].ding},on:{change:function(a){var e=t.sendMethods[s].ding,n=a.target,i=!!n.checked;if(Array.isArray(e)){var r=t._i(e,"1");n.checked?r<0&&t.$set(t.sendMethods[s],"ding",e.concat(["1"])):r>-1&&t.$set(t.sendMethods[s],"ding",e.slice(0,r).concat(e.slice(r+1)))}else t.$set(t.sendMethods[s],"ding",i)}}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v("Dingding alarm")])])]),t._v(" "),e("div",{staticClass:"col"},[e("label",{staticClass:"custom-switch m-0"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.sendMethods[s].http,expression:"sendMethods[name].http"}],staticClass:"custom-switch-input",attrs:{type:"checkbox",value:"1"},domProps:{checked:Array.isArray(t.sendMethods[s].http)?t._i(t.sendMethods[s].http,"1")>-1:t.sendMethods[s].http},on:{change:function(a){var e=t.sendMethods[s].http,n=a.target,i=!!n.checked;if(Array.isArray(e)){var r=t._i(e,"1");n.checked?r<0&&t.$set(t.sendMethods[s],"http",e.concat(["1"])):r>-1&&t.$set(t.sendMethods[s],"http",e.slice(0,r).concat(e.slice(r+1)))}else t.$set(t.sendMethods[s],"http",i)}}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v("HTTP push")])])])])])}),t._v(" "),e("div",[e("div",{staticClass:"row",staticStyle:{"margin-top":"3px"}},[t._m(1),t._v(" "),e("div",{staticClass:"col"},[e("label",{staticClass:"custom-switch m-0"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.sendMethods.crash.email,expression:"sendMethods['crash'].email"}],staticClass:"custom-switch-input",attrs:{type:"checkbox",value:"1"},domProps:{checked:Array.isArray(t.sendMethods.crash.email)?t._i(t.sendMethods.crash.email,"1")>-1:t.sendMethods.crash.email},on:{change:function(a){var e=t.sendMethods.crash.email,s=a.target,n=!!s.checked;if(Array.isArray(e)){var i=t._i(e,"1");s.checked?i<0&&t.$set(t.sendMethods.crash,"email",e.concat(["1"])):i>-1&&t.$set(t.sendMethods.crash,"email",e.slice(0,i).concat(e.slice(i+1)))}else t.$set(t.sendMethods.crash,"email",n)}}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v("Email alarm")])])]),t._v(" "),e("div",{staticClass:"col"}),t._v(" "),e("div",{staticClass:"col"})])])],2),t._v(" "),e("div",{class:{"card-footer":!0,"sticky-card-footer":t.sticky}},[e("button",{staticClass:"btn btn-primary",attrs:{type:"submit"},on:{click:function(a){return t.saveAlarmMethods()}}},[t._v("\n        Save\n      ")]),t._v(" "),e("button",{staticClass:"btn btn-info pull-right",attrs:{type:"submit"},on:{click:function(a){return t.resetAlarmMethods(!1,!0)}}},[t._v("\n        Close all\n      ")]),t._v(" "),e("button",{staticClass:"btn btn-info pull-right",staticStyle:{"margin-right":"5px"},attrs:{type:"submit"},on:{click:function(a){return t.resetAlarmMethods(!0,!0)}}},[t._v("\n        Open all\n      ")])])]),t._v(" "),e("div",{staticClass:"card"},[t._m(2),t._v(" "),e("div",{staticClass:"card-body"},[e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n         How many seconds to send an alarm (alarms are not sent in real time, but check whether there are new alarms in ES every time）\n        ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.data.general_alarm_conf.alarm_check_interval,expression:"data.general_alarm_conf.alarm_check_interval",modifiers:{number:!0}}],staticClass:"form-control",attrs:{placeholder:"120"},domProps:{value:t.data.general_alarm_conf.alarm_check_interval},on:{input:function(a){a.target.composing||t.$set(t.data.general_alarm_conf,"alarm_check_interval",t._n(a.target.value))},blur:function(a){return t.$forceUpdate()}}})])]),t._v(" "),e("div",{staticClass:"card-footer"},[e("button",{staticClass:"btn btn-primary",attrs:{type:"submit"},on:{click:function(a){return t.saveSettings("general")}}},[t._v("\n        Save\n      ")])])]),t._v(" "),e("div",{staticClass:"card"},[t._m(3),t._v(" "),e("div",{staticClass:"card-body"},[e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n         Push email address-separated by comma or semicolon\n        ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.data.email_alarm_conf.recv_addr,expression:"data.email_alarm_conf.recv_addr",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text",placeholder:"user1@example.com; user2@example.com"},domProps:{value:t.data.email_alarm_conf.recv_addr},on:{input:function(a){a.target.composing||t.$set(t.data.email_alarm_conf,"recv_addr",a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n         Alarm title\n        ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.data.email_alarm_conf.subject,expression:"data.email_alarm_conf.subject",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.data.email_alarm_conf.subject},on:{input:function(a){a.target.composing||t.$set(t.data.email_alarm_conf,"subject",a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n         Custom From header information\n        ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.data.email_alarm_conf.from,expression:"data.email_alarm_conf.from",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.data.email_alarm_conf.from},on:{input:function(a){a.target.composing||t.$set(t.data.email_alarm_conf,"from",a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n         Mail server address\n        ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.data.email_alarm_conf.server_addr,expression:"data.email_alarm_conf.server_addr",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text",placeholder:"smtp.163.com:25",autocomplete:"off"},domProps:{value:t.data.email_alarm_conf.server_addr},on:{input:function(a){a.target.composing||t.$set(t.data.email_alarm_conf,"server_addr",a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          email address\n        ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.data.email_alarm_conf.username,expression:"data.email_alarm_conf.username"}],staticClass:"form-control",attrs:{type:"email",placeholder:"hello@163.com",autocomplete:"off"},domProps:{value:t.data.email_alarm_conf.username},on:{input:function(a){a.target.composing||t.$set(t.data.email_alarm_conf,"username",a.target.value)}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          email Password\n        ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.data.email_alarm_conf.password,expression:"data.email_alarm_conf.password"}],staticClass:"form-control",attrs:{type:"password",autocomplete:"off"},domProps:{value:t.data.email_alarm_conf.password},on:{input:function(a){a.target.composing||t.$set(t.data.email_alarm_conf,"password",a.target.value)}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"custom-switch"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.data.email_alarm_conf.enable,expression:"data.email_alarm_conf.enable"}],staticClass:"custom-switch-input",attrs:{type:"checkbox",checked:"data.email_alarm_conf.enable"},domProps:{checked:Array.isArray(t.data.email_alarm_conf.enable)?t._i(t.data.email_alarm_conf.enable,null)>-1:t.data.email_alarm_conf.enable},on:{change:function(a){var e=t.data.email_alarm_conf.enable,s=a.target,n=!!s.checked;if(Array.isArray(e)){var i=t._i(e,null);s.checked?i<0&&t.$set(t.data.email_alarm_conf,"enable",e.concat([null])):i>-1&&t.$set(t.data.email_alarm_conf,"enable",e.slice(0,i).concat(e.slice(i+1)))}else t.$set(t.data.email_alarm_conf,"enable",n)}}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v("\n            Turn on email alert\n          ")])]),t._v(" "),e("br"),t._v(" "),e("label",{staticClass:"custom-switch"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.data.email_alarm_conf.tls_enable,expression:"data.email_alarm_conf.tls_enable"}],staticClass:"custom-switch-input",attrs:{type:"checkbox",checked:"data.email_alarm_conf.enable"},domProps:{checked:Array.isArray(t.data.email_alarm_conf.tls_enable)?t._i(t.data.email_alarm_conf.tls_enable,null)>-1:t.data.email_alarm_conf.tls_enable},on:{change:function(a){var e=t.data.email_alarm_conf.tls_enable,s=a.target,n=!!s.checked;if(Array.isArray(e)){var i=t._i(e,null);s.checked?i<0&&t.$set(t.data.email_alarm_conf,"tls_enable",e.concat([null])):i>-1&&t.$set(t.data.email_alarm_conf,"tls_enable",e.slice(0,i).concat(e.slice(i+1)))}else t.$set(t.data.email_alarm_conf,"tls_enable",n)}}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),t._m(4)])])]),t._v(" "),e("div",{staticClass:"card-footer"},[e("button",{staticClass:"btn btn-primary",attrs:{type:"submit"},on:{click:function(a){return t.saveSettings("email")}}},[t._v("\n       Save\n      ")]),t._v(" "),e("button",{staticClass:"btn btn-info pull-right",attrs:{type:"submit"},on:{click:function(a){return t.testSettings("email")}}},[t._v("\n        Send test data\n      ")])])]),t._v(" "),e("div",{staticClass:"card"},[t._m(5),t._v(" "),e("div",{staticClass:"card-body"},[e("div",{staticClass:"form-group"},[t._m(6),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.data.http_alarm_conf.recv_addr,expression:"data.http_alarm_conf.recv_addr",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text",placeholder:"http://myserver/myurl"},domProps:{value:t.data.http_alarm_conf.recv_addr},on:{input:function(a){a.target.composing||t.$set(t.data.http_alarm_conf,"recv_addr",a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"custom-switch"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.data.http_alarm_conf.enable,expression:"data.http_alarm_conf.enable"}],staticClass:"custom-switch-input",attrs:{type:"checkbox",checked:"data.http_alarm_conf.enable"},domProps:{checked:Array.isArray(t.data.http_alarm_conf.enable)?t._i(t.data.http_alarm_conf.enable,null)>-1:t.data.http_alarm_conf.enable},on:{change:function(a){var e=t.data.http_alarm_conf.enable,s=a.target,n=!!s.checked;if(Array.isArray(e)){var i=t._i(e,null);s.checked?i<0&&t.$set(t.data.http_alarm_conf,"enable",e.concat([null])):i>-1&&t.$set(t.data.http_alarm_conf,"enable",e.slice(0,i).concat(e.slice(i+1)))}else t.$set(t.data.http_alarm_conf,"enable",n)}}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v("\n            Turn on alarm push\n          ")])])])]),t._v(" "),e("div",{staticClass:"card-footer"},[e("button",{staticClass:"btn btn-primary",attrs:{type:"submit"},on:{click:function(a){return t.saveSettings("http")}}},[t._v("\n       Save\n      ")]),t._v(" "),e("button",{staticClass:"btn btn-info pull-right",attrs:{type:"submit"},on:{click:function(a){return t.testSettings("http")}}},[t._v("\n        Send test data\n      ")])])]),t._v(" "),e("div",{staticClass:"card"},[t._m(7),t._v(" "),e("div",{staticClass:"card-body"},[e("div",{staticClass:"form-group"},[t._m(8),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.data.ding_alarm_conf.recv_user,expression:"data.ding_alarm_conf.recv_user",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.data.ding_alarm_conf.recv_user},on:{input:function(a){a.target.composing||t.$set(t.data.ding_alarm_conf,"recv_user",a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n         Push department list\n        ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.data.ding_alarm_conf.recv_party,expression:"data.ding_alarm_conf.recv_party",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.data.ding_alarm_conf.recv_party},on:{input:function(a){a.target.composing||t.$set(t.data.ding_alarm_conf,"recv_party",a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          Corp ID\n        ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.data.ding_alarm_conf.corp_id,expression:"data.ding_alarm_conf.corp_id",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.data.ding_alarm_conf.corp_id},on:{input:function(a){a.target.composing||t.$set(t.data.ding_alarm_conf,"corp_id",a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          Corp Secret\n        ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.data.ding_alarm_conf.corp_secret,expression:"data.ding_alarm_conf.corp_secret",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.data.ding_alarm_conf.corp_secret},on:{input:function(a){a.target.composing||t.$set(t.data.ding_alarm_conf,"corp_secret",a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          Agent ID\n        ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.data.ding_alarm_conf.agent_id,expression:"data.ding_alarm_conf.agent_id",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.data.ding_alarm_conf.agent_id},on:{input:function(a){a.target.composing||t.$set(t.data.ding_alarm_conf,"agent_id",a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"custom-switch"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.data.ding_alarm_conf.enable,expression:"data.ding_alarm_conf.enable"}],staticClass:"custom-switch-input",attrs:{type:"checkbox",checked:"data.ding_alarm_conf.enable"},domProps:{checked:Array.isArray(t.data.ding_alarm_conf.enable)?t._i(t.data.ding_alarm_conf.enable,null)>-1:t.data.ding_alarm_conf.enable},on:{change:function(a){var e=t.data.ding_alarm_conf.enable,s=a.target,n=!!s.checked;if(Array.isArray(e)){var i=t._i(e,null);s.checked?i<0&&t.$set(t.data.ding_alarm_conf,"enable",e.concat([null])):i>-1&&t.$set(t.data.ding_alarm_conf,"enable",e.slice(0,i).concat(e.slice(i+1)))}else t.$set(t.data.ding_alarm_conf,"enable",n)}}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v("\n            Turn on DingTalk\n          ")])])])]),t._v(" "),e("div",{staticClass:"card-footer"},[e("button",{staticClass:"btn btn-primary",attrs:{type:"submit"},on:{click:function(a){return t.saveSettings("ding")}}},[t._v("\n        Save\n      ")]),t._v(" "),e("button",{staticClass:"btn btn-info pull-right",attrs:{type:"submit"},on:{click:function(a){return t.testSettings("ding")}}},[t._v("\n        Send test data\n      ")])])]),t._v(" "),e("div",{staticClass:"card"},[t._m(9),t._v(" "),e("div",{staticClass:"card-body"},[e("div",{staticClass:"form-group"},[t._m(10),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.data.general_config["syslog.url"],expression:"data.general_config['syslog.url']",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text",placeholder:"tcp://1.1.1.1:6666"},domProps:{value:t.data.general_config["syslog.url"]},on:{input:function(a){a.target.composing||t.$set(t.data.general_config,"syslog.url",a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          Facility\n        ")]),t._v(" "),e("b-form-input",{staticClass:"form-control",attrs:{type:"number"},model:{value:t.data.general_config["syslog.facility"],callback:function(a){t.$set(t.data.general_config,"syslog.facility",a)},expression:"data.general_config['syslog.facility']"}})],1),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          Tag\n        ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.data.general_config["syslog.tag"],expression:"data.general_config['syslog.tag']",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.data.general_config["syslog.tag"]},on:{input:function(a){a.target.composing||t.$set(t.data.general_config,"syslog.tag",a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"custom-switch"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.data.general_config["syslog.enable"],expression:"data.general_config['syslog.enable']"}],staticClass:"custom-switch-input",attrs:{type:"checkbox",checked:"data.general_config['syslog.enable']"},domProps:{checked:Array.isArray(t.data.general_config["syslog.enable"])?t._i(t.data.general_config["syslog.enable"],null)>-1:t.data.general_config["syslog.enable"]},on:{change:function(a){var e=t.data.general_config["syslog.enable"],s=a.target,n=!!s.checked;if(Array.isArray(e)){var i=t._i(e,null);s.checked?i<0&&t.$set(t.data.general_config,"syslog.enable",e.concat([null])):i>-1&&t.$set(t.data.general_config,"syslog.enable",e.slice(0,i).concat(e.slice(i+1)))}else t.$set(t.data.general_config,"syslog.enable",n)}}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v("\n           Enable syslog log\n          ")])])])]),t._v(" "),e("div",{staticClass:"card-footer"},[e("button",{staticClass:"btn btn-primary",attrs:{type:"submit"},on:{click:function(a){return t.saveSettings("syslog")}}},[t._v("\n        Save\n      ")])])]),t._v(" "),e("div",{staticClass:"card"},[t._m(11),t._v(" "),e("div",{staticClass:"card-body"},[e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n         server address\n        ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.data.kafka_alarm_conf.url,expression:"data.kafka_alarm_conf['url']",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text",placeholder:"127.0.0.1:6666"},domProps:{value:t.data.kafka_alarm_conf.url},on:{input:function(a){a.target.composing||t.$set(t.data.kafka_alarm_conf,"url",a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          Topic\n        ")]),t._v(" "),e("b-form-input",{staticClass:"form-control",attrs:{type:"text",placeholder:"your_topic"},model:{value:t.data.kafka_alarm_conf.topic,callback:function(a){t.$set(t.data.kafka_alarm_conf,"topic",a)},expression:"data.kafka_alarm_conf['topic']"}})],1),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          Kafka username (optional)\n        ")]),t._v(" "),e("b-form-input",{staticClass:"form-control",attrs:{type:"text"},model:{value:t.data.kafka_alarm_conf.user,callback:function(a){t.$set(t.data.kafka_alarm_conf,"user",a)},expression:"data.kafka_alarm_conf['user']"}})],1),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          kafka password (optional)\n        ")]),t._v(" "),e("b-form-input",{staticClass:"form-control",attrs:{type:"text"},model:{value:t.data.kafka_alarm_conf.pwd,callback:function(a){t.$set(t.data.kafka_alarm_conf,"pwd",a)},expression:"data.kafka_alarm_conf['pwd']"}})],1),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"custom-switch"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.data.kafka_alarm_conf.enable,expression:"data.kafka_alarm_conf['enable']"}],staticClass:"custom-switch-input",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.data.kafka_alarm_conf.enable)?t._i(t.data.kafka_alarm_conf.enable,null)>-1:t.data.kafka_alarm_conf.enable},on:{change:function(a){var e=t.data.kafka_alarm_conf.enable,s=a.target,n=!!s.checked;if(Array.isArray(e)){var i=t._i(e,null);s.checked?i<0&&t.$set(t.data.kafka_alarm_conf,"enable",e.concat([null])):i>-1&&t.$set(t.data.kafka_alarm_conf,"enable",e.slice(0,i).concat(e.slice(i+1)))}else t.$set(t.data.kafka_alarm_conf,"enable",n)}}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v("\n            Enable Kafka log push\n          ")])])])]),t._v(" "),e("div",{staticClass:"card-footer"},[e("button",{staticClass:"btn btn-primary",attrs:{type:"submit"},on:{click:function(a){return t.saveSettings("kafka")}}},[t._v("\n        Save\n      ")]),t._v(" "),e("button",{staticClass:"btn btn-info pull-right",attrs:{type:"submit"},on:{click:function(a){return t.testSettings("kafka")}}},[t._v("\n       Send test data\n      ")])])])])},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"card-header"},[a("h3",{staticClass:"card-title"},[this._v("\n        Alarm type configuration\n      ")]),this._v(" "),a("div",{staticClass:"card-options"})])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"col"},[a("label",{staticStyle:{"min-width":"220px"}},[this._v("Client crashes (v1.2.3 new features）")])])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"card-header"},[a("h3",{staticClass:"card-title"},[this._v("\n        Alarm general configuration (global configuration, effective for all applications)\n      ")]),this._v(" "),a("div",{staticClass:"card-options"})])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"card-header"},[a("h3",{staticClass:"card-title"},[this._v("\n       Email alarm\n      ")]),this._v(" "),a("div",{staticClass:"card-options"})])},function(){var t=this.$createElement,a=this._self._c||t;return a("span",{staticClass:"custom-switch-description"},[this._v("\n           Force open TLS "),a("a",{attrs:{target:"_blank",href:"https://rasp.baidu.com/doc/setup/panel.html#email-alarm"}},[this._v("[Help Document]")])])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"card-header"},[a("h3",{staticClass:"card-title"},[this._v("\n       HTTP alarm push\n      ")])])},function(){var t=this.$createElement,a=this._self._c||t;return a("label",{staticClass:"form-label"},[this._v("\n          HTTP/HTTPS URL "),a("a",{attrs:{href:"https://rasp.baidu.com/doc/setup/log/main.html#format",target:"_blank"}},[this._v("[Push data format description]")])])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"card-header"},[a("h3",{staticClass:"card-title"},[this._v("\n        Dingding integration\n      ")])])},function(){var t=this.$createElement,a=this._self._c||t;return a("label",{staticClass:"form-label"},[this._v("\n         Push user list-separated by comma or semicolon\n          "),a("a",{attrs:{target:"_blank",href:"https://rasp.baidu.com/doc/setup/panel.html#dingding-alarm"}},[this._v("\n           [Help Document]\n          ")])])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"card-header"},[a("h3",{staticClass:"card-title"},[this._v("\n       Syslog alarm configuration (Agent push)\n      ")])])},function(){var t=this.$createElement,a=this._self._c||t;return a("label",{staticClass:"form-label"},[this._v("\n          server address\n          "),a("a",{attrs:{href:"https://rasp.baidu.com/doc/setup/others.html#common-syslog",target:"_blank"}},[this._v("\n           [Help Document]\n          ")])])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"card-header"},[a("h3",{staticClass:"card-title"},[this._v("\n        Kafka alarm push (background push, Kafka version number should be greater than or equal to 0.8）\n      ")])])}]},yt=e("VU/8")(gt,bt,!1,null,null,null).exports,kt={name:"AppEditModal",data:function(){return{data:{},is_edit:!1}},methods:{showModal:function(t,a){this.data=JSON.parse(dt()(t)),this.is_edit=a,$("#appEditModal").modal(),this.$refs.name.focus()},saveApp:function(){var t={data:this.data,is_edit:this.is_edit};this.$emit("save",t)}}},Ct={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"modal no-fade",attrs:{id:"appEditModal",tabindex:"-1",role:"dialog"}},[e("div",{staticClass:"modal-dialog",attrs:{role:"document"}},[e("div",{staticClass:"modal-content"},[t._m(0),t._v(" "),e("div",{staticClass:"modal-body"},[e("div",{staticClass:"form-group"},[e("label",[t._v("Application Name")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.data.name,expression:"data.name",modifiers:{trim:!0}}],ref:"name",staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.data.name},on:{input:function(a){a.target.composing||t.$set(t.data,"name",a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",[t._v("Application Note")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.data.description,expression:"data.description",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.data.description},on:{input:function(a){a.target.composing||t.$set(t.data,"description",a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",[t._v("Application language")]),t._v(" "),e("select",{directives:[{name:"model",rawName:"v-model",value:t.data.language,expression:"data.language"}],staticClass:"form-control",on:{change:function(a){var e=Array.prototype.filter.call(a.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.$set(t.data,"language",a.target.multiple?e:e[0])}}},[e("option",{attrs:{value:"java"}},[t._v("\n              java\n            ")]),t._v(" "),e("option",{attrs:{value:"php"}},[t._v("\n              php\n            ")])])])]),t._v(" "),e("div",{staticClass:"modal-footer"},[e("button",{staticClass:"btn btn-primary",attrs:{"data-dismiss":"modal"},on:{click:function(a){return t.saveApp()}}},[t._v("\n          Save\n        ")]),t._v(" "),e("button",{staticClass:"btn btn-info",attrs:{"data-dismiss":"modal"}},[t._v("\n          shut down\n        ")])])])])])},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"modal-header"},[a("h5",{staticClass:"modal-title"},[this._v("\n          Add/edit application\n        ")]),this._v(" "),a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}})])}]},wt={name:"AppSettings",components:{appEditModal:e("VU/8")(kt,Ct,!1,null,null,null).exports},data:function(){return{data:[],loading:!1,total:0,currentPage:1}},computed:E()({},Object(c.c)(["current_app","app_list"])),watch:{current_app:function(){this.loadApps(1)}},mounted:function(){this.current_app.id=this.$route.params.app_id,this.current_app.id&&this.loadApps(1)},methods:E()({},Object(c.b)(["loadAppList"]),Object(c.d)(["setCurrentApp"]),{loadApps:function(t){var a=this;return this.loading=!0,this.request.post("v1/api/app/get",{page:t,perpage:10}).then(function(e){a.currentPage=t,a.data=e.data,a.total=e.total,a.loading=!1})},deleteApp:function(t){var a=this;if(confirm("Confirm operation"))return this.request.post("v1/api/app/delete",{id:t.id}).then(function(){var e=t.id===a.current_app.id?a.app_list.find(function(a){return a.id!==t.id}):a.current_app;a.loadApps(1),a.loadAppList(e.id)})},editApp:function(t,a){this.$refs.appEditModal.showModal({app_id:t.id,name:t.name,language:t.language,description:t.description},a)},onEdit:function(t){var a=this,e=t.is_edit,s=t.data;this.request.post(e?"v1/api/app/config":"v1/api/app",s).then(function(){a.loadApps(e?1:a.currentPage),a.loadAppList(a.current_app.id)})}})},xt={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("div",{staticClass:"card"},[t._m(0),t._v(" "),e("div",{staticClass:"card-body"},[t.loading?e("vue-loading",{attrs:{type:"spiningDubbles",color:"rgb(90, 193, 221)",size:{width:"50px",height:"50px"}}}):t._e(),t._v(" "),t.loading?t._e():e("table",{staticClass:"table table-bordered table-hover"},[t._m(1),t._v(" "),e("tbody",t._l(t.data,function(a){return e("tr",{key:a.id},[e("td",{staticStyle:{"min-width":"100px"}},[t._v("\n              "+t._s(a.name)+"\n            ")]),t._v(" "),e("td",{attrs:{nowrap:""}},[t._v("\n              "+t._s(a.language)+"\n            ")]),t._v(" "),e("td",[t._v("\n              "+t._s(a.description)+"\n            ")]),t._v(" "),e("td",{attrs:{nowrap:""}},[e("a",{attrs:{href:"javascript:"},on:{click:function(e){return e.preventDefault(),t.setCurrentApp(a)}}},[t._v("\n              Switch\n              ")]),t._v(" "),e("a",{attrs:{href:"javascript:"},on:{click:function(e){return t.editApp(a,!0)}}},[t._v("\n                edit\n              ")]),t._v(" "),e("a",{attrs:{href:"javascript:"},on:{click:function(e){return t.deleteApp(a)}}},[t._v("\n                delete\n              ")])])])}),0)]),t._v(" "),t.loading?t._e():e("nav",[e("b-pagination",{attrs:{align:"center","total-rows":t.total,"per-page":10},on:{change:t.loadApps},model:{value:t.currentPage,callback:function(a){t.currentPage=a},expression:"currentPage"}})],1)],1),t._v(" "),e("div",{staticClass:"card-footer text-right"},[e("div",{staticClass:"d-flex"},[e("button",{staticClass:"btn btn-primary",on:{click:function(a){return t.editApp({language:"java"})}}},[t._v("\n         Add to\n        ")]),t._v(" "),e("a",{staticClass:"btn btn-primary pull-right",staticStyle:{"margin-left":"auto"},attrs:{href:"v1/api/app/export",target:"_blank"}},[t._v("\n          Export\n        ")])])])]),t._v(" "),e("appEditModal",{ref:"appEditModal",on:{save:function(a){return t.onEdit(a)}}})],1)},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"card-header"},[a("h3",{staticClass:"card-title"},[this._v("\n       Application management\n      ")])])},function(){var t=this.$createElement,a=this._self._c||t;return a("thead",[a("th",[this._v("\n            name\n          ")]),this._v(" "),a("th",[this._v("\n           Language\n          ")]),this._v(" "),a("th",[this._v("\n           Remarks\n          ")]),this._v(" "),a("th",[this._v("\n            operating\n          ")])])}]},Pt=e("VU/8")(wt,xt,!1,null,null,null).exports,$t={name:"AuthSettings",data:function(){return{data:[],total:0,currentPage:1,loading:!1,oldpass:"",newpass1:"",newpass2:""}},mounted:function(){this.loadTokens(1)},methods:{changePass:function(){this.oldpass.length>0&&this.newpass1.length>0&&this.newpass1==this.newpass2?this.request.post("v1/user/update",{old_password:this.oldpass,new_password:this.newpass1}).then(function(){alert("Password modification is successful, click to confirm to log in again"),location.href="/#/login"}):alert("The two password entries are inconsistent, please re-enter")},createToken:function(){var t=this,a=prompt("Please enter remarks information");a&&a.length&&this.request.post("v1/api/token",{description:a}).then(function(){t.loadTokens(1)})},editToken:function(t){var a=this,e=prompt("Please enter new remarks information");e&&this.request.post("v1/api/token",{description:e,token:t.token}).then(function(){a.loadTokens(1)})},deleteToken:function(t){var a=this;if(confirm("Delete"+t.token+"?")){var e={token:t.token};this.request.post("v1/api/token/delete",e).then(function(){a.loadTokens(1)})}},loadTokens:function(t){var a=this;return this.loading=!0,this.request.post("v1/api/token/get",{page:t,perpage:10}).then(function(e){a.currentPage=t,a.data=e.data,a.total=e.total,a.loading=!1})}}},At={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("div",{staticClass:"card"},[t._m(0),t._v(" "),e("div",{staticClass:"card-body"},[e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          old password\n        ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.oldpass,expression:"oldpass"}],staticClass:"form-control",attrs:{type:"password",autocomplete:"off"},domProps:{value:t.oldpass},on:{input:function(a){a.target.composing||(t.oldpass=a.target.value)}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n         new password\n        ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.newpass1,expression:"newpass1"}],staticClass:"form-control",attrs:{type:"password",autocomplete:"off"},domProps:{value:t.newpass1},on:{input:function(a){a.target.composing||(t.newpass1=a.target.value)}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n         Enter the new password again\n        ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.newpass2,expression:"newpass2"}],staticClass:"form-control",attrs:{type:"password",autocomplete:"off"},domProps:{value:t.newpass2},on:{input:function(a){a.target.composing||(t.newpass2=a.target.value)}}})])]),t._v(" "),e("div",{staticClass:"card-footer text-right"},[e("div",{staticClass:"d-flex"},[e("button",{staticClass:"btn btn-primary",on:{click:function(a){return t.changePass()}}},[t._v("\n          Save\n        ")])])])]),t._v(" "),e("div",{staticClass:"card"},[t._m(1),t._v(" "),e("div",{staticClass:"card-body"},[t.loading?e("vue-loading",{attrs:{type:"spiningDubbles",color:"rgb(90, 193, 221)",size:{width:"50px",height:"50px"}}}):t._e(),t._v(" "),t.loading?t._e():e("table",{staticClass:"table table-striped table-bordered"},[t._m(2),t._v(" "),e("tbody",t._l(t.data,function(a){return e("tr",{key:a.token},[e("td",{attrs:{nowrap:""}},[t._v("\n              "+t._s(a.token)+"\n            ")]),t._v(" "),e("td",[t._v("\n              "+t._s(a.description)+"\n            ")]),t._v(" "),e("td",{attrs:{nowrap:""}},[e("a",{attrs:{href:"javascript:"},on:{click:function(e){return t.editToken(a)}}},[t._v("\n               edit\n              ")]),t._v(" "),e("a",{attrs:{href:"javascript:"},on:{click:function(e){return t.deleteToken(a)}}},[t._v("\n               delete\n              ")])])])}),0)]),t._v(" "),t.loading?t._e():e("nav",[e("b-pagination",{attrs:{align:"center","total-rows":t.total,"per-page":10},on:{change:t.loadTokens},model:{value:t.currentPage,callback:function(a){t.currentPage=a},expression:"currentPage"}})],1)],1),t._v(" "),e("div",{staticClass:"card-footer text-right"},[e("div",{staticClass:"d-flex"},[e("button",{staticClass:"btn btn-primary",on:{click:function(a){return t.createToken()}}},[t._v("\n         create\n        ")])])])])])},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"card-header"},[a("h3",{staticClass:"card-title"},[this._v("\n        Modify login password\n      ")])])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"card-header"},[a("h3",{staticClass:"card-title"},[this._v("\n       TOKEN management\n        "),a("a",{staticStyle:{color:"#467fcf"},attrs:{href:"https://rasp.baidu.com/doc/hacking/cloud-api.html#panel-api-description",target:"_blank"}},[this._v("[Help Document]")])])])},function(){var t=this.$createElement,a=this._self._c||t;return a("thead",[a("tr",[a("th",[this._v("\n              Token\n            ")]),this._v(" "),a("th",[this._v("\n             Remarks\n            ")]),this._v(" "),a("th",[this._v("\n             operating\n            ")])])])}]},St=e("VU/8")($t,At,!1,null,null,null).exports,Dt={name:"GeneralSettings",data:function(){return{weak_password_list:"",dependency_check:{min_interval:60,max_interval:86400},cpu_usage:{min_percent:30,max_percent:100,min_interval:1,max_interval:1800},sampler_interval:{close:0,min_period:60},data:{rasp_config:{}}}},computed:E()({},Object(c.c)(["current_app","sticky"])),methods:E()({},Object(c.d)(["setCurrentApp"]),{setData:function(t){this.data=t,this.data["security.weak_passwords"]&&(this.weak_password_list=this.data["security.weak_passwords"].join(","))},doSave:function(){if(this.data["log.maxstack"]=this.data["plugin.maxstack"],this.data["security.weak_passwords"]=b(this.weak_password_list,","),this.data["security.weak_passwords"].push(""),this.data["security.weak_passwords"].length>200)alert("In order to reduce memory usage, a maximum of 200 weak passwords are allowed, the current number is"+this.data["security.weak_passwords"].length+"条");else if(delete this.data["security.weak_password"],this.data["dependency_check.interval"]<this.dependency_check.min_interval||this.data["dependency_check.interval"]>this.dependency_check.max_interval)alert("Interval range of collection tasks："+this.dependency_check.min_interval+"~"+this.dependency_check.max_interval);else if(this.data["cpu.usage.percent"]<this.cpu_usage.min_percent||this.data["cpu.usage.percent"]>this.cpu_usage.max_percent)alert("Single core CPU usage threshold："+this.cpu_usage.min_percent+"~"+this.cpu_usage.max_percent);else if(this.data["cpu.usage.interval"]<this.cpu_usage.min_interval||this.data["cpu.usage.interval"]>this.cpu_usage.max_interval)alert("Single-core CPU usage collection interval:"+this.cpu_usage.min_interval+"~"+this.cpu_usage.max_interval);else if(this.data["response.sampler_interval"]<this.sampler_interval.min_period&&this.data["response.sampler_interval"]>this.sampler_interval.close)alert("The minimum sampling period is 60s");else if(this.data["offline_hosts.cleanup.interval"]<0)alert("Offline host cleanup time must be greater than 0");else{var t={app_id:this.current_app.id,config:this.data};this.request.post("v1/api/app/general/config",t).then(function(){alert("Save successfully")})}}})},Et={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("div",{staticClass:"card"},[t._m(0),t._v(" "),e("div",{staticClass:"card-body"},[e("div",{staticClass:"form-group"},[t._m(1),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.data["clientip.header"],expression:"data['clientip.header']",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text",maxlength:"100"},domProps:{value:t.data["clientip.header"]},on:{input:function(a){a.target.composing||t.$set(t.data,"clientip.header",a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n         Custom intercept status code\n        ")]),t._v(" "),e("b-form-select",{attrs:{options:[200,302,403,404,500]},model:{value:t.data["block.status_code"],callback:function(a){t.$set(t.data,"block.status_code",t._n(a))},expression:"data['block.status_code']"}})],1),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          Custom interception jump page [Only the custom interception status code is 302 effective]\n        ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.data["block.redirect_url"],expression:"data['block.redirect_url']",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.data["block.redirect_url"]},on:{input:function(a){a.target.composing||t.$set(t.data,"block.redirect_url",a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[t._m(2),t._v(" "),e("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:t.data["block.content_html"],expression:"data['block.content_html']",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.data["block.content_html"]},on:{input:function(a){a.target.composing||t.$set(t.data,"block.content_html",a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[t._m(3),t._v(" "),e("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:t.data["block.content_xml"],expression:"data['block.content_xml']",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.data["block.content_xml"]},on:{input:function(a){a.target.composing||t.$set(t.data,"block.content_xml",a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[t._m(4),t._v(" "),e("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:t.data["block.content_json"],expression:"data['block.content_json']",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.data["block.content_json"]},on:{input:function(a){a.target.composing||t.$set(t.data,"block.content_json",a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          How many bytes of body can be read at most\n        ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.data["body.maxbytes"],expression:"data['body.maxbytes']",modifiers:{number:!0}}],staticClass:"form-control",attrs:{type:"number",min:"0"},domProps:{value:t.data["body.maxbytes"]},on:{input:function(a){a.target.composing||t.$set(t.data,"body.maxbytes",t._n(a.target.value))},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[t._m(5),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.data["request.param_encoding"],expression:"data['request.param_encoding']"}],staticClass:"form-control",attrs:{type:"text",placeholder:""},domProps:{value:t.data["request.param_encoding"]},on:{input:function(a){a.target.composing||t.$set(t.data,"request.param_encoding",a.target.value)}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          Debug switch [0 means off, value above 1 means on]\n        ")]),t._v(" "),e("b-form-select",{attrs:{options:[0,1]},model:{value:t.data["debug.level"],callback:function(a){t.$set(t.data,"debug.level",t._n(a))},expression:"data['debug.level']"}})],1),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          Automatically clean up hosts that have been offline for more than N days [0 means off, a value above 1 means on; cleanup tasks are executed every day at zero]\n        ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.data["offline_hosts.cleanup.interval"],expression:"data['offline_hosts.cleanup.interval']",modifiers:{number:!0}}],staticClass:"form-control",attrs:{type:"number",min:"0",placeholder:"0"},domProps:{value:t.data["offline_hosts.cleanup.interval"]},on:{input:function(a){a.target.composing||t.$set(t.data,"offline_hosts.cleanup.interval",t._n(a.target.value))},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          LRU size [default 1000, to close write 0]\n        ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.data["lru.max_size"],expression:"data['lru.max_size']",modifiers:{number:!0}}],staticClass:"form-control",attrs:{type:"number",min:"0",placeholder:"1000"},domProps:{value:t.data["lru.max_size"]},on:{input:function(a){a.target.composing||t.$set(t.data,"lru.max_size",t._n(a.target.value))},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          LRU original string upper limit [If not enabled, only the hash will be stored; if enabled, the original string will be stored at the same time, if the string exceeds the upper limit, it will directly enter the plug-in detection; range 1-102400]\n        ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.data["lru.compare_limit"],expression:"data['lru.compare_limit']",modifiers:{number:!0}}],staticClass:"form-control",attrs:{type:"number",min:"0",placeholder:"10240"},domProps:{value:t.data["lru.compare_limit"]},on:{input:function(a){a.target.composing||t.$set(t.data,"lru.compare_limit",t._n(a.target.value))},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          [Baseline] Weak password list, suitable for database, Tomcat management background, etc.; the upper limit is 200, and the maximum length of a single is 16, separated by commas\n        ")]),t._v(" "),e("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:t.weak_password_list,expression:"weak_password_list",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text",placeholder:"111111,123,123123,123456,123456a,a123456,admin,both,manager,mysql,root,rootweblogic, tomcat,user,weblogic1,weblogic123,welcome1"},domProps:{value:t.weak_password_list},on:{input:function(a){a.target.composing||(t.weak_password_list=a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          [Baseline] [Web Root Directory Sensitive File Check] Regular file name, only supported by PHP, up to 100 characters\n        ")]),t._v(" "),e("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:t.data["fileleak_scan.name"],expression:"data['fileleak_scan.name']",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text",maxlen:"100",placeholder:"\\.(git|svn|tar|gz|rar |zip|sql|log)$"},domProps:{value:t.data["fileleak_scan.name"]},on:{input:function(a){a.target.composing||t.$set(t.data,"fileleak_scan.name",a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          [Baseline] [Web root directory sensitive file check] Scan interval (seconds), range 60-86400\n        ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.data["fileleak_scan.interval"],expression:"data['fileleak_scan.interval']",modifiers:{number:!0}}],staticClass:"form-control",attrs:{type:"number",placeholder:"21600",min:"60"},domProps:{value:t.data["fileleak_scan.interval"]},on:{input:function(a){a.target.composing||t.$set(t.data,"fileleak_scan.interval",t._n(a.target.value))},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          [Baseline] [Web Root Directory Sensitive File Check] How many files can be checked at most, write 0 to disable this function\n        ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.data["fileleak_scan.limit"],expression:"data['fileleak_scan.limit']",modifiers:{number:!0}}],staticClass:"form-control",attrs:{type:"number",placeholder:"100",min:"0"},domProps:{value:t.data["fileleak_scan.limit"]},on:{input:function(a){a.target.composing||t.$set(t.data,"fileleak_scan.limit",t._n(a.target.value))},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          [Plugin] Maximum execution time of a single hook point (ms)\n        ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.data["plugin.timeout.millis"],expression:"data['plugin.timeout.millis']",modifiers:{number:!0}}],staticClass:"form-control",attrs:{min:"0",type:"number",placeholder:"100"},domProps:{value:t.data["plugin.timeout.millis"]},on:{input:function(a){a.target.composing||t.$set(t.data,"plugin.timeout.millis",t._n(a.target.value))},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          [Plugin] The maximum stack depth passed to the plugin\n        ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.data["plugin.maxstack"],expression:"data['plugin.maxstack']",modifiers:{number:!0}}],staticClass:"form-control",attrs:{type:"number",min:"0",placeholder:"100"},domProps:{value:t.data["plugin.maxstack"]},on:{input:function(a){a.target.composing||t.$set(t.data,"plugin.maxstack",t._n(a.target.value))},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          [Log] The maximum number of logs per second per process/thread\n        ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.data["log.maxburst"],expression:"data['log.maxburst']",modifiers:{number:!0}}],staticClass:"form-control",attrs:{type:"number",min:"0",placeholder:"100"},domProps:{value:t.data["log.maxburst"]},on:{input:function(a){a.target.composing||t.$set(t.data,"log.maxburst",t._n(a.target.value))},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          [Log] Maximum backup days\n        ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.data["log.maxbackup"],expression:"data['log.maxbackup']",modifiers:{number:!0}}],staticClass:"form-control",attrs:{type:"number",min:"0",placeholder:"30"},domProps:{value:t.data["log.maxbackup"]},on:{input:function(a){a.target.composing||t.$set(t.data,"log.maxbackup",t._n(a.target.value))},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          [Fuse] Single-core CPU occupancy rate collection interval (seconds), range 1-1800\n        ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.data["cpu.usage.interval"],expression:"data['cpu.usage.interval']",modifiers:{number:!0}}],staticClass:"form-control",attrs:{type:"number",min:"1",max:"1800",placeholder:"5"},domProps:{value:t.data["cpu.usage.interval"]},on:{input:function(a){a.target.composing||t.$set(t.data,"cpu.usage.interval",t._n(a.target.value))},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          [Fuse] Single-core CPU usage threshold (percentage), range 30-100\n        ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.data["cpu.usage.percent"],expression:"data['cpu.usage.percent']",modifiers:{number:!0}}],staticClass:"form-control",attrs:{type:"number",min:"30",max:"100",placeholder:"90"},domProps:{value:t.data["cpu.usage.percent"]},on:{input:function(a){a.target.composing||t.$set(t.data,"cpu.usage.percent",t._n(a.target.value))},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          [Class Library Information] Collection task interval (seconds), range 60-86400\n        ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.data["dependency_check.interval"],expression:"data['dependency_check.interval']",modifiers:{number:!0}}],staticClass:"form-control",attrs:{type:"number",min:"60",max:"86400",placeholder:"43200"},domProps:{value:t.data["dependency_check.interval"]},on:{input:function(a){a.target.composing||t.$set(t.data,"dependency_check.interval",t._n(a.target.value))},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          [Response detection] Sampling period (seconds), set to 0 to close, the minimum is 60\n        ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.data["response.sampler_interval"],expression:"data['response.sampler_interval']",modifiers:{number:!0}}],staticClass:"form-control",attrs:{type:"number",min:"60",placeholder:"60"},domProps:{value:t.data["response.sampler_interval"]},on:{input:function(a){a.target.composing||t.$set(t.data,"response.sampler_interval",t._n(a.target.value))},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n          [Response detection] In the sampling period, how many times can be detected at most, set to 0 to close\n        ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.number",value:t.data["response.sampler_burst"],expression:"data['response.sampler_burst']",modifiers:{number:!0}}],staticClass:"form-control",attrs:{type:"number",min:"0",placeholder:"5"},domProps:{value:t.data["response.sampler_burst"]},on:{input:function(a){a.target.composing||t.$set(t.data,"response.sampler_burst",t._n(a.target.value))},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"custom-switch"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.data["cpu.usage.enable"],expression:"data['cpu.usage.enable']"}],staticClass:"custom-switch-input",attrs:{type:"checkbox",checked:"data['cpu.usage.enable']"},domProps:{checked:Array.isArray(t.data["cpu.usage.enable"])?t._i(t.data["cpu.usage.enable"],null)>-1:t.data["cpu.usage.enable"]},on:{change:function(a){var e=t.data["cpu.usage.enable"],s=a.target,n=!!s.checked;if(Array.isArray(e)){var i=t._i(e,null);s.checked?i<0&&t.$set(t.data,"cpu.usage.enable",e.concat([null])):i>-1&&t.$set(t.data,"cpu.usage.enable",e.slice(0,i).concat(e.slice(i+1)))}else t.$set(t.data,"cpu.usage.enable",n)}}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v("\n            Turn on fuse protection:      When the CPU usage continues to exceed a certain value, turn off all protections (only Java >= 1.2.1 support)\n          ")])]),t._v(" "),e("br"),t._v(" "),e("label",{staticClass:"custom-switch"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.data["plugin.filter"],expression:"data['plugin.filter']"}],staticClass:"custom-switch-input",attrs:{type:"checkbox",checked:"data['plugin.filter']"},domProps:{checked:Array.isArray(t.data["plugin.filter"])?t._i(t.data["plugin.filter"],null)>-1:t.data["plugin.filter"]},on:{change:function(a){var e=t.data["plugin.filter"],s=a.target,n=!!s.checked;if(Array.isArray(e)){var i=t._i(e,null);s.checked?i<0&&t.$set(t.data,"plugin.filter",e.concat([null])):i>-1&&t.$set(t.data,"plugin.filter",e.slice(0,i).concat(e.slice(i+1)))}else t.$set(t.data,"plugin.filter",n)}}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v("\n            Enable file filter: do not call the detection plugin when the file does not exist\n          ")])]),t._v(" "),e("br"),t._v(" "),e("label",{staticClass:"custom-switch"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.data["decompile.enable"],expression:"data['decompile.enable']"}],staticClass:"custom-switch-input",attrs:{type:"checkbox",checked:"data['decompile.enable']"},domProps:{checked:Array.isArray(t.data["decompile.enable"])?t._i(t.data["decompile.enable"],null)>-1:t.data["decompile.enable"]},on:{change:function(a){var e=t.data["decompile.enable"],s=a.target,n=!!s.checked;if(Array.isArray(e)){var i=t._i(e,null);s.checked?i<0&&t.$set(t.data,"decompile.enable",e.concat([null])):i>-1&&t.$set(t.data,"decompile.enable",e.slice(0,i).concat(e.slice(i+1)))}else t.$set(t.data,"decompile.enable",n)}}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),t._m(6)]),t._v(" "),e("br"),t._v(" "),e("label",{staticClass:"custom-switch"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.data["lru.compare_enable"],expression:"data['lru.compare_enable']"}],staticClass:"custom-switch-input",attrs:{type:"checkbox",checked:"data['lru.compare_enable']"},domProps:{checked:Array.isArray(t.data["lru.compare_enable"])?t._i(t.data["lru.compare_enable"],null)>-1:t.data["lru.compare_enable"]},on:{change:function(a){var e=t.data["lru.compare_enable"],s=a.target,n=!!s.checked;if(Array.isArray(e)){var i=t._i(e,null);s.checked?i<0&&t.$set(t.data,"lru.compare_enable",e.concat([null])):i>-1&&t.$set(t.data,"lru.compare_enable",e.slice(0,i).concat(e.slice(i+1)))}else t.$set(t.data,"lru.compare_enable",n)}}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v("\n            Enable LRU raw string comparison (only supported by Java >= 1.2.2)\n          ")])])])]),t._v(" "),e("div",{class:{"card-footer":!0,"sticky-card-footer":t.sticky}},[e("div",{staticClass:"d-flex"},[e("button",{staticClass:"btn btn-primary",attrs:{type:"submit"},on:{click:function(a){return t.doSave()}}},[t._v("\n          save          \n        ")])])])])])},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"card-header"},[a("h3",{staticClass:"card-title"},[this._v("\n        General settings\n      ")])])},function(){var t=this.$createElement,a=this._self._c||t;return a("label",{staticClass:"form-label"},[this._v("\n          Real IP header\n          "),a("a",{attrs:{target:"_blank",href:"https://rasp.baidu.com/doc/setup/panel.html#reverse-proxy"}},[this._v("\n            [Help Document]\n          ")])])},function(){var t=this.$createElement,a=this._self._c||t;return a("label",{staticClass:"form-label"},[this._v("\n         Custom HTML response content\n          "),a("a",{attrs:{href:"https://rasp.baidu.com/doc/setup/others.html#common-block",target:"_blank"}},[this._v("\n          [Help Document]\n          ")])])},function(){var t=this.$createElement,a=this._self._c||t;return a("label",{staticClass:"form-label"},[this._v("\n         Custom XML response content\n          "),a("a",{attrs:{href:"https://rasp.baidu.com/doc/setup/others.html#common-block",target:"_blank"}},[this._v("\n           [Help Document]\n          ")])])},function(){var t=this.$createElement,a=this._self._c||t;return a("label",{staticClass:"form-label"},[this._v("\n            Custom JSON response content\n          "),a("a",{attrs:{href:"https://rasp.baidu.com/doc/setup/others.html#common-block",target:"_blank"}},[this._v("\n            [Help Document]\n          ")])])},function(){var t=this.$createElement,a=this._self._c||t;return a("label",{staticClass:"form-label"},[this._v("\n          Set request encoding\n          "),a("a",{attrs:{href:"https://rasp.baidu.com/doc/setup/others.html#common-others",target:"_blank"}},[this._v("\n            [Help Document]\n          ")])])},function(){var t=this.$createElement,a=this._self._c||t;return a("span",{staticClass:"custom-switch-description"},[this._v("\n            Enable disassembly function: automatically extract application source code\n            "),a("a",{attrs:{href:"https://rasp.baidu.com/doc/setup/panel.html#decompiler",target:"_blank"}},[this._v("\n              [Help Document]\n            ")])])}]},jt=e("VU/8")(Dt,Et,!1,null,null,null).exports,Mt=e("gRE1"),qt=e.n(Mt),Nt={name:"WhitelistSettings",data:function(){return{data:[],index:0,fields:[{key:"index",label:"#",tdAttr:{nowrap:""}},{key:"url",label:"URL"},{key:"hook",label:"check Point",tdAttr:{style:"min-width: 150px; "}},{key:"description",label:"Remarks"},{key:"command",label:"operating",tdAttr:{nowrap:""}}],modalData:{url:"",hook:{},description:""},attack_types:f}},computed:E()({},Object(c.c)(["current_app","sticky"])),mounted:function(){},methods:E()({},Object(c.d)(["setSticky"]),{whitelist2str:function(t){return Y()(t).filter(function(a){return t[a]}).map(function(t){return C(t)}).join(", ")},setData:function(t){this.data=t},showModal:function(t){-1===t&&this.data.length>=200?alert("In order to ensure performance, the whitelist supports up to 200 entries"):(this.setSticky(!1),this.index=t,ft()(this.modalData,JSON.parse(dt()(this.data[t]||{}))),this.$refs.modal.show())},hideModal:function(t){if(!0===t){if(!this.modalData.url||0==this.modalData.url.trim().length)return void alert("URL is not filled in");if(this.modalData.url.startsWith("http://")||this.modalData.url.startsWith("https://"))return void alert("URL does not need to start with http/https, please delete");if(qt()(this.modalData.hook).indexOf(!0)<0)return void alert("Please select at least one hook point to whitelist");-1==this.index&&(this.index=this.data.length),this.$set(this.data,this.index,this.modalData)}this.modalData={url:"",hook:{},description:""},this.$refs.modal.hide(),this.setSticky(!0)},deleteItem:function(t){confirm("confirm deletion?")&&this.data.splice(t,1)},doSave:function(){return this.data.forEach(function(t){for(var a in t.hook)t.hook[a]||delete t.hook[a]}),this.request.post("v1/api/app/whitelist/config",{app_id:this.current_app.id,config:this.data}).then(function(){alert("Successfully saved")})}})},Rt={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("div",{staticClass:"card"},[t._m(0),t._v(" "),e("div",{staticClass:"card-body"},[e("p",[t._v("A maximum of 200 URLs are allowed, and the length of a single URL is limited to 200 characters")]),t._v(" "),e("b-table",{attrs:{hover:"",bordered:"",items:t.data,fields:t.fields},scopedSlots:t._u([{key:"cell(index)",fn:function(a){return[t._v("\n          "+t._s(a.index+1)+"\n        ")]}},{key:"cell(hook)",fn:function(a){return[a.value.all?e("span",[t._v("\n            All hook points\n          ")]):t._e(),t._v(" "),a.value.all?t._e():e("span",[t._v("\n            "+t._s(t.whitelist2str(a.value))+"\n          ")])]}},{key:"cell(command)",fn:function(a){return[e("a",{attrs:{href:"javascript:"},on:{click:function(e){return t.showModal(a.index)}}},[t._v("\n           edit\n          ")]),t._v(" "),e("a",{attrs:{href:"javascript:"},on:{click:function(e){return t.deleteItem(a.index)}}},[t._v("\n           delete\n          ")])]}}])}),t._v(" "),0==t.data.length?e("p",{staticClass:"text-center"},[t._v("No data")]):t._e()],1),t._v(" "),e("div",{class:{"card-footer":!0,"sticky-card-footer":t.sticky}},[e("button",{staticClass:"btn btn-info",on:{click:function(a){return t.showModal(-1)}}},[t._v("\n        Add to\n      ")]),t._v(" "),e("button",{staticClass:"btn btn-primary pull-right",on:{click:function(a){return t.doSave()}}},[t._v("\n       Save\n      ")])])]),t._v(" "),e("b-modal",{ref:"modal",attrs:{id:"whitelistEditModal","no-fade":"",title:"添加/编辑 白名单",size:"lg","hide-header-close":""},on:{hidden:function(a){return t.hideModal()},shown:function(a){return t.$refs.focus.focus()}}},[e("div",{staticClass:"form-group"},[e("label",[t._v("URL prefix-does not distinguish between http/https, does not support wildcards or regular, format such as"),e("span",{staticClass:"text-danger"},[t._v("rasp.baidu.com/phpmyadmin/")]),t._v("；To match all URLs, write "),e("strong",[t._v("*")])]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.modalData.url,expression:"modalData.url",modifiers:{trim:!0}}],ref:"focus",staticClass:"form-control",attrs:{maxlength:"200",type:"text",maxlen:"200"},domProps:{value:t.modalData.url},on:{input:function(a){a.target.composing||t.$set(t.modalData,"url",a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",[t._v("Whitelist note (optional)")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.modalData.description,expression:"modalData.description",modifiers:{trim:!0}}],ref:"focus",staticClass:"form-control",attrs:{maxlength:"200",type:"text",maxlen:"200"},domProps:{value:t.modalData.description},on:{input:function(a){a.target.composing||t.$set(t.modalData,"description",a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",[t._v("check Point")]),t._v(" "),e("div",{staticClass:"row"},[e("div",{staticClass:"col-12"},[e("label",{staticClass:"custom-switch"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.modalData.hook.all,expression:"modalData.hook.all"}],staticClass:"custom-switch-input",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.modalData.hook.all)?t._i(t.modalData.hook.all,null)>-1:t.modalData.hook.all},on:{change:function(a){var e=t.modalData.hook.all,s=a.target,n=!!s.checked;if(Array.isArray(e)){var i=t._i(e,null);s.checked?i<0&&t.$set(t.modalData.hook,"all",e.concat([null])):i>-1&&t.$set(t.modalData.hook,"all",e.slice(0,i).concat(e.slice(i+1)))}else t.$set(t.modalData.hook,"all",n)}}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v("\n             Turn off all detection points\n            ")])])])]),t._v(" "),t.modalData.hook.all?t._e():e("div",{staticClass:"row"},t._l(t.attack_types,function(a,s){return e("div",{key:s,staticClass:"col-6"},[e("label",{staticClass:"custom-switch"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.modalData.hook[s],expression:"modalData.hook[key]"}],staticClass:"custom-switch-input",attrs:{type:"checkbox"},domProps:{value:s,checked:Array.isArray(t.modalData.hook[s])?t._i(t.modalData.hook[s],s)>-1:t.modalData.hook[s]},on:{change:function(a){var e=t.modalData.hook[s],n=a.target,i=!!n.checked;if(Array.isArray(e)){var r=s,l=t._i(e,r);n.checked?l<0&&t.$set(t.modalData.hook,s,e.concat([r])):l>-1&&t.$set(t.modalData.hook,s,e.slice(0,l).concat(e.slice(l+1)))}else t.$set(t.modalData.hook,s,i)}}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v("\n              "+t._s(a)+"\n            ")])])])}),0)]),t._v(" "),e("div",{staticClass:"w-100",attrs:{slot:"modal-footer"},slot:"modal-footer"},[e("b-button",{staticClass:"float-right ml-2 btn-info",attrs:{variant:"default"},on:{click:function(a){return t.hideModal()}}},[t._v("\n       cancel\n      ")]),t._v(" "),e("b-button",{staticClass:"float-right ml-2",attrs:{variant:"primary"},on:{click:function(a){return t.hideModal(!0)}}},[t._v("\n      determine\n      ")])],1)])],1)},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"card-header"},[a("h3",{staticClass:"card-title"},[this._v("\n        Protection engine whitelist\n      ")])])}]},Ut=e("VU/8")(Nt,Rt,!1,null,null,null).exports,Tt={name:"AlgorithmConfigModal",data:function(){return{key:"",data:{},shouldSave:!1,command_common_error:!1,sql_regex_error:!1,eval_regex_error:!1,protocol_concat:"",error_code_concat:"",sql_policy_keys:[{key:"stacked_query",descr:"Intercept the execution of multiple statements, such as select ...; update ..."},{key:"no_hex",descr:"Intercept hexadecimal strings, such as 0x41424344"},{key:"version_comment",descr:"Intercept the version number comment, such as select/*!500001,2,*/3"},{key:"function_blacklist",descr:"Intercept blacklist functions, such as load_file, sleep, updatexml"},{key:"function_count",descr:"Function frequency algorithm, such as chr(123)||chr(123)||chr(123)"},{key:"union_null",descr:"Intercept 3 consecutive NULLs or numbers, such as select NULL, NULL, NULL"},{key:"into_outfile",descr:"Intercept into outfile write file operation"},{key:"information_schema",descr:"Intercept information_schema related operations"}],command_error_keys:[{key:"unbalanced_quote_enable",descr:"Check the number of single and double backquotes, whether it is a base"},{key:"sensitive_cmd_enable",descr:"Check for malicious command splicing operations, such as | bash"},{key:"alarm_token_enable",descr:"Check for malicious TOKEN, such as $IFS"}]}},watch:{"data.regex":function(t,a){"sql_regex"==this.key&&(this.sql_regex_error=this.validateRegex(t))},"data.pattern":function(t,a){"command_common"==this.key&&(this.command_common_error=this.validateRegex(t))}},computed:E()({},Object(c.c)(["current_app","app_list","sticky"])),mounted:function(){var t=this;$("#algorithmConfigModal").on("hidden.bs.modal",function(){t.setSticky(!0)})},methods:E()({},Object(c.d)(["setSticky"]),{validateRegex:y,showModal:function(t,a){this.setSticky(!1),this.key=t,this.data=JSON.parse(dt()(a)),this.key.endsWith("_protocol")&&(this.protocol_concat=this.data.protocols.join(",")),"sql_exception"==this.key&&(this.error_code_concat=this.data.mysql.error_code.join(",")),$("#algorithmConfigModal").modal({})},saveConfig:function(){var t,a;"sql_exception"==this.key&&(this.data.mysql.error_code=(t=b(this.error_code_concat,","),a=[],t.forEach(function(t){a.push(parseInt(t))}),a.filter(function(t){return t}))),this.key.endsWith("_protocol")&&(this.data.protocols=b(this.protocol_concat,","));var e={key:this.key,data:this.data};this.$emit("save",e)}})},Lt={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"modal no-fade",attrs:{id:"algorithmConfigModal",tabindex:"-1",role:"dialog"}},[e("div",{staticClass:"modal-dialog",attrs:{role:"document"}},[e("div",{staticClass:"modal-content"},[t._m(0),t._v(" "),e("div",{staticClass:"modal-body"},["sql_userinput"==t.key?e("div",[e("label",{staticClass:"custom-switch m-0"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.data.pre_enable,expression:"data.pre_enable"}],staticClass:"custom-switch-input",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.data.pre_enable)?t._i(t.data.pre_enable,null)>-1:t.data.pre_enable},on:{change:function(a){var e=t.data.pre_enable,s=a.target,n=!!s.checked;if(Array.isArray(e)){var i=t._i(e,null);s.checked?i<0&&t.$set(t.data,"pre_enable",e.concat([null])):i>-1&&t.$set(t.data,"pre_enable",e.slice(0,i).concat(e.slice(i+1)))}else t.$set(t.data,"pre_enable",n)}}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v("Enable keyword filtering: no alarm when there are loopholes but no attacks")])]),t._v(" "),e("label",{staticClass:"custom-switch m-0"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.data.allow_full,expression:"data.allow_full"}],staticClass:"custom-switch-input",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.data.allow_full)?t._i(t.data.allow_full,null)>-1:t.data.allow_full},on:{change:function(a){var e=t.data.allow_full,s=a.target,n=!!s.checked;if(Array.isArray(e)){var i=t._i(e,null);s.checked?i<0&&t.$set(t.data,"allow_full",e.concat([null])):i>-1&&t.$set(t.data,"allow_full",e.slice(0,i).concat(e.slice(i+1)))}else t.$set(t.data,"allow_full",n)}}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v("Allow database query: Pass the complete SQL statement through the interface and execute it")])])]):t._e(),t._v(" "),"sql_policy"==t.key?e("div",t._l(t.sql_policy_keys,function(a){return e("div",{key:a.key},[e("label",{staticClass:"custom-switch m-0"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.data.feature[a.key],expression:"data.feature[row.key]"}],staticClass:"custom-switch-input",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.data.feature[a.key])?t._i(t.data.feature[a.key],null)>-1:t.data.feature[a.key]},on:{change:function(e){var s=t.data.feature[a.key],n=e.target,i=!!n.checked;if(Array.isArray(s)){var r=t._i(s,null);n.checked?r<0&&t.$set(t.data.feature,a.key,s.concat([null])):r>-1&&t.$set(t.data.feature,a.key,s.slice(0,r).concat(s.slice(r+1)))}else t.$set(t.data.feature,a.key,i)}}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v(t._s(a.descr))])]),t._v(" "),e("br")])}),0):t._e(),t._v(" "),"command_error"==t.key?e("div",t._l(t.command_error_keys,function(a){return e("div",{key:a.key},[e("label",{staticClass:"custom-switch m-0"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.data[a.key],expression:"data[row.key]"}],staticClass:"custom-switch-input",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.data[a.key])?t._i(t.data[a.key],null)>-1:t.data[a.key]},on:{change:function(e){var s=t.data[a.key],n=e.target,i=!!n.checked;if(Array.isArray(s)){var r=t._i(s,null);n.checked?r<0&&t.$set(t.data,a.key,s.concat([null])):r>-1&&t.$set(t.data,a.key,s.slice(0,r).concat(s.slice(r+1)))}else t.$set(t.data,a.key,i)}}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v(t._s(a.descr))])]),t._v(" "),e("br")])}),0):t._e(),t._v(" "),t.key.endsWith("_protocol")?e("div",[e("label",[t._v("A list of protocols that are prohibited from loading, separated by commas")]),t._v(" "),e("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:t.protocol_concat,expression:"protocol_concat",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{autocomplete:"off",autocorrect:"off",autocapitalize:"off",spellcheck:"false"},domProps:{value:t.protocol_concat},on:{input:function(a){a.target.composing||(t.protocol_concat=a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]):t._e(),t._v(" "),"eval_regex"==t.key?e("div",[e("label",[t._v("EVAL statement regular expression")]),t._v(" "),e("div",{class:{"form-group":!0,"has-error":t.eval_regex_error}},[e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.data.regex,expression:"data.regex",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.data.regex},on:{input:function(a){a.target.composing||t.$set(t.data,"regex",a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),t.eval_regex_error?e("span",{staticClass:"text-danger"},[t._v(t._s(t.eval_regex_error))]):t._e()]):t._e(),t._v(" "),"sql_regex"==t.key?e("div",[e("label",[t._v("SQL statement regular expression")]),t._v(" "),e("div",{class:{"form-group":!0,"has-error":t.sql_regex_error}},[e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.data.regex,expression:"data.regex",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.data.regex},on:{input:function(a){a.target.composing||t.$set(t.data,"regex",a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),t.sql_regex_error?e("span",{staticClass:"text-danger"},[t._v(t._s(t.sql_regex_error))]):t._e()]):t._e(),t._v(" "),"sql_exception"==t.key?e("div",[e("label",[t._v("SQL exception codes (comma separated; custom error codes are not supported before v1.2.1）")]),t._v(" "),e("div",{staticClass:"form-group"},[e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.error_code_concat,expression:"error_code_concat",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.error_code_concat},on:{input:function(a){a.target.composing||(t.error_code_concat=a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})])]):t._e(),t._v(" "),"command_common"==t.key?e("div",[e("label",[t._v("Penetration Command Probe-Regular Expression")]),t._v(" "),e("div",{class:{"form-group":!0,"has-error":t.command_common_error}},[e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.data.pattern,expression:"data.pattern",modifiers:{trim:!0}}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.data.pattern},on:{input:function(a){a.target.composing||t.$set(t.data,"pattern",a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),t.command_common_error?e("span",{staticClass:"text-danger"},[t._v(t._s(t.command_common_error))]):t._e()]):t._e(),t._v(" "),"response_dataLeak"==t.key?e("div",[e("label",{staticClass:"custom-switch m-0"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.data.kind.phone,expression:"data.kind.phone"}],staticClass:"custom-switch-input",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.data.kind.phone)?t._i(t.data.kind.phone,null)>-1:t.data.kind.phone},on:{change:function(a){var e=t.data.kind.phone,s=a.target,n=!!s.checked;if(Array.isArray(e)){var i=t._i(e,null);s.checked?i<0&&t.$set(t.data.kind,"phone",e.concat([null])):i>-1&&t.$set(t.data.kind,"phone",e.slice(0,i).concat(e.slice(i+1)))}else t.$set(t.data.kind,"phone",n)}}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v("Detect mobile phone number leakage")])]),t._v(" "),e("br"),t._v(" "),e("label",{staticClass:"custom-switch m-0"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.data.kind.identity_card,expression:"data.kind.identity_card"}],staticClass:"custom-switch-input",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.data.kind.identity_card)?t._i(t.data.kind.identity_card,null)>-1:t.data.kind.identity_card},on:{change:function(a){var e=t.data.kind.identity_card,s=a.target,n=!!s.checked;if(Array.isArray(e)){var i=t._i(e,null);s.checked?i<0&&t.$set(t.data.kind,"identity_card",e.concat([null])):i>-1&&t.$set(t.data.kind,"identity_card",e.slice(0,i).concat(e.slice(i+1)))}else t.$set(t.data.kind,"identity_card",n)}}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v("Detect ID card leaks")])]),t._v(" "),e("br"),t._v(" "),e("label",{staticClass:"custom-switch m-0"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.data.kind.bank_card,expression:"data.kind.bank_card"}],staticClass:"custom-switch-input",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.data.kind.bank_card)?t._i(t.data.kind.bank_card,null)>-1:t.data.kind.bank_card},on:{change:function(a){var e=t.data.kind.bank_card,s=a.target,n=!!s.checked;if(Array.isArray(e)){var i=t._i(e,null);s.checked?i<0&&t.$set(t.data.kind,"bank_card",e.concat([null])):i>-1&&t.$set(t.data.kind,"bank_card",e.slice(0,i).concat(e.slice(i+1)))}else t.$set(t.data.kind,"bank_card",n)}}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v("Detect bank card and credit card leaks")])])]):t._e()]),t._v(" "),e("div",{staticClass:"modal-footer"},[e("button",{staticClass:"btn btn-primary mr-auto",attrs:{"data-dismiss":"modal",disabled:t.sql_regex_error||t.command_common_error},on:{click:function(a){return t.saveConfig()}}},[t._v("\n          确定\n        ")]),t._v(" "),e("button",{staticClass:"btn btn-info",attrs:{"data-dismiss":"modal"}},[t._v("\n          取消\n        ")])])])])])},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"modal-header"},[a("h5",{staticClass:"modal-title"},[this._v("\n         advanced options\n        ")]),this._v(" "),a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}})])}]},Ot={name:"AlgorithmSettings",data:function(){return{items:{},data:{meta:{}},byhost_regex_error:!1,hasAdvancedConfig:{command_common:!0,sql_userinput:!0,sql_policy:!0,sql_exception:!0,sql_regex:!0,eval_regex:!0,include_protocol:!0,xxe_protocol:!0,ssrf_protocol:!0,response_dataLeak:!0,command_error:!0},browser_headers:m}},components:{AlgorithmConfigModal:e("VU/8")(Tt,Lt,!1,null,null,null).exports},computed:E()({},Object(c.c)(["current_app","sticky"])),watch:{current_app:function(){this.loadConfig()},"data.iast.byhost_regex":function(t,a){this.byhost_regex_error=this.validateRegex(t)}},mounted:function(){this.current_app.id&&this.loadConfig()},methods:E()({},Object(c.b)(["loadAppList"]),Object(c.d)(["setCurrentApp"]),{attack_type2name:C,validateRegex:y,showAdvancedConfig:function(t,a){this.$refs.algorithmConfigModal.showModal(t,a)},applyAdvancedConfig:function(t){if(t){var a=t.key;t=t.data;this.data[a]=t}},loadConfig:function(){if(this.current_app.selected_plugin_id.length){var t=this,a={id:this.current_app.selected_plugin_id};this.request.post("v1/api/plugin/get",a).then(function(a){var s=a.algorithm_config,n={};t.data=a.algorithm_config,Y()(s).forEach(function(t){if(-1!=t.indexOf("_")){var a=t.split("_")[0];n[a]||(n[a]={name:a,items:[]}),n[a].items.push({name:s[t].name,key:t})}}),Y()(n).forEach(function(t){n[t].items.sort(e)}),t.items=qt()(n),a.algorithm_config.sql_exception&&a.algorithm_config.sql_exception.mysql||(t.hasAdvancedConfig.sql_exception=!1)})}function e(t,a){return t.name.localeCompare(a.name)}},saveConfig:function(){var t=this,a={id:this.current_app.selected_plugin_id,config:this.data};this.request.post("v1/api/plugin/algorithm/config",a).then(function(){t.loadAppList(t.current_app.id),alert("Save successfully, please wait for a heartbeat cycle to take effect (within 3 minutes, depending on client configuration)")})},resetConfig:function(){var t=this;if(confirm("Restore the default configuration?")){var a={id:this.current_app.selected_plugin_id};this.request.post("v1/api/plugin/algorithm/restore",a).then(function(){t.loadAppList(t.current_app.id),t.loadConfig(),alert("Recovery successful")})}}})},It={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("div",{staticClass:"card"},[e("div",{staticClass:"card-header"},[e("h3",{staticClass:"card-title"},[t._v("\n        "+t._s(t.data.iast?"Scan Settings":"Protection Settings")+"\n      ")])]),t._v(" "),t.current_app.selected_plugin_id&&t.current_app.selected_plugin_id.length?e("div",{staticClass:"card-body"},[t.data.iast?e("div",[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:""}},[t._v("Fuzz server address")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.data.iast.fuzz_server,expression:"data.iast.fuzz_server"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.data.iast.fuzz_server},on:{input:function(a){a.target.composing||t.$set(t.data.iast,"fuzz_server",a.target.value)}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{attrs:{for:""}},[t._v("Fuzz server connection timeout (ms)")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.data.iast.request_timeout,expression:"data.iast.request_timeout"}],staticClass:"form-control",attrs:{type:"number"},domProps:{value:t.data.iast.request_timeout},on:{input:function(a){a.target.composing||t.$set(t.data.iast,"request_timeout",a.target.value)}}})]),t._v(" "),e("div",{class:{"form-group":!0,"has-error":t.byhost_regex_error}},[t._m(0),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.data.iast.byhost_regex,expression:"data.iast.byhost_regex"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.data.iast.byhost_regex},on:{input:function(a){a.target.composing||t.$set(t.data.iast,"byhost_regex",a.target.value)}}}),t._v(" "),t.byhost_regex_error?e("span",{staticClass:"text-danger",staticStyle:{"margin-top":"5px",display:"block"}},[t._v(t._s(t.byhost_regex_error))]):t._e()])]):t._e(),t._v(" "),t.data.meta&&!t.data.iast?e("div",{staticClass:"form-group"},[e("div",{staticClass:"form-label"},[t._v("\n          Quick Setup\n        ")]),t._v(" "),e("label",{staticClass:"custom-switch"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.data.meta.all_log,expression:"data.meta.all_log"}],staticClass:"custom-switch-input",attrs:{type:"checkbox",name:"custom-switch-checkbox"},domProps:{checked:Array.isArray(t.data.meta.all_log)?t._i(t.data.meta.all_log,null)>-1:t.data.meta.all_log},on:{change:function(a){var e=t.data.meta.all_log,s=a.target,n=!!s.checked;if(Array.isArray(e)){var i=t._i(e,null);s.checked?i<0&&t.$set(t.data.meta,"all_log",e.concat([null])):i>-1&&t.$set(t.data.meta,"all_log",e.slice(0,i).concat(e.slice(i+1)))}else t.$set(t.data.meta,"all_log",n)}}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v('\n            Set all algorithms to "logging" mode (except the "XXE prohibit external entity loading" algorithm)\n          ')])]),t._v(" "),e("br"),t._v(" "),e("label",{staticClass:"custom-switch"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.data.meta.is_dev,expression:"data.meta.is_dev"}],staticClass:"custom-switch-input",attrs:{type:"checkbox",name:"custom-switch-checkbox"},domProps:{checked:Array.isArray(t.data.meta.is_dev)?t._i(t.data.meta.is_dev,null)>-1:t.data.meta.is_dev},on:{change:function(a){var e=t.data.meta.is_dev,s=a.target,n=!!s.checked;if(Array.isArray(e)){var i=t._i(e,null);s.checked?i<0&&t.$set(t.data.meta,"is_dev",e.concat([null])):i>-1&&t.$set(t.data.meta,"is_dev",e.slice(0,i).concat(e.slice(i+1)))}else t.$set(t.data.meta,"is_dev",n)}}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v('\n           Start the "R&D mode" and turn on some performance-consuming detection algorithms\n          ')])]),t._v(" "),e("br"),t._v(" "),void 0!=t.data.meta.log_event?e("label",{staticClass:"custom-switch"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.data.meta.log_event,expression:"data.meta.log_event"}],staticClass:"custom-switch-input",attrs:{type:"checkbox",name:"custom-switch-checkbox"},domProps:{checked:Array.isArray(t.data.meta.log_event)?t._i(t.data.meta.log_event,null)>-1:t.data.meta.log_event},on:{change:function(a){var e=t.data.meta.log_event,s=a.target,n=!!s.checked;if(Array.isArray(e)){var i=t._i(e,null);s.checked?i<0&&t.$set(t.data.meta,"log_event",e.concat([null])):i>-1&&t.$set(t.data.meta,"log_event",e.slice(0,i).concat(e.slice(i+1)))}else t.$set(t.data.meta,"log_event",n)}}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v('\n            Print "behavior log" for debugging only, please do not open it online\n          ')])]):t._e()]):t._e(),t._v(" "),t._l(t.items,function(a){return e("div",{key:a.name,staticClass:"form-group"},[e("div",{staticClass:"form-label"},[t._v("\n          "+t._s(t.attack_type2name(a.name))+"\n        ")]),t._v(" "),t._l(a.items,function(a){return e("div",{key:a.key},[e("form",{attrs:{disabled:"true"}},[e("div",{staticClass:"selectgroup"},[e("label",{staticClass:"selectgroup-item"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.data[a.key].action,expression:"data[item.key].action"}],staticClass:"selectgroup-input",attrs:{type:"radio",name:"value",value:"block"},domProps:{checked:t._q(t.data[a.key].action,"block")},on:{change:function(e){return t.$set(t.data[a.key],"action","block")}}}),t._v(" "),e("span",{staticClass:"selectgroup-button"},[t._v("\n                  Intercept attack\n                ")])]),t._v(" "),e("label",{staticClass:"selectgroup-item"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.data[a.key].action,expression:"data[item.key].action"}],staticClass:"selectgroup-input",attrs:{type:"radio",name:"value",value:"log"},domProps:{checked:t._q(t.data[a.key].action,"log")},on:{change:function(e){return t.$set(t.data[a.key],"action","log")}}}),t._v(" "),e("span",{staticClass:"selectgroup-button"},[t._v("\n                  Log\n                ")])]),t._v(" "),e("label",{staticClass:"selectgroup-item"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.data[a.key].action,expression:"data[item.key].action"}],staticClass:"selectgroup-input",attrs:{type:"radio",name:"value",value:"ignore"},domProps:{checked:t._q(t.data[a.key].action,"ignore")},on:{change:function(e){return t.$set(t.data[a.key],"action","ignore")}}}),t._v(" "),e("span",{staticClass:"selectgroup-button"},[t._v("\n                  Completely ignore\n                ")])])]),t._v(" "),e("p",{staticStyle:{display:"inline","margin-left":"10px"}},[t._v("\n              "+t._s(a.name)+"\n              "),t.data[a.key].reference?e("a",{attrs:{target:"_blank",href:t.data[a.key].reference}},[t._v("\n                [Help Document]\n              ")]):t._e(),t._v(" "),t.hasAdvancedConfig[a.key]?e("a",{staticStyle:{color:"#B22222"},attrs:{href:"javascript:"},on:{click:function(e){return t.showAdvancedConfig(a.key,t.data[a.key])}}},[t._v("\n                [advanced options]\n              ")]):t._e()])])])})],2)})],2):e("div",{staticClass:"card-body"},[e("p",[t._v('\n        You have not selected a plug-in, please set it in "plug-in management"\n      ')])]),t._v(" "),t.current_app.selected_plugin_id&&t.current_app.selected_plugin_id.length?e("div",{class:{"card-footer":!0,"sticky-card-footer":t.sticky}},[e("button",{staticClass:"btn btn-primary",attrs:{type:"submit",disabled:t.byhost_regex_error},on:{click:function(a){return t.saveConfig()}}},[t._v("\n        Save\n      ")]),t._v(" "),e("button",{staticClass:"btn btn-info pull-right",attrs:{type:"submit"},on:{click:function(a){return t.resetConfig()}}},[t._v("\n        Reset\n      ")])]):t._e()]),t._v(" "),e("AlgorithmConfigModal",{ref:"algorithmConfigModal",on:{save:t.applyAdvancedConfig}})],1)},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("label",{attrs:{for:""}},[this._v("Use HOST to directly access services (regular）"),a("a",{attrs:{target:"_blank",href:"https://rasp.baidu.com/doc/install/iast.html#faq-no-task"}},[this._v("[Help Document]")])])}]},Ft=e("VU/8")(Ot,It,!1,null,null,null).exports,Ht={name:"HardeningSettings",data:function(){return{data:{"inject.custom_headers":{}},browser_headers:m}},computed:E()({},Object(c.c)(["current_app"])),methods:{setData:function(t){t["inject.custom_headers"]=t["inject.custom_headers"]||{},this.browser_headers.forEach(function(a){a.options.some(function(e){return e.value===t["inject.custom_headers"][a.name]})||a.options.push({name:t["inject.custom_headers"][a.name],value:t["inject.custom_headers"][a.name]})}),this.data=t},saveData:function(){var t=ft()(this.data);return"string"==typeof t["inject.custom_headers"]["X-Protected-By"]&&(t["inject.custom_headers"]["X-Protected-By"]=t["inject.custom_headers"]["X-Protected-By"].trim(),0==t["inject.custom_headers"]["X-Protected-By"].length&&(t["inject.custom_headers"]["X-Protected-By"]=void 0)),this.request.post("v1/api/app/general/config",{app_id:this.current_app.id,config:this.data}).then(function(){alert("Save successfully")})}}},zt={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("b-card",[e("div",{attrs:{slot:"header"},slot:"header"},[e("h3",{staticClass:"card-title"},[t._v("\n        应用加固\n      ")])]),t._v(" "),t._l(t.browser_headers,function(a){return e("div",{key:a.name,staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n        "+t._s(a.descr)+"\n        "),e("a",{attrs:{href:"https://rasp.baidu.com/doc/usage/hardening.html#"+a.name,target:"_blank"}},[t._v("\n          [帮助文档]\n        ")])]),t._v(" "),e("div",{staticClass:"selectgroup"},t._l(a.options,function(s){return e("label",{key:s.name,staticClass:"selectgroup-item"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.data["inject.custom_headers"][a.name],expression:"data['inject.custom_headers'][row.name]"}],staticClass:"selectgroup-input",attrs:{type:"radio",name:a.name},domProps:{value:s.value,checked:t._q(t.data["inject.custom_headers"][a.name],s.value)},on:{change:function(e){return t.$set(t.data["inject.custom_headers"],a.name,s.value)}}}),t._v(" "),e("span",{staticClass:"selectgroup-button"},[t._v("\n            "+t._s(s.name)+"\n          ")])])}),0)])}),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("Custom X-Protected-By header (Requires Agent version >= 1.2.2, leave it blank to not display)\n        "),e("a",{attrs:{href:"https://rasp.baidu.com/doc/usage/hardening.html#X-Protected-By",target:"_blank"}},[t._v("\n          [Help Document]\n        ")])]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.data["inject.custom_headers"]["X-Protected-By"],expression:"data['inject.custom_headers']['X-Protected-By']"}],staticClass:"form-control",attrs:{type:"text",maxlength:"200"},domProps:{value:t.data["inject.custom_headers"]["X-Protected-By"]},on:{input:function(a){a.target.composing||t.$set(t.data["inject.custom_headers"],"X-Protected-By",a.target.value)}}})]),t._v(" "),e("div",{attrs:{slot:"footer"},slot:"footer"},[e("b-button",{attrs:{variant:"primary"},on:{click:t.saveData}},[t._v("\n        Save\n      ")])],1)],2)],1)},staticRenderFns:[]},Vt=e("VU/8")(Ht,zt,!1,null,null,null).exports,Yt={name:"PanelSettings",data:function(){return{data:{panel_url:"",agent_url:[],agent_urls_text:""}}},computed:E()({},Object(c.c)(["current_app"])),mounted:function(){this.loadData()},methods:{loadData:function(t){var a=this;this.request.post("v1/api/server/url/get",{}).then(function(t){a.data=t,a.data.agent_urls_text=t.agent_urls.join("\n")})},parseAgentURL:function(){var t=[];return this.data.agent_urls_text.split("\n").forEach(function(a){(a=a.trim()).length&&t.push(a)}),t},saveData:function(){var t={panel_url:this.data.panel_url,agent_urls:this.parseAgentURL()};return this.request.post("v1/api/server/url",t).then(function(){alert("Successfully saved")})},removeLogs:function(){if(confirm("Empty log cannot be recovered, please confirm")){var t={app_id:this.current_app.id};return this.request.post("v1/api/server/clear_logs",t).then(function(){alert("operation successful")})}}}},Bt={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("b-card",[e("div",{attrs:{slot:"header"},slot:"header"},[e("h3",{staticClass:"card-title"},[t._v("\n       Background settings\n      ")])]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n        Manage background address [used to generate alarm link in email]\n      ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.data.panel_url,expression:"data.panel_url"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.data.panel_url},on:{input:function(a){a.target.composing||t.$set(t.data,"panel_url",a.target.value)}}})]),t._v(" "),e("div",{staticClass:"form-group"},[e("label",{staticClass:"form-label"},[t._v("\n       If you enable "),e("a",{attrs:{href:"https://rasp.baidu.com/doc/install/panel.html#load-balance",target:"_blank"}},[t._v("load balancing")]),t._v(', please fill in the Agent server list [for Generate the installation commands in "Add Host", one per line]')]),t._v(" "),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.data.agent_urls_text,expression:"data.agent_urls_text"}],staticClass:"form-control",attrs:{type:"text",rows:"5"},domProps:{value:t.data.agent_urls_text},on:{input:function(a){a.target.composing||t.$set(t.data,"agent_urls_text",a.target.value)}}})]),t._v(" "),e("div",{attrs:{slot:"footer"},slot:"footer"},[e("b-button",{attrs:{variant:"primary"},on:{click:t.saveData}},[t._v("\n        Save\n      ")])],1)]),t._v(" "),e("b-card",[e("div",{attrs:{slot:"header"},slot:"header"},[e("h3",{staticClass:"card-title"},[t._v("\n       Clear data\n      ")])]),t._v(" "),e("p",[t._v("After clicking execute, the following content will be cleared ("),e("strong",[t._v("Current application only")]),t._v("）")]),t._v(" "),e("ul",t._l(["attack event","baseline alarm","abnormal log","number of requests","crash information"],function(a){return e("li",[t._v(t._s(a))])}),0),t._v(" "),e("div",{attrs:{slot:"footer"},slot:"footer"},[e("b-button",{attrs:{variant:"danger"},on:{click:t.removeLogs}},[t._v("\n       carried out\n      ")])],1)])],1)},staticRenderFns:[]},Wt=e("VU/8")(Yt,Bt,!1,null,null,null).exports,Xt=e("nYKV"),Jt=e.n(Xt),Qt={name:"Settings",components:{AlarmSettings:yt,WhitelistSettings:Ut,AppSettings:Pt,AuthSettings:St,AlgorithmSettings:Ft,GeneralSettings:jt,HardeningSettings:Vt,PanelSettings:Wt},data:function(){return{tab_names:["general","alarm","whitelist","algorithm","hardening","auth","app","panel"],tab_index:0,data:void 0,loading:!1}},computed:E()({},Object(c.c)(["current_app"]),{setting_tab:function(){return this.$route.params.setting_tab}}),watch:{current_app:function(){this.loadSettings()},setting_tab:"setTabIndex"},mounted:function(){this.setTabIndex(this.setting_tab),this.current_app.id&&this.loadSettings()},methods:{loadSettings:function(){var t=this;this.loading=!0,this.request.post("v1/api/app/get",{app_id:this.current_app.id}).then(function(a){t.loading=!1,t.data=Jt()({general_config:{"inject.custom_headers":{}},whitelist_config:[],email_alarm_conf:{recv_addr:[]},ding_alarm_conf:{recv_user:[],recv_party:[]},http_alarm_conf:{recv_addr:[]},kafka_alarm_conf:{},general_alarm_conf:{}},a),t.$refs.generalSettings.setData(t.data.general_config),t.$refs.hardeningSettings.setData(t.data.general_config),t.$refs.whitelistSettings.setData(t.data.whitelist_config)})},setTabIndex:function(t){this.tab_index=this.tab_names.indexOf(t)||0},onTabIndex:function(t){this.$router.push({params:{setting_tab:this.tab_names[t]}})}}},Kt={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"my-3 my-md-5"},[e("div",{staticClass:"container"},[e("b-tabs",{staticClass:"w-100",attrs:{vertical:"","nav-wrapper-class":"col-3","no-fade":"","nav-class":"list-group list-group-transparent mx-0"},on:{input:t.onTabIndex},model:{value:t.tab_index,callback:function(a){t.tab_index=a},expression:"tab_index"}},[e("b-tab",{attrs:{"title-link-class":"list-group-item border-0 w-100","title-item-class":"px-0"}},[e("template",{slot:"title"},[e("span",{staticClass:"icon mr-3"},[e("i",{staticClass:"fe fe-settings"})]),t._v("\n          General settings\n        ")]),t._v(" "),e("GeneralSettings",{ref:"generalSettings"})],2),t._v(" "),e("b-tab",{attrs:{"title-link-class":"list-group-item border-0 w-100","title-item-class":"px-0"}},[e("template",{slot:"title"},[e("span",{staticClass:"icon mr-3"},[e("i",{staticClass:"fe fe-alert-triangle"})]),t._v("\n         Alarm system\n        ")]),t._v(" "),e("AlarmSettings",{ref:"alarmSettings",attrs:{data:t.data}})],2),t._v(" "),e("b-tab",{attrs:{"title-link-class":"list-group-item border-0 w-100","title-item-class":"px-0"}},[e("template",{slot:"title"},[e("span",{staticClass:"icon mr-3"},[e("i",{staticClass:"fe fe-list"})]),t._v("\n          Black and white list\n        ")]),t._v(" "),e("WhitelistSettings",{ref:"whitelistSettings"})],2),t._v(" "),e("b-tab",{attrs:{"title-link-class":"list-group-item border-0 w-100","title-item-class":"px-0"}},[e("template",{slot:"title"},[e("span",{staticClass:"icon mr-3"},[e("i",{staticClass:"fe fe-filter"})]),t._v("\n          Protection settings\n        ")]),t._v(" "),e("AlgorithmSettings",{ref:"algorithmSettings"})],2),t._v(" "),e("b-tab",{attrs:{"title-link-class":"list-group-item border-0 w-100","title-item-class":"px-0"}},[e("template",{slot:"title"},[e("span",{staticClass:"icon mr-3"},[e("i",{staticClass:"fe fe-shield"})]),t._v("\n          Application reinforcement\n        ")]),t._v(" "),e("HardeningSettings",{ref:"hardeningSettings"})],2),t._v(" "),e("b-tab",{attrs:{"title-link-class":"list-group-item border-0 w-100","title-item-class":"px-0"}},[e("template",{slot:"title"},[e("span",{staticClass:"icon mr-3"},[e("i",{staticClass:"fe fe-user"})]),t._v("\n          Login authentication\n        ")]),t._v(" "),e("AuthSettings",{ref:"authSettings"})],2),t._v(" "),e("b-tab",{attrs:{"title-link-class":"list-group-item border-0 w-100","title-item-class":"px-0"}},[e("template",{slot:"title"},[e("span",{staticClass:"icon mr-3"},[e("i",{staticClass:"fe fe-server"})]),t._v("\n          Application management\n        ")]),t._v(" "),e("AppSettings",{ref:"appSettings"})],2),t._v(" "),e("b-tab",{attrs:{"title-link-class":"list-group-item border-0 w-100","title-item-class":"px-0"}},[e("template",{slot:"title"},[e("span",{staticClass:"icon mr-3"},[e("i",{staticClass:"fe fe-settings"})]),t._v("\n          Background settings\n        ")]),t._v(" "),e("PanelSettings",{ref:"panelSettings"})],2)],1)],1)])},staticRenderFns:[]},Gt=e("VU/8")(Qt,Kt,!1,null,null,null).exports,Zt={name:"FileUpload",data:function(){return{file:void 0}},mounted:function(){},methods:{clear:function(){this.$refs.fileInput.value="",this.file=void 0},handleFileChange:function(t,a){this.file=a[0],this.$emit("input",a[0])}},components:{}},ta={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"custom-file"},[e("input",{ref:"fileInput",staticClass:"custom-file-input",attrs:{type:"file"},on:{change:function(a){return t.handleFileChange(a.target.name,a.target.files)}}}),t._v(" "),t.file?e("label",{staticClass:"custom-file-label"},[t._v(t._s(t.file.name))]):t._e(),t._v(" "),t.file?t._e():e("label",{staticClass:"custom-file-label"},[t._v("Select plugin")])])},staticRenderFns:[]},aa=e("VU/8")(Zt,ta,!1,null,null,null).exports,ea={name:"Plugins",data:function(){return{currentPage:1,total:1,data:[],loading:!1}},computed:E()({},Object(c.c)(["current_app"])),watch:{current_app:function(){this.loadPluginList(1)}},mounted:function(){this.current_app.id&&this.loadPluginList(1)},methods:E()({},Object(c.b)(["loadAppList"]),{ceil:Math.ceil,loadPluginList:function(t){var a=this;return this.loading=!0,this.request.post("v1/api/app/plugin/get",{page:t,perpage:10,app_id:this.current_app.id}).then(function(e){a.currentPage=t,a.data=e.data,a.total=e.total,a.loading=!1})},doUpload:function(){var t=this,a=this.$refs.fileUpload.file;if(a){var e=new FormData;e.append("plugin",a),this.request.post("v1/api/plugin?app_id="+this.current_app.id,e).then(function(){t.loadPluginList(1),t.$refs.fileUpload.clear()})}},doDelete:function(t){var a=this,e={id:t.id};confirm("confirm deletion?")&&this.request.post("v1/api/plugin/delete",e).then(function(){return a.loadPluginList(1)})},doSelect:function(t){var a=this;if(confirm("Confirm to send? Takes effect after one heartbeat cycle")){var e={app_id:this.current_app.id,plugin_id:t.id};this.request.post("v1/api/app/plugin/select",e).then(function(){return a.loadAppList(a.current_app.id)})}}}),components:{FileUpload:aa}},sa={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"my-3 my-md-5"},[e("div",{staticClass:"container"},[e("div",{staticClass:"page-header"},[e("h1",{staticClass:"page-title"},[t._v("\n        Plugin management\n      ")]),t._v(" "),e("div",{staticClass:"page-options d-flex"},[e("FileUpload",{ref:"fileUpload"})],1),t._v(" "),e("button",{staticClass:"btn btn-primary ml-2",on:{click:function(a){return t.doUpload()}}},[t._v("\n        submit\n      ")]),t._v(" "),e("button",{staticClass:"btn btn-info ml-2",on:{click:function(a){return t.loadPluginList(1)}}},[t._v("\n        Refresh\n      ")])]),t._v(" "),e("div",{staticClass:"card"},[e("div",{staticClass:"card-body"},[t.loading?e("vue-loading",{attrs:{type:"spiningDubbles",color:"rgb(90, 193, 221)",size:{width:"50px",height:"50px"}}}):t._e(),t._v(" "),!t.loading&&t.total>0?e("nav",[e("ul",{staticClass:"pagination pull-left"},[e("li",{staticClass:"active"},[e("span",{staticStyle:{"margin-top":"0.5em",display:"block"}},[e("strong",[t._v(t._s(t.total))]),t._v(" The results show that"+t._s(t.currentPage)+" / "+t._s(t.ceil(t.total/10))+"page\n              ")])])]),t._v(" "),e("b-pagination",{attrs:{align:"right","total-rows":t.total,"per-page":10},on:{change:t.loadPluginList},model:{value:t.currentPage,callback:function(a){t.currentPage=a},expression:"currentPage"}})],1):t._e(),t._v(" "),t.loading?t._e():e("table",{staticClass:"table table-bordered"},[t._m(0),t._v(" "),e("tbody",t._l(t.data,function(a){return e("tr",{key:a.id},[e("td",[t._v(t._s(t.moment(a.upload_time).format("YYYY-MM-DD HH:mm:ss")))]),t._v(" "),e("td",[t._v(t._s(a.name)+": "+t._s(a.version)+" \n                "),"official"==a.name?e("span",[t._v("(Protection plug-in)")]):"iast"==a.name?e("span",[t._v("(Scan plugin)")]):t._e()]),t._v(" "),e("td",[t.current_app.selected_plugin_id==a.id?e("span",[t._v("\n                  Yes\n                ")]):t._e()]),t._v(" "),e("td",[e("a",{attrs:{href:"javascript:"},on:{click:function(e){return t.doSelect(a)}}},[t._v("\n                 Push\n                ")]),t._v("  \n                "),e("a",{attrs:{href:"/v1/api/plugin/download?id="+a.id,target:"_blank"}},[t._v("\n                  download\n                ")]),t._v("  \n                "),e("a",{attrs:{href:"javascript:"},on:{click:function(e){return t.doDelete(a)}}},[t._v("\n                 delete\n                ")]),t._v("  \n                "),t.current_app.selected_plugin_id==a.id?e("router-link",{attrs:{to:{name:"settings",params:{setting_tab:"algorithm"}}}},[t._v("Configuration")]):t._e()],1)])}),0)]),t._v(" "),t.loading||0!=t.total?t._e():e("p",{staticClass:"text-center"},[t._v("No data")]),t._v(" "),!t.loading&&t.total>10?e("nav",[e("ul",{staticClass:"pagination pull-left"},[e("li",{staticClass:"active"},[e("span",{staticStyle:{"margin-top":"0.5em",display:"block"}},[e("strong",[t._v(t._s(t.total))]),t._v("The results show that "+t._s(t.currentPage)+" / "+t._s(t.ceil(t.total/10))+" 页\n              ")])])]),t._v(" "),e("b-pagination",{attrs:{align:"right","total-rows":t.total,"per-page":10},on:{change:t.loadPluginList},model:{value:t.currentPage,callback:function(a){t.currentPage=a},expression:"currentPage"}})],1):t._e()],1)])])])},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("thead",[a("tr",[a("th",[this._v("Upload time")]),this._v(" "),a("th",[this._v("Plugin version")]),this._v(" "),a("th",[this._v("current version")]),this._v(" "),a("th",[this._v("operating")])])])}]},na=e("VU/8")(ea,sa,!1,null,null,null).exports,ia={name:"Audit",data:function(){return{audit_types:v,data:[],loading:!1,currentPage:1,ip:"",total:0}},computed:E()({},Object(c.c)(["current_app"])),watch:{current_app:function(){this.loadAudit(1)}},mounted:function(){this.current_app.id&&this.loadAudit(1)},methods:{ceil:Math.ceil,loadAudit:function(t){var a=this;return this.loading=!0,this.request.post("v1/api/operation/search",{page:t,perpage:10,start_time:this.$refs.datePicker.start.valueOf(),end_time:this.$refs.datePicker.end.valueOf(),data:{app_id:this.current_app.id,ip:this.ip}}).then(function(e){a.currentPage=t,a.data=e.data,a.total=e.total,a.loading=!1})}},components:{DatePicker:tt}},ra={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"my-3 my-md-5"},[e("div",{staticClass:"container"},[e("div",{staticClass:"page-header"},[e("h1",{staticClass:"page-title"},[t._v("\n          Operation audit\n        ")]),t._v(" "),e("div",{staticClass:"page-options d-flex"},[e("div",{staticClass:"input-icon ml-2"},[t._m(0),t._v(" "),e("DatePicker",{ref:"datePicker",on:{selected:function(a){return t.loadAudit(1)}}})],1),t._v(" "),e("div",{staticClass:"input-icon ml-2"},[t._m(1),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.ip,expression:"ip",modifiers:{trim:!0}}],staticClass:"form-control w-10",attrs:{type:"text",placeholder:"Search IP"},domProps:{value:t.ip},on:{keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.loadAudit(1)},input:function(a){a.target.composing||(t.ip=a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("button",{staticClass:"btn btn-primary ml-2",on:{click:function(a){return t.loadAudit(1)}}},[t._v("\n            search for\n          ")])])]),t._v(" "),e("div",{staticClass:"card"},[e("div",{staticClass:"card-body"},[t.loading?e("vue-loading",{attrs:{type:"spiningDubbles",color:"rgb(90, 193, 221)",size:{width:"50px",height:"50px"}}}):t._e(),t._v(" "),!t.loading&&t.total>0?e("nav",[e("ul",{staticClass:"pagination pull-left"},[e("li",{staticClass:"active"},[e("span",{staticStyle:{"margin-top":"0.5em",display:"block"}},[e("strong",[t._v(t._s(t.total))]),t._v("The results show that"+t._s(t.currentPage)+" / "+t._s(t.ceil(t.total/10))+"page\n                ")])])]),t._v(" "),e("b-pagination",{attrs:{align:"right","total-rows":t.total,"per-page":10},on:{change:function(a){return t.loadAudit(a)}},model:{value:t.currentPage,callback:function(a){t.currentPage=a},expression:"currentPage"}})],1):t._e(),t._v(" "),t.loading?t._e():e("table",{staticClass:"table table-bordered"},[t._m(2),t._v(" "),e("tbody",t._l(t.data,function(a){return e("tr",{key:a.id},[e("td",{attrs:{nowrap:""}},[t._v("\n                  "+t._s(t.moment(a.time).format("YYYY-MM-DD HH:mm:ss"))+"\n                ")]),t._v(" "),e("td",{attrs:{nowrap:""}},[t._v("\n                "+t._s(t.audit_types[a.type_id])+"\n                ")]),t._v(" "),e("td",[t._v(t._s(a.content))]),t._v(" "),e("td",{attrs:{nowrap:""}},[t._v("\n                  "+t._s(a.user.length?a.user:"-")+"\n                ")]),t._v(" "),e("td",{attrs:{nowrap:""}},[t._v("\n                  "+t._s(a.ip)+"\n                ")])])}),0)]),t._v(" "),t.loading||0!=t.total?t._e():e("p",{staticClass:"text-center"},[t._v("\n          No data\n          ")]),t._v(" "),!t.loading&&t.total>10?e("nav",[e("ul",{staticClass:"pagination pull-left"},[e("li",{staticClass:"active"},[e("span",{staticStyle:{"margin-top":"0.5em",display:"block"}},[e("strong",[t._v(t._s(t.total))]),t._v("The results show that "+t._s(t.currentPage)+" / "+t._s(t.ceil(t.total/10))+" page\n                ")])])]),t._v(" "),e("b-pagination",{attrs:{align:"right","total-rows":t.total,"per-page":10},on:{change:function(a){return t.loadAudit(a)}},model:{value:t.currentPage,callback:function(a){t.currentPage=a},expression:"currentPage"}})],1):t._e()],1)])])])},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("span",{staticClass:"input-icon-addon"},[a("i",{staticClass:"fe fe-calendar"})])},function(){var t=this.$createElement,a=this._self._c||t;return a("span",{staticClass:"input-icon-addon"},[a("i",{staticClass:"fe fe-search"})])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("thead",[e("tr",[e("th",[t._v("Operation time")]),t._v(" "),e("th",[t._v("Type of operation")]),t._v(" "),e("th",[t._v("Operation content")]),t._v(" "),e("th",[t._v("Operator")]),t._v(" "),e("th",[t._v("IP address")])])])}]},la=e("VU/8")(ia,ra,!1,null,null,null).exports,oa={name:"attack_params",data:function(){return{data:{message:"wtf",attack_params:{}}}},methods:{setData:function(t){this.data=t},onCopySucc:function(t){console.log("succ")},onCopyError:function(t){console.log("fail",t)}}},ca={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"event-detail"},["sql"==t.data.attack_type?e("div",[e("div",{staticClass:"h6"},[t._v("\n           Database type\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.attack_params.server)+"\n        ")]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n            执行的SQL语句\n            ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.attack_params.query.length>1e4?t.data.attack_params.query+" ...":t.data.attack_params.query)+"                \n        ")])]):t._e(),t._v(" "),"sql_exception"==t.data.attack_type?e("div",[e("div",{staticClass:"h6"},[t._v("\n           Database type\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.attack_params.server)+"\n        ")]),t._v(" "),t.data.attack_params.query?e("div",[e("div",{staticClass:"h6"},[t._v("\n               SQL statement executed\n\n                ")]),t._v(" "),e("p",[t._v("\n                "+t._s(t.data.attack_params.query.length>1e4?t.data.attack_params.query+" ...":t.data.attack_params.query)+"\n            ")])]):t._e()]):t._e(),t._v(" "),"directory"==t.data.attack_type?e("div",[e("div",{staticClass:"h6"},[t._v("\n            Read directory\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.attack_params.path)+"\n        ")]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n          Read directory-real path\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.attack_params.realpath)+"\n        ")])]):t._e(),t._v(" "),"readFile"==t.data.attack_type?e("div",[e("div",{staticClass:"h6"},[t._v("\n          File read\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.attack_params.path)+"\n        ")]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n            File read-real path\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.attack_params.realpath)+"\n        ")])]):t._e(),t._v(" "),"writeFile"==t.data.attack_type?e("div",[e("div",{staticClass:"h6"},[t._v("\n           File written\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.attack_params.path)+"\n        ")]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n          File written-real path\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.attack_params.realpath)+"\n        ")])]):t._e(),t._v(" "),"deleteFile"==t.data.attack_type?e("div",[e("div",{staticClass:"h6"},[t._v("\n          Deleted files\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.attack_params.path)+"\n        ")]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n         Deleted file-real path\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.attack_params.realpath)+"\n        ")])]):t._e(),t._v(" "),"include"==t.data.attack_type?e("div",[e("div",{staticClass:"h6"},[t._v("\n          Files to include\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.attack_params.url)+"\n        ")]),t._v(" "),t.data.attack_params.realpath?e("div",{staticClass:"h6"},[t._v("\n         File to include-real path\n        ")]):t._e(),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.attack_params.realpath)+"\n        ")])]):t._e(),t._v(" "),"webdav"==t.data.attack_type?e("div",[e("div",{staticClass:"h6"},[t._v("\n           Source File\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.attack_params.source)+"\n        ")]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n           Target file\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.attack_params.dest)+"\n        ")])]):t._e(),t._v(" "),"fileUpload"==t.data.attack_type?e("div",[t.data.attack_params.name?e("div",{staticClass:"h6"},[t._v("\n           Multipart parameter name\n        ")]):t._e(),t._v(" "),t.data.attack_params.name?e("p",[t._v("\n            "+t._s(t.data.attack_params.name)+"\n        ")]):t._e(),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n            Uploaded file name\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.attack_params.filename)+"\n        ")]),t._v(" "),t.data.attack_params.dest_path?[e("div",{staticClass:"h6"},[t._v("\n               File storage location\n            ")]),t._v(" "),e("p",[t._v(t._s(t.data.attack_params.dest_path))]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n             File storage location (real path)\n            ")]),t._v(" "),e("p",[t._v(t._s(t.data.attack_params.dest_realpath))])]:t._e(),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n            Uploaded file content-first 4KB\n        ")]),t._v(" "),e("pre",[t._v(t._s(t.data.attack_params.content))])],2):t._e(),t._v(" "),"rename"==t.data.attack_type?e("div",[e("div",{staticClass:"h6"},[t._v("\n           Source File\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.attack_params.source)+"\n        ")]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n            Target file\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.attack_params.dest)+"\n        ")])]):t._e(),t._v(" "),"command"==t.data.attack_type?e("div",[e("div",{staticClass:"h6"},[t._v("\n            Command to execute\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.attack_params.command)+"\n        ")])]):t._e(),t._v(" "),"xxe"==t.data.attack_type?e("div",[e("div",{staticClass:"h6"},[t._v("\n            External entity to load\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.attack_params.entity)+"\n        ")])]):t._e(),t._v(" "),"ognl"==t.data.attack_type?e("div",[e("div",{staticClass:"h6"},[t._v("\n            OGNL expression to be executed\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.attack_params.expression)+"\n        ")])]):t._e(),t._v(" "),"deserialization"==t.data.attack_type?e("div",[e("div",{staticClass:"h6"},[t._v("\n            Java class name to be generated\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.attack_params.clazz)+"\n        ")])]):t._e(),t._v(" "),"ssrf"==t.data.attack_type||"ssrfRedirect"==t.data.attack_type?e("div",[e("div",{staticClass:"h6"},[t._v("\n            URL to visit\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.attack_params.url)+"\n        ")]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n            Target IP\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.attack_params.ip.join(", "))+"\n        ")])]):t._e(),t._v(" "),"xss_echo"==t.data.attack_type||"xss_userinput"==t.data.attack_type?e("div",[t.data.attack_params.name?e("div",{staticClass:"h6"},[t._v("\n            XSS parameter name\n        ")]):t._e(),t._v(" "),t.data.attack_params.name?e("p",[t._v("\n            "+t._s(t.data.attack_params.name)+"\n        ")]):t._e(),t._v(" "),t.data.attack_params.value?e("div",{staticClass:"h6"},[t._v("\n            XSS exploit code\n        ")]):t._e(),t._v(" "),t.data.attack_params.value?e("p",[t._v("\n            "+t._s(t.data.attack_params.value.length>1e4?t.data.attack_params.value+" ...":t.data.attack_params.value)+"   \n        ")]):t._e()]):t._e(),t._v(" "),"response"==t.data.attack_type&&"response_dataLeak"==t.data.plugin_algorithm?e("div",[e("div",{staticClass:"h6"},[t._v("\n            Examples of leaked sensitive information\n        ")]),t._v(" "),e("div",[e("table",{staticClass:"table table-bordered"},[t._m(0),t._v(" "),e("tbody",t._l(t.data.attack_params.parts,function(a,s){return e("tr",{key:s},[e("td",{attrs:{nowrap:""}},[t._v(t._s(a.type))]),t._v(" "),e("td",{attrs:{nowrap:""}},[t._v(t._s(a.match))]),t._v(" "),e("td",[t._v(t._s(a.parts))])])}),0)])])]):t._e(),t._v(" "),"webshell_eval"==t.data.attack_type?e("div",[e("div",{staticClass:"h6"},[t._v("\n            The content of eval\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.attack_params.eval)+"\n        ")])]):t._e(),t._v(" "),"webshell_command"==t.data.attack_type?e("div",[e("div",{staticClass:"h6"},[t._v("\n            Command to be executed by WebShell\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.attack_params.command)+"\n        ")])]):t._e(),t._v(" "),"webshell_file_put_contents"==t.data.attack_type?e("div",[e("div",{staticClass:"h6"},[t._v("\n            File to be written by WebShell\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.attack_params.name)+"\n        ")]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n            File to be written by WebShell-real path\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.attack_params.realpath)+"\n        ")])]):t._e(),t._v(" "),"webshell_callable"==t.data.attack_type?e("div",[e("div",{staticClass:"h6"},[t._v("\n            The function to be executed by the backdoor\n        ")]),t._v(" "),e("p",[t._v("\n            "+t._s(t.data.attack_params.function)+"()\n        ")])]):t._e()])},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("thead",[a("tr",[a("th",[this._v("Type")]),this._v(" "),a("th",[this._v("Uncoded information")]),this._v(" "),a("th",[this._v("Original content (fragment)")])])])}]},da={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"event-detail"},["sql"==t.data.attack_type?e("div",[t._v("\n        SQL injection is mostly caused by statement splicing. Please check whether there is parameter splicing in the code. When conditions permit, try to use prepare query to fix vulnerabilities.\n    ")]):t._e(),t._v(" "),"sql_exception"==t.data.attack_type?e("div",[t._v("\n        Check whether the abnormal SQL statement comes from normal operation, if not, check whether the application has vulnerabilities.\n    ")]):t._e(),t._v(" "),"directory"==t.data.attack_type?e("div",[t._v("\n        Usually applications will not read sensitive directories, please confirm with the line of business whether this is a normal behavior. If not, please check the server based on the stack to see if there is a webshell backdoor.\n    ")]):t._e(),t._v(" "),"readFile"==t.data.attack_type?e("div",[t._v("\n        Usually the application will not read sensitive files, please confirm with the line of business whether this is a normal behavior. If not, please check the server based on the stack to see if there is a webshell backdoor.\n    ")]):t._e(),t._v(" "),"deleteFile"==t.data.attack_type?e("div",[t._v("\n        Filter or verify the incoming file path.\n    ")]):t._e(),t._v(" "),"writeFile"==t.data.attack_type?e("div",[t._v("\n        Filter the file names to be deleted, such as restricting directories, etc., to avoid damage to the system.\n    ")]):t._e(),t._v(" "),"include"==t.data.attack_type?e("div",[t._v("\n        Please check whether the file to be included is normal, otherwise it means that there is a file inclusion vulnerability on the server.\n    ")]):t._e(),t._v(" "),"webdav"==t.data.attack_type?e("div",[t._v("\n        Please check whether the MOVE/PUT operation is enabled on the server. Attackers can use a special HTTP method to upload the webshell backdoor. This algorithm has no false positives.\n    ")]):t._e(),t._v(" "),"fileUpload"==t.data.attack_type?e("div",[t._v("\n        When the server allows users to upload files without filtering extensions, it may cause arbitrary file upload vulnerabilities. The fix is ​​to use a whitelist of extensions, such as allowing only suffixes such as txt/png/jpg. This algorithm usually has no false positives.\n    ")]):t._e(),t._v(" "),"rename"==t.data.attack_type?e("div",[t._v("\n        When the server has vulnerabilities, the attacker can rename the unexecutable txt/rar file name to php/jsp/.. and other executable script files. This algorithm will falsely report under some PHP frameworks.\n    ")]):t._e(),t._v(" "),"command"==t.data.attack_type?e("div",[t._v("\n        If the execution of this command is not a normal business requirement, it is most likely an operation performed by the webshell backdoor, or a command executed by an attacker using a vulnerability.\n    ")]):t._e(),t._v(" "),"xxe"==t.data.attack_type?e("div",[t._v("\n        Check whether the business code directly processes the xml input by the user and allows any external entities to be loaded. If allowed, there may be an xxe vulnerability.\n        After v1.1, we will add the XXE code security switch, which will automatically prevent you from loading xml entities and automatically fix vulnerabilities.\n    ")]):t._e(),t._v(" "),"ognl"==t.data.attack_type?e("div",[t._v("\n        Try to upgrade struts to the new version, or promote business transformation, using other development frameworks. At Baidu, we have banned business lines from using the struts framework.\n    ")]):t._e(),t._v(" "),"deserialization"==t.data.attack_type?e("div",[t._v("\n        Check whether the system has known deserialization vulnerabilities, and upgrade the software or framework to the latest version.\n    ")]):t._e(),t._v(" "),"link"==t.data.attack_type?e("div",[t._v("\n        If this link operation is not a normal business requirement, it is most likely an operation performed by the webshell backdoor, for example, to bypass EDR detection.\n    ")]):t._e(),t._v(" "),"ssrf"==t.data.attack_type||"ssrfRedirect"==t.data.attack_type?e("div",[t._v("\n        Check the business code to see if it is possible to directly initiate a request to the intranet URL specified by the user.\n    ")]):t._e(),t._v(" "),"webshell_eval"==t.data.attack_type?e("div",[t._v("\n        Check whether there is a Chinese kitchen knife backdoor on the server. The backdoor may also exist in the business code. Please refer to the application stack for details.\n    ")]):t._e(),t._v(" "),"webshell_command"==t.data.attack_type?e("div",[t._v("\n        Check whether there is a webshell backdoor or a command execution point that can be exploited on the server. This algorithm has no false positives.\n    ")]):t._e(),t._v(" "),"webshell_file_put_contents"==t.data.attack_type?e("div",[t._v("\n        Check whether there is a webshell backdoor on the server, or a backdoor upload point that can be utilized, this algorithm has no false positives.\n    ")]):t._e(),t._v(" "),"webshell_callable"==t.data.attack_type?e("div",[t._v("\n        Check whether there is a webshell backdoor on the server, that is, use call_user_func/array_walk/.. to call system/exec/... and other functions. This algorithm has no false positives.\n    ")]):t._e(),t._v(" "),"webshell_ld_preload"==t.data.attack_type?e("div",[t._v("\n        Check whether there is a webshell backdoor on the server, that is, use putenv + LD_PRELOAD + mail to execute any command backdoor.\n    ")]):t._e(),t._v(" "),"xss_userinput"==t.data.attack_type||"xss_echo"==t.data.attack_type?e("div",[t._v("\n        Check whether the application directly outputs the parameters passed in by the user, consider using ESAPI to escape.\n    ")]):t._e(),t._v(" "),"eval"==t.data.attack_type?e("div",[t._v("\n        Avoid using eval/assert functions, or check whether the target file is a backdoor program.\n    ")]):t._e(),t._v(" "),"loadLibrary"==t.data.attack_type?e("div",[t._v("\n        Check whether the target file is a backdoor.\n    ")]):t._e(),t._v(" "),"response"==t.data.attack_type?e("div",[t._v("\n        Encode sensitive data in the response to avoid displaying plaintext data.        \n    ")]):t._e()])},staticRenderFns:[]},ua={name:"EventDetailModal",components:{attack_params:e("VU/8")(oa,ca,!1,null,null,null).exports,fix_solutions:e("VU/8")({name:"fix_solutions",data:function(){return{data:{attack_params:{}}}},methods:{setData:function(t){this.data=t}}},da,!1,null,null,null).exports},data:function(){return{tabIndex:0,tabs:["Vulnerability details","Request information","Asset information","Repair suggestions"],data:{url:"",stack_md5:"",attack_location:{},source_code:[],stack_trace:"",merged_code:[]}}},methods:{attack_type2name:C,showModal:function(t){this.tabIndex=0,this.data=t,!t.stack_trace&&t.attack_params.stack&&(t.stack_trace=t.attack_params.stack.join("\n")),this.$refs.attack_params.setData(t),this.$refs.fix_solutions.setData(t),this.mergeStackAndSource(t),$("#showEventDetailModal").modal()},decodeMultipartFile:function(t){var a=[];try{JSON.parse(t).forEach(function(t){a.push("name="+t.name+"; filename="+t.filename)})}catch(t){return"An exception occurs when parsing the Multipart File parameter, please join the QQ group to contact the owner:"+t}return a.join("\n")},decodeMultipartForm:function(t){var a=[],e=JSON.parse(t);try{Y()(e).forEach(function(t){var s=e[t];s.constructor==Array?s.forEach(function(e){a.push(t+"="+e)}):s.constructor==Object?Y()(s).forEach(function(e){a.push(t+"["+e+"]="+s[e])}):a.push(t+"="+s)})}catch(t){return"An exception occurs when parsing Multipart Form parameters, please join the QQ group to contact the owner:"+t}return a.join("&")},mergeHeaders:function(t){var a="";for(var e in t)a=a+"\n"+e+": "+t[e];return a.trim()},mergeStackAndSource:function(t){if(t.source_code&&t.source_code.length){var a=t.stack_trace.trim().split("\n");if(a.length==t.source_code.length){this.data.merged_code=[];for(var e=0;e<a.length;e++){var s=a[e],n=t.source_code[e].trim();this.data.merged_code.push({stack:s,code:n.length?n:"(空)"})}}else console.error("Error: stack_trace size '"+a.length+"' is different from source_code size '"+t.source_code.length+"', skipped")}}}},_a={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"modal no-fade",attrs:{id:"showEventDetailModal",tabindex:"-1",role:"dialog"}},[e("div",{staticClass:"modal-dialog modal-lg",attrs:{role:"document"}},[e("div",{staticClass:"modal-content"},[t._m(0),t._v(" "),e("div",{staticClass:"modal-body",staticStyle:{"padding-top":"0"}},[e("ul",{staticClass:"nav nav-tabs",attrs:{id:"myTab",role:"tablist"}},t._l(t.tabs,function(a,s){return e("li",{key:s,staticClass:"nav-item"},[e("a",{class:{"nav-link":!0,active:t.tabIndex==s},attrs:{href:"javascript:"},on:{click:function(a){t.tabIndex=s}}},[t._v("\n              "+t._s(a)+"\n            ")])])}),0),t._v(" "),e("br"),t._v(" "),e("div",{staticClass:"tab-content",attrs:{id:"myTabContent"}},[e("div",{class:{"tab-pane":!0,fade:!0,show:0==t.tabIndex,active:0==t.tabIndex},attrs:{id:"vuln"}},[e("div",{staticClass:"h6"},[t._v("\n             Alarm time\n            ")]),t._v(" "),e("p",[t._v(t._s(t.moment(t.data.event_time).format("YYYY-MM-DD HH:mm:ss")))]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n              Alarm message\n            ")]),t._v(" "),e("p",{staticStyle:{"word-break":"break-all"}},[t._v("\n              ["+t._s(t.attack_type2name(t.data.attack_type))+"] "+t._s(t.data.plugin_message)+"\n            ")]),t._v(" "),e("attack_params",{ref:"attack_params"}),t._v(" "),t.data.stack_md5?e("div",{staticClass:"h6"},[t._v("\n              Application stack MD5\n            ")]):t._e(),t._v(" "),t.data.stack_md5?e("p",[t._v(t._s(t.data.stack_md5))]):t._e(),t._v(" "),t.data.stack_trace?e("div",{staticClass:"h6"},[t._v("\n             Application stack\n            ")]):t._e(),t._v(" "),t.data.stack_trace?e("pre",[t._v(t._s(t.data.stack_trace))]):t._e(),t._v(" "),t.data.merged_code?e("div",[e("div",{staticClass:"h6"},[t._v("\n              Application source code\n              ")]),t._v(" "),e("pre",t._l(t.data.merged_code,function(a,s){return e("div",{key:s},[t._v(t._s(t.data.merged_code.length-s)+". "+t._s(a.stack)),e("br"),t._v(t._s(a.code)+"\n              ")])}),0)]):t._e()],1),t._v(" "),e("div",{class:{"tab-pane":!0,fade:!0,show:1==t.tabIndex,active:1==t.tabIndex},attrs:{id:"home"}},[e("div",{staticClass:"h6"},[t._v("\n              Request number\n            ")]),t._v(" "),e("p",[t._v("\n              "+t._s(t.data.request_id?t.data.request_id:"-")+"\n            ")]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n            Request URL\n            ")]),t._v(" "),e("p",{staticStyle:{"word-break":"break-all"}},[t._v("\n              "+t._s(t.data.request_method?t.data.request_method.toUpperCase():"")+" \n              "),e("a",{attrs:{target:"_blank",href:t.data.url}},[t._v("\n                "+t._s(t.data.url?t.data.url:"-")+"\n              ")])]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n              Request source\n            ")]),t._v(" "),e("p",[t._v("\n              "+t._s(t.data.attack_source?t.data.attack_source:"-")+"\n              "),t.data.attack_location&&"-"!=t.data.attack_location.location_en?e("span",[t._v("\n                "+t._s(t.data.attack_location.location_en)+"\n              ")]):t._e()]),t._v(" "),t.data.client_ip?e("div",{staticClass:"h6"},[t._v("\n              Client real IP\n            ")]):t._e(),t._v(" "),t.data.client_ip?e("p",[t._v("\n              "+t._s(t.data.client_ip)+"\n            ")]):t._e(),t._v(" "),t.data.header&&Object.keys(t.data.header).length?e("div",[t.data.header.referer?e("div",{staticClass:"h6"},[t._v("\n               Request Referer\n              ")]):t._e(),t._v(" "),t.data.header.referer?e("p",[e("a",{attrs:{target:"_blank",href:t.data.header.referer}},[t._v("\n                  "+t._s(t.data.header.referer)+"\n                ")])]):t._e(),t._v(" "),t.data.header.user_agent?e("div",{staticClass:"h6"},[t._v("\n                请求 UA\n              ")]):t._e(),t._v(" "),t.data.header.user_agent?e("p",{staticStyle:{"word-break":"break-all"}},[t._v("\n                "+t._s(t.data.header.user_agent)+"\n              ")]):t._e(),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n                Complete header information\n              ")]),t._v(" "),e("pre",[t._v(t._s(t.mergeHeaders(t.data.header)))]),t._v(" "),t.data.parameter&&"[]"!=t.data.parameter.multipart&&"{}"!=t.data.parameter.multipart?e("div",[e("div",{staticClass:"h6"},[t._v("\n                 Multipart file parameters\n                ")]),t._v(" "),e("pre",[t._v(t._s(t.decodeMultipartFile(t.data.parameter.multipart)))])]):t._e(),t._v(" "),t.data.parameter&&"{}"!=t.data.parameter.form?e("div",[e("div",{staticClass:"h6"},[t._v("\n                  Form parameters\n                ")]),t._v(" "),e("pre",[t._v(t._s(t.decodeMultipartForm(t.data.parameter.form)))])]):t._e(),t._v(" "),t.data.parameter&&"{}"!=t.data.parameter.json?e("div",[e("div",{staticClass:"h6"},[t._v("\n                 JSON parameters\n                ")]),t._v(" "),e("pre",[t._v(t._s(t.data.parameter.json))])]):t._e()]):e("div",[e("div",{staticClass:"h6"},[t._v("\n                Request Referer\n              ")]),t._v(" "),e("p",{staticStyle:{"white-space":"normal","word-break":"break-all"}},[t._v("\n                "+t._s(t.data.referer?t.data.referer:"-")+"\n              ")]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n               Request UA\n              ")]),t._v(" "),e("p",{staticStyle:{"word-break":"break-all"}},[t._v("\n                "+t._s(t.data.user_agent?t.data.user_agent:"-")+"\n              ")])]),t._v(" "),t.data.body?e("div",[e("div",{staticClass:"h6"},[t._v("\n                Request BODY\n              ")]),t._v(" "),e("pre",{staticStyle:{"word-break":"break-all"}},[t._v(t._s(t.data.body))])]):t._e()]),t._v(" "),e("div",{class:{"tab-pane":!0,fade:!0,show:2==t.tabIndex,active:2==t.tabIndex},attrs:{id:"profile"}},[e("div",{staticClass:"h6"},[t._v("\n            Host name\n            ")]),t._v(" "),e("p",[t._v("\n              "+t._s(t.data.server_hostname)+"\n            ")]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n             Server IP\n            ")]),t._v(" "),e("ul",t._l(t.data.server_nic,function(a){return e("li",{key:a.name},[t._v("\n                "+t._s(a.name)+": "+t._s(a.ip)+"\n              ")])}),0),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n           RASP version\n            ")]),t._v(" "),e("p",[t._v("\n              "+t._s(t.data.rasp_version)+"\n            ")]),t._v(" "),t.data.server_type?e("div",[e("div",{staticClass:"h6"},[t._v("\n              App version\n              ")]),t._v(" "),e("p",{staticStyle:{"word-break":"break-all"}},[t._v("\n                "+t._s(t.data.server_type)+"/"+t._s(t.data.server_version)+"\n              ")])]):t._e()]),t._v(" "),e("div",{class:{"tab-pane":!0,fade:!0,show:3==t.tabIndex,active:3==t.tabIndex},attrs:{id:"contact"}},[e("fix_solutions",{ref:"fix_solutions"})],1)])]),t._v(" "),t._m(1)])])])},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"modal-header"},[a("h5",{staticClass:"modal-title"},[this._v("\n        Alarm details\n        ")]),this._v(" "),a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}})])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"modal-footer"},[a("button",{staticClass:"btn btn-primary",attrs:{"data-dismiss":"modal"}},[this._v("\n          关闭\n        ")])])}]},pa=e("VU/8")(ua,_a,!1,null,null,null).exports,va={name:"Events",components:{EventDetailModal:pa,DatePicker:tt},data:function(){return{data:[],loading:!1,currentPage:1,srcip:"",url:"",request_id:"",stack_md5:"",plugin_message:"",total:0,attack_types:f,status_types:g,selected_status:Y()(g),selected:Y()(f)}},computed:E()({},Object(c.c)(["current_app"])),watch:{current_app:function(){this.loadEvents(1)},selected:function(){this.loadEvents(1)},selected_status:function(){this.loadEvents(1)}},mounted:function(){this.current_app.id&&this.loadEvents(1)},methods:{ceil:Math.ceil,displayURL:function(t){return t.url?t.url.length>100?t.url.substring(0,100)+" ...":t.url:"-"},selectAllStatus:function(t){var a=t.target;this.selected_status=a.checked?Y()(this.status_types):[]},selectAll:function(t){var a=t.target;this.selected=a.checked?Y()(this.attack_types):[]},attack_type2name:C,block_status2name:k,showEventDetail:function(t){this.$refs.showEventDetail.showModal(t)},loadEvents:function(t){var a=this;return this.loading=!0,this.request.post("v1/api/log/attack/search",{data:{start_time:this.$refs.datePicker.start.valueOf(),end_time:this.$refs.datePicker.end.valueOf(),attack_type:this.selected,attack_source:this.srcip,app_id:this.current_app.id,url:this.url,request_id:this.request_id,intercept_state:this.selected_status,plugin_message:this.plugin_message},page:t,perpage:10}).then(function(e){a.currentPage=t,a.data=e.data,a.total=e.total,a.loading=!1})}}},ma={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"my-3 my-md-5"},[e("div",{staticClass:"container"},[e("div",{staticClass:"page-header",staticStyle:{"flex-direction":"column",display:"flex"}},[e("div",{staticStyle:{display:"flex","flex-direction":"row","justify-content":"flex-start",width:"100%"}},[e("h1",{staticClass:"page-title"},[t._v("\n          Attack\n        ")]),t._v(" "),e("div",{staticClass:"page-options d-flex"},[e("b-dropdown",{staticClass:"ml-2",attrs:{text:"Intercept status",right:""}},[e("b-container",{staticStyle:{width:"250px"}},[e("b-form-row",[t._l(t.status_types,function(a,s){return[e("b-col",{key:s},[e("label",{staticClass:"custom-switch"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.selected_status,expression:"selected_status"}],staticClass:"custom-switch-input",attrs:{type:"checkbox"},domProps:{value:s,checked:Array.isArray(t.selected_status)?t._i(t.selected_status,s)>-1:t.selected_status},on:{change:function(a){var e=t.selected_status,n=a.target,i=!!n.checked;if(Array.isArray(e)){var r=s,l=t._i(e,r);n.checked?l<0&&(t.selected_status=e.concat([r])):l>-1&&(t.selected_status=e.slice(0,l).concat(e.slice(l+1)))}else t.selected_status=i}}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v("\n                        "+t._s(a)+"\n                      ")])])])]})],2)],1)],1),t._v(" "),e("b-dropdown",{staticClass:"ml-2",attrs:{text:"Type of Attack",right:""}},[e("b-container",{staticStyle:{width:"500px"}},[e("b-form-row",[e("b-col",[e("label",{staticClass:"custom-switch"},[e("input",{staticClass:"custom-switch-input",attrs:{type:"checkbox",checked:""},on:{change:t.selectAll}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v("\n                     select all\n                    ")])])]),t._v(" "),e("div",{staticClass:"w-100"}),t._v(" "),t._l(t.attack_types,function(a,s,n){return[e("b-col",{key:s},[e("label",{staticClass:"custom-switch"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.selected,expression:"selected"}],staticClass:"custom-switch-input",attrs:{type:"checkbox"},domProps:{value:s,checked:Array.isArray(t.selected)?t._i(t.selected,s)>-1:t.selected},on:{change:function(a){var e=t.selected,n=a.target,i=!!n.checked;if(Array.isArray(e)){var r=s,l=t._i(e,r);n.checked?l<0&&(t.selected=e.concat([r])):l>-1&&(t.selected=e.slice(0,l).concat(e.slice(l+1)))}else t.selected=i}}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v("\n                        "+t._s(a)+"\n                      ")])])]),t._v(" "),n%2==1?e("div",{staticClass:"w-100"}):t._e()]})],2)],1)],1),t._v(" "),e("div",{staticClass:"input-icon ml-2"},[t._m(0),t._v(" "),e("DatePicker",{ref:"datePicker",on:{selected:function(a){return t.loadEvents(1)}}})],1),t._v(" "),e("div",{staticClass:"input-icon ml-2"},[t._m(1),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.srcip,expression:"srcip",modifiers:{trim:!0}}],staticClass:"form-control w-10",staticStyle:{width:"210px"},attrs:{type:"text",placeholder:"Source of Attack"},domProps:{value:t.srcip},on:{keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.loadEvents(1)},input:function(a){a.target.composing||(t.srcip=a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})])],1)]),t._v(" "),e("div",{staticClass:"page-options d-flex",staticStyle:{"margin-top":"5px"}},[e("div",{staticClass:"input-icon ml-2"},[t._m(2),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.url,expression:"url",modifiers:{trim:!0}}],staticClass:"form-control w-10",staticStyle:{width:"210px"},attrs:{type:"text",placeholder:"Target URL"},domProps:{value:t.url},on:{keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.loadEvents(1)},input:function(a){a.target.composing||(t.url=a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"input-icon ml-2"},[t._m(3),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.plugin_message,expression:"plugin_message",modifiers:{trim:!0}}],staticClass:"form-control w-10",staticStyle:{width:"210px"},attrs:{type:"text",placeholder:"Alarm Message"},domProps:{value:t.plugin_message},on:{keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.loadEvents(1)},input:function(a){a.target.composing||(t.plugin_message=a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})])]),t._v(" "),e("div",{staticClass:"page-options d-flex",staticStyle:{"margin-top":"5px"}},[e("div",{staticClass:"input-icon ml-2"},[t._m(4),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.request_id,expression:"request_id",modifiers:{trim:!0}}],staticClass:"form-control w-10",staticStyle:{width:"210px"},attrs:{type:"text",placeholder:"Request ID"},domProps:{value:t.request_id},on:{keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.loadEvents(1)},input:function(a){a.target.composing||(t.request_id=a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticClass:"input-icon ml-2"},[t._m(5),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.stack_md5,expression:"stack_md5",modifiers:{trim:!0}}],staticClass:"form-control w-10",staticStyle:{width:"210px"},attrs:{type:"text",placeholder:"Stack MD5"},domProps:{value:t.stack_md5},on:{keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.loadEvents(1)},input:function(a){a.target.composing||(t.stack_md5=a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})])]),t._v(" "),e("div",{staticClass:"page-options d-flex",staticStyle:{"margin-top":"5px"}},[e("button",{staticClass:"btn btn-primary ml-2",staticStyle:{height:"38px"},on:{click:function(a){return t.loadEvents(1)}}},[t._v("\n          搜索\n        ")])])]),t._v(" "),e("div",{staticClass:"card"},[e("div",{staticClass:"card-body"},[t.loading?e("VueLoading",{attrs:{type:"spiningDubbles",color:"rgb(90, 193, 221)",size:{width:"50px",height:"50px"}}}):t._e(),t._v(" "),!t.loading&&t.total>0?e("nav",[e("ul",{staticClass:"pagination pull-left"},[e("li",{staticClass:"active"},[e("span",{staticStyle:{"margin-top":"0.5em",display:"block"}},[e("strong",[t._v(t._s(t.total))]),t._v("The results show that"+t._s(t.currentPage)+" / "+t._s(t.ceil(t.total/10))+" 页\n              ")])])]),t._v(" "),e("b-pagination",{attrs:{align:"right","total-rows":t.total,"per-page":10},on:{change:function(a){return t.loadEvents(a)}},model:{value:t.currentPage,callback:function(a){t.currentPage=a},expression:"currentPage"}})],1):t._e(),t._v(" "),t.loading?t._e():e("table",{staticClass:"table table-striped table-bordered"},[t._m(6),t._v(" "),e("tbody",t._l(t.data,function(a){return e("tr",{key:a.id},[e("td",{attrs:{nowrap:""}},[t._v("\n                "+t._s(t.moment(a.event_time).format("YYYY-MM-DD"))+"\n                "),e("br"),t._v("\n                "+t._s(t.moment(a.event_time).format("HH:mm:ss"))+"\n              ")]),t._v(" "),e("td",{staticStyle:{"max-width":"500px","word-break":"break-word"}},[e("a",{attrs:{href:a.url,target:"_blank"}},[t._v("\n                  "+t._s(t.displayURL(a))+"\n                ")])]),t._v(" "),e("td",[e("a",{attrs:{target:"_blank",href:"https://www.virustotal.com/#/ip-address/"+(a.client_ip?a.client_ip:a.attack_source)}},[t._v("\n                  "+t._s(a.client_ip?a.client_ip:a.attack_source?a.attack_source:"-")+"\n                ")])]),t._v(" "),e("td",{attrs:{nowrap:""}},[t._v("\n                "+t._s(t.block_status2name(a.intercept_state))+"\n              ")]),t._v(" "),e("td",{attrs:{nowrap:""}},[e("span",{staticClass:"tag tag-danger"},[t._v("\n                  "+t._s(t.attack_type2name(a.attack_type))+"\n                ")])]),t._v(" "),e("td",[t._v("\n                "+t._s(a.plugin_message)+"\n              ")]),t._v(" "),e("td",{attrs:{nowrap:""}},[e("a",{attrs:{href:"javascript:"},on:{click:function(e){return t.showEventDetail(a)}}},[t._v("\n                see details\n                ")])])])}),0)]),t._v(" "),t.loading||0!=t.total?t._e():e("p",{staticClass:"text-center"},[t._v("No data yet")]),t._v(" "),!t.loading&&t.total>10?e("nav",[e("ul",{staticClass:"pagination pull-left"},[e("li",{staticClass:"active"},[e("span",{staticStyle:{"margin-top":"0.5em",display:"block"}},[e("strong",[t._v(t._s(t.total))]),t._v("The results show that "+t._s(t.currentPage)+" / "+t._s(t.ceil(t.total/10))+" 页\n              ")])])]),t._v(" "),e("b-pagination",{attrs:{align:"right","total-rows":t.total,"per-page":10},on:{change:function(a){return t.loadEvents(a)}},model:{value:t.currentPage,callback:function(a){t.currentPage=a},expression:"currentPage"}})],1):t._e()],1)])]),t._v(" "),e("EventDetailModal",{ref:"showEventDetail"})],1)},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("span",{staticClass:"input-icon-addon"},[a("i",{staticClass:"fe fe-calendar"})])},function(){var t=this.$createElement,a=this._self._c||t;return a("span",{staticClass:"input-icon-addon"},[a("i",{staticClass:"fe fe-search"})])},function(){var t=this.$createElement,a=this._self._c||t;return a("span",{staticClass:"input-icon-addon"},[a("i",{staticClass:"fe fe-search"})])},function(){var t=this.$createElement,a=this._self._c||t;return a("span",{staticClass:"input-icon-addon"},[a("i",{staticClass:"fe fe-search"})])},function(){var t=this.$createElement,a=this._self._c||t;return a("span",{staticClass:"input-icon-addon"},[a("i",{staticClass:"fe fe-search"})])},function(){var t=this.$createElement,a=this._self._c||t;return a("span",{staticClass:"input-icon-addon"},[a("i",{staticClass:"fe fe-search"})])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("thead",[e("tr",[e("th",[t._v("\n               Attack time\n              ")]),t._v(" "),e("th",{staticStyle:{"min-width":"150px"}},[t._v("\n                URL\n              ")]),t._v(" "),e("th",[t._v("\n                Source of attack\n              ")]),t._v(" "),e("th",[t._v("\n               Blocking state\n              ")]),t._v(" "),e("th",{attrs:{nowrap:""}},[t._v("\n               Attack type\n              ")]),t._v(" "),e("th",[t._v("\n               Alarm message\n              ")]),t._v(" "),e("th",[t._v("\n               operating\n              ")])])])}]},ha=e("VU/8")(va,ma,!1,null,null,null).exports,fa={name:"vulns",components:{EventDetailModal:pa,DatePicker:tt},data:function(){return{data:[],loading:!1,currentPage:1,url:"",total:0,attack_types:f,status_types:g,selected_status:Y()(g),selected:Y()(f)}},computed:E()({},Object(c.c)(["current_app"])),watch:{current_app:function(){this.loadEvents(1)},selected:function(){this.loadEvents(1)},selected_status:function(){this.loadEvents(1)}},mounted:function(){this.current_app.id&&this.loadEvents(1)},methods:{ceil:Math.ceil,displayURL:function(t){return t.url?t.url.length>100?t.url.substring(0,100)+" ...":t.url:"-"},selectAllStatus:function(t){var a=t.target;this.selected_status=a.checked?Y()(this.status_types):[]},selectAll:function(t){var a=t.target;this.selected=a.checked?Y()(this.attack_types):[]},attack_type2name:C,block_status2name:k,showEventDetail:function(t){this.$refs.showEventDetail.showModal(t)},loadEvents:function(t){var a=this;return this.loading=!0,this.request.post("v1/api/log/attack/aggr/vuln",{data:{start_time:this.$refs.datePicker.start.valueOf(),end_time:this.$refs.datePicker.end.valueOf(),attack_type:this.selected,intercept_state:this.selected_status,url:this.url,app_id:this.current_app.id},page:t,perpage:10}).then(function(e){a.currentPage=t,a.data=e.data,a.total=e.total,a.loading=!1})}}},ga={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"my-3 my-md-5"},[e("div",{staticClass:"container"},[e("div",{staticClass:"page-header"},[e("h1",{staticClass:"page-title"},[t._v("\n        Vulnerability list\n      ")]),t._v(" "),e("div",{staticClass:"page-options d-flex"},[e("div",{staticClass:"input-icon ml-2"},[t._m(0),t._v(" "),e("DatePicker",{ref:"datePicker",on:{selected:function(a){return t.loadEvents(1)}}})],1),t._v(" "),e("b-dropdown",{staticClass:"ml-2",attrs:{text:"Blocking state",right:""}},[e("b-container",{staticStyle:{width:"250px"}},[e("b-form-row",[t._l(t.status_types,function(a,s){return[e("b-col",{key:s},[e("label",{staticClass:"custom-switch"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.selected_status,expression:"selected_status"}],staticClass:"custom-switch-input",attrs:{type:"checkbox"},domProps:{value:s,checked:Array.isArray(t.selected_status)?t._i(t.selected_status,s)>-1:t.selected_status},on:{change:function(a){var e=t.selected_status,n=a.target,i=!!n.checked;if(Array.isArray(e)){var r=s,l=t._i(e,r);n.checked?l<0&&(t.selected_status=e.concat([r])):l>-1&&(t.selected_status=e.slice(0,l).concat(e.slice(l+1)))}else t.selected_status=i}}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v("\n                      "+t._s(a)+"\n                    ")])])])]})],2)],1)],1),t._v(" "),e("b-dropdown",{staticClass:"ml-2",attrs:{text:"Vulnerability type",right:""}},[e("b-container",{staticStyle:{width:"500px"}},[e("b-form-row",[e("b-col",[e("label",{staticClass:"custom-switch"},[e("input",{staticClass:"custom-switch-input",attrs:{type:"checkbox",checked:""},on:{change:t.selectAll}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v("\n                    select all\n                  ")])])]),t._v(" "),e("div",{staticClass:"w-100"}),t._v(" "),t._l(t.attack_types,function(a,s,n){return[e("b-col",{key:s},[e("label",{staticClass:"custom-switch"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.selected,expression:"selected"}],staticClass:"custom-switch-input",attrs:{type:"checkbox"},domProps:{value:s,checked:Array.isArray(t.selected)?t._i(t.selected,s)>-1:t.selected},on:{change:function(a){var e=t.selected,n=a.target,i=!!n.checked;if(Array.isArray(e)){var r=s,l=t._i(e,r);n.checked?l<0&&(t.selected=e.concat([r])):l>-1&&(t.selected=e.slice(0,l).concat(e.slice(l+1)))}else t.selected=i}}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v("\n                      "+t._s(a)+"\n                    ")])])]),t._v(" "),n%2==1?e("div",{staticClass:"w-100"}):t._e()]})],2)],1)],1),t._v(" "),e("div",{staticClass:"input-icon ml-2"},[t._m(1),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.url,expression:"url",modifiers:{trim:!0}}],staticClass:"form-control w-10",attrs:{type:"text",placeholder:"目标URL"},domProps:{value:t.url},on:{keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.loadEvents(1)},input:function(a){a.target.composing||(t.url=a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("button",{staticClass:"btn btn-primary ml-2",on:{click:function(a){return t.loadEvents(1)}}},[t._v("\n          search for\n        ")])],1)]),t._v(" "),e("div",{staticClass:"card"},[e("div",{staticClass:"card-body"},[t.loading?e("VueLoading",{attrs:{type:"spiningDubbles",color:"rgb(90, 193, 221)",size:{width:"50px",height:"50px"}}}):t._e(),t._v(" "),!t.loading&&t.total>0?e("nav",[e("ul",{staticClass:"pagination pull-left"},[e("li",{staticClass:"active"},[e("span",{staticStyle:{"margin-top":"0.5em",display:"block"}},[e("strong",[t._v(t._s(t.total))]),t._v(" The results show that "+t._s(t.currentPage)+" / "+t._s(t.ceil(t.total/10))+"page\n              ")])])]),t._v(" "),e("b-pagination",{attrs:{align:"right","total-rows":t.total,"per-page":10},on:{change:function(a){return t.loadEvents(a)}},model:{value:t.currentPage,callback:function(a){t.currentPage=a},expression:"currentPage"}})],1):t._e(),t._v(" "),t.loading?t._e():e("table",{staticClass:"table table-striped table-bordered"},[t._m(2),t._v(" "),e("tbody",t._l(t.data,function(a){return e("tr",{key:a.id},[e("td",{attrs:{nowrap:""}},[t._v("\n                "+t._s(t.moment(a.event_time).format("YYYY-MM-DD"))+"\n                "),e("br"),t._v("\n                "+t._s(t.moment(a.event_time).format("HH:mm:ss"))+"\n              ")]),t._v(" "),e("td",{staticStyle:{"max-width":"500px","word-break":"break-word"}},[e("a",{attrs:{href:a.url,target:"_blank"}},[t._v("\n                  "+t._s(t.displayURL(a))+"\n                ")])]),t._v(" "),e("td",[a.attack_source?e("div",[e("a",{attrs:{target:"_blank",href:"https://www.virustotal.com/#/ip-address/"+(a.client_ip?a.client_ip:a.attack_source)}},[t._v("\n                    "+t._s(a.client_ip?a.client_ip:a.attack_source)+"                  \n                  ")]),t._v(" "),e("br")]):t._e(),t._v("\n                Use"+t._s(a.attack_count)+" 次\n              ")]),t._v(" "),e("td",{attrs:{nowrap:""}},[t._v("\n                "+t._s(t.block_status2name(a.intercept_state))+"\n              ")]),t._v(" "),e("td",{attrs:{nowrap:""}},[e("span",{staticClass:"tag tag-danger"},[t._v("\n                  "+t._s(t.attack_type2name(a.attack_type))+"\n                ")])]),t._v(" "),e("td",{staticStyle:{"word-break":"break-all"}},[t._v("\n                "+t._s(a.plugin_message)+"\n              ")]),t._v(" "),e("td",{attrs:{nowrap:""}},[e("a",{attrs:{href:"javascript:"},on:{click:function(e){return t.showEventDetail(a)}}},[t._v("\n                  see details\n                ")])])])}),0)]),t._v(" "),t.loading||0!=t.total?t._e():e("p",{staticClass:"text-center"},[t._v("No data")]),t._v(" "),!t.loading&&t.total>10?e("nav",[e("ul",{staticClass:"pagination pull-left"},[e("li",{staticClass:"active"},[e("span",{staticStyle:{"margin-top":"0.5em",display:"block"}},[e("strong",[t._v(t._s(t.total))]),t._v(" The results show that "+t._s(t.currentPage)+" / "+t._s(t.ceil(t.total/10))+" page\n              ")])])]),t._v(" "),e("b-pagination",{attrs:{align:"right","total-rows":t.total,"per-page":10},on:{change:function(a){return t.loadEvents(a)}},model:{value:t.currentPage,callback:function(a){t.currentPage=a},expression:"currentPage"}})],1):t._e()],1)])]),t._v(" "),e("EventDetailModal",{ref:"showEventDetail"})],1)},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("span",{staticClass:"input-icon-addon"},[a("i",{staticClass:"fe fe-calendar"})])},function(){var t=this.$createElement,a=this._self._c||t;return a("span",{staticClass:"input-icon-addon"},[a("i",{staticClass:"fe fe-search"})])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("thead",[e("tr",[e("th",[t._v("\n                Finally found\n              ")]),t._v(" "),e("th",{staticStyle:{"min-width":"150px"}},[t._v("\n                URL\n              ")]),t._v(" "),e("th",[t._v("\n                Source of attack\n              ")]),t._v(" "),e("th",[t._v("\n                Final state\n              ")]),t._v(" "),e("th",{attrs:{nowrap:""}},[t._v("\n               Vulnerability type\n              ")]),t._v(" "),e("th",[t._v("\n                Alarm message\n              ")]),t._v(" "),e("th",[t._v("\n               operating\n              ")])])])}]},ba=e("VU/8")(fa,ga,!1,null,null,null).exports,ya={name:"ExceptionDetailModal",data:function(){return{data:{}}},methods:{showModal:function(t){this.data=t,$("#showExceptionDetailModal").modal()}}},ka={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"modal no-fade",attrs:{id:"showExceptionDetailModal",tabindex:"-1",role:"dialog"}},[e("div",{staticClass:"modal-dialog modal-lg",attrs:{role:"document"}},[e("div",{staticClass:"modal-content"},[t._m(0),t._v(" "),e("div",{staticClass:"modal-body",staticStyle:{"padding-top":"0"}},[t._m(1),t._v(" "),e("br"),t._v(" "),e("div",{staticClass:"tab-content",attrs:{id:"myTabContent"}},[e("div",{staticClass:"tab-pane fade show active",attrs:{id:"exception",role:"tabpanel","aria-labelledby":"home-tab"}},[e("div",{staticClass:"h6"},[t._v("\n              Alarm time\n            ")]),t._v(" "),e("p",[t._v(t._s(t.moment(t.data.event_time).format("YYYY-MM-DD HH:mm:ss")))]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n              Alarm message\n            ")]),t._v(" "),e("p",{staticStyle:{"word-break":"break-all"}},[t._v("\n              ["+t._s(t.data.error_code)+"] "+t._s(t.data.message)+"\n            ")]),t._v(" "),t.data.pid?e("div",[e("div",{staticClass:"h6"},[t._v("\n                PID\n              ")]),t._v(" "),e("p",{staticStyle:{"word-break":"break-all"}},[t._v("\n                "+t._s(t.data.pid)+"\n              ")])]):t._e(),t._v(" "),t.data.path?e("div",[e("div",{staticClass:"h6"},[t._v("\n                Log path\n              ")]),t._v(" "),e("p",{staticStyle:{"word-break":"break-all"}},[t._v("\n                "+t._s(t.data.path)+"\n              ")])]):t._e(),t._v(" "),t.data.stack_trace?e("div",{staticClass:"h6"},[t._v("\n              Stack information\n            ")]):t._e(),t._v(" "),t.data.stack_trace?e("pre",[t._v(t._s(t.data.stack_trace))]):t._e()]),t._v(" "),e("div",{staticClass:"tab-pane fade",attrs:{id:"profile",role:"tabpanel","aria-labelledby":"profile-tab"}},[e("div",{staticClass:"h6"},[t._v("\n             Host name\n            ")]),t._v(" "),e("p",[t._v(t._s(t.data.server_hostname))]),t._v(" "),e("div",{staticClass:"h6"},[t._v("\n              Server IP\n            ")]),t._v(" "),e("ul",t._l(t.data.server_nic,function(a){return e("li",{key:a.name},[t._v(t._s(a.name)+": "+t._s(a.ip))])}),0)])])]),t._v(" "),t._m(2)])])])},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"modal-header"},[a("h5",{staticClass:"modal-title"},[this._v("\n          Exception details\n        ")]),this._v(" "),a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}})])},function(){var t=this.$createElement,a=this._self._c||t;return a("ul",{staticClass:"nav nav-tabs",attrs:{id:"myTab",role:"tablist"}},[a("li",{staticClass:"nav-item"},[a("a",{staticClass:"nav-link active",attrs:{id:"home-tab","data-toggle":"tab",href:"#exception"}},[this._v("\n              Exception information\n            ")])]),this._v(" "),a("li",{staticClass:"nav-item"},[a("a",{staticClass:"nav-link",attrs:{id:"profile-tab","data-toggle":"tab",href:"#profile",role:"tab"}},[this._v("Asset information")])])])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"modal-footer"},[a("button",{staticClass:"btn btn-primary",attrs:{"data-dismiss":"modal"}},[this._v("\n         shut down\n        ")])])}]},Ca={name:"Exceptions",components:{EventDetailModal:pa,ExceptionDetailModal:e("VU/8")(ya,ka,!1,null,null,null).exports,DatePicker:tt},data:function(){return{data:[],loading:!1,currentPage:1,hostname:"",message:"",total:0,fields:[{key:"event_time",label:"abnormal time",class:"text-nowrap"},{key:"error_code",label:"Exception number",class:"text-nowrap"},{key:"server_hostname",label:"Host Information",tdAttr:{style:"min-width: 150px;"}},{key:"message",label:"content"},{key:"button",label:"View details",class:"text-nowrap"}]}},computed:E()({},Object(c.c)(["current_app"])),watch:{current_app:function(){this.fetchData(1)},selected:function(){this.fetchData(1)}},mounted:function(){this.current_app.id&&this.fetchData(1)},methods:{ceil:Math.ceil,fetchData:function(t){var a=this,e={data:{start_time:this.$refs.datePicker.start.valueOf(),end_time:this.$refs.datePicker.end.valueOf(),app_id:this.current_app.id,server_hostname:this.hostname||void 0,message:this.message||void 0},page:t,perpage:10};return this.request.post("/v1/api/log/error/search",e).then(function(e){a.currentPage=t,a.data=e.data,a.total=e.total,a.loading=!1})},showExceptionDetail:function(t){this.$refs.showExceptionDetail.showModal(t)}}},wa={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"my-3 my-md-5"},[e("div",{staticClass:"container"},[e("div",{staticClass:"page-header"},[e("h1",{staticClass:"page-title"},[t._v("\n        Exception log\n      ")]),t._v(" "),e("div",{staticClass:"page-options d-flex"},[e("div",{staticClass:"input-icon ml-2"},[t._m(0),t._v(" "),e("DatePicker",{ref:"datePicker",on:{selected:function(a){return t.fetchData(1)}}})],1),t._v(" "),e("div",{staticClass:"input-icon ml-2"},[t._m(1),t._v(" "),e("b-form-input",{staticClass:"form-control",attrs:{type:"text",placeholder:"Search host or IP"},on:{keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.fetchData(1)}},model:{value:t.hostname,callback:function(a){t.hostname="string"==typeof a?a.trim():a},expression:"hostname"}})],1),t._v(" "),e("div",{staticClass:"input-icon ml-2"},[t._m(2),t._v(" "),e("b-form-input",{staticClass:"form-control",attrs:{type:"text",placeholder:"Search Message"},on:{keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.fetchData(1)}},model:{value:t.message,callback:function(a){t.message="string"==typeof a?a.trim():a},expression:"message"}})],1),t._v(" "),e("button",{staticClass:"btn btn-primary ml-2",on:{click:function(a){return t.fetchData(1)}}},[t._v("\n         search for\n        ")])])]),t._v(" "),e("div",{staticClass:"card"},[e("div",{staticClass:"card-body"},[t.loading?e("vue-loading",{attrs:{type:"spiningDubbles",color:"rgb(90, 193, 221)",size:{width:"50px",height:"50px"}}}):t._e(),t._v(" "),!t.loading&&t.total>0?e("nav",[e("ul",{staticClass:"pagination pull-left"},[e("li",{staticClass:"active"},[e("span",{staticStyle:{"margin-top":"0.5em",display:"block"}},[e("strong",[t._v(t._s(t.total))]),t._v(" The results show that"+t._s(t.currentPage)+" / "+t._s(t.ceil(t.total/10))+"page\n              ")])])]),t._v(" "),e("b-pagination",{attrs:{align:"right","total-rows":t.total,"per-page":10},on:{change:t.fetchData},model:{value:t.currentPage,callback:function(a){t.currentPage=a},expression:"currentPage"}})],1):t._e(),t._v(" "),e("b-table",{attrs:{hover:"",bordered:"",items:t.data,fields:t.fields},scopedSlots:t._u([{key:"event_time",fn:function(a){return[t._v("\n            "+t._s(t.moment(a.item.event_time).format("YYYY-MM-DD"))+"\n            "),e("br"),t._v("\n            "+t._s(t.moment(a.item.event_time).format("HH:mm:ss"))+"\n          ")]}},{key:"message",fn:function(a){return[t._v("\n            ["+t._s(a.item.level)+"] "+t._s(a.item.message)+"\n          ")]}},{key:"server_hostname",fn:function(a){return[t._v("\n            "+t._s(a.item.server_hostname)),e("br"),t._v(" "),t._l(a.item.server_nic,function(a){return e("span",{key:a.name},[t._v(t._s(a.name)+": "+t._s(a.ip)),e("br")])})]}},{key:"cell(button)",fn:function(a){return[e("b-link",{on:{click:function(e){return t.showExceptionDetail(a.item)}}},[t._v("View details")])]}}])}),t._v(" "),t.loading||0!=t.total?t._e():e("p",{staticClass:"text-center"},[t._v("No data yet")]),t._v(" "),!t.loading&&t.total>10?e("nav",[e("ul",{staticClass:"pagination pull-left"},[e("li",{staticClass:"active"},[e("span",{staticStyle:{"margin-top":"0.5em",display:"block"}},[e("strong",[t._v(t._s(t.total))]),t._v("The results show that "+t._s(t.currentPage)+" / "+t._s(t.ceil(t.total/10))+"page\n              ")])])]),t._v(" "),e("b-pagination",{attrs:{align:"right","total-rows":t.total,"per-page":10},on:{change:t.fetchData},model:{value:t.currentPage,callback:function(a){t.currentPage=a},expression:"currentPage"}})],1):t._e()],1)])]),t._v(" "),e("ExceptionDetailModal",{ref:"showExceptionDetail"})],1)},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("span",{staticClass:"input-icon-addon"},[a("i",{staticClass:"fe fe-calendar"})])},function(){var t=this.$createElement,a=this._self._c||t;return a("span",{staticClass:"input-icon-addon"},[a("i",{staticClass:"fe fe-search"})])},function(){var t=this.$createElement,a=this._self._c||t;return a("span",{staticClass:"input-icon-addon"},[a("i",{staticClass:"fe fe-search"})])}]},xa=e("VU/8")(Ca,wa,!1,null,null,null).exports,Pa={name:"DependencyDetailModal",data:function(){return{loading:!1,total:0,currentPage:1,data:{},search_data:{}}},methods:{ceil:Math.ceil,fetchData:function(t){var a=this;this.request.post("v1/api/dependency/search",{data:this.search_data,page:t,perpage:10}).then(function(t){a.data=t.data,a.total=t.total})},showModal:function(t){this.fetchData(1),$("#showDependencyDetailModal").modal()}}},$a={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"modal no-fade",attrs:{id:"showDependencyDetailModal",tabindex:"-1",role:"dialog"}},[e("div",{staticClass:"modal-dialog",staticStyle:{"max-width":"90%"},attrs:{role:"document"}},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header"},[e("h5",{staticClass:"modal-title"},[t._v("\n          Dependency details: "+t._s(t.search_data.tag)+"\n        ")]),t._v(" "),e("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}})]),t._v(" "),e("div",{staticClass:"modal-body"},[e("table",{staticClass:"table table-bordered"},[t._m(0),t._v(" "),e("tbody",t._l(t.data,function(a){return e("tr",{key:a.id},[e("td",{attrs:{nowrap:""}},[t._v(t._s(a.hostname))]),t._v(" "),e("td",{attrs:{nowrap:""}},[t._v(t._s(a.register_ip))]),t._v(" "),e("td",{attrs:{nowrap:""}},[t._v(t._s(t.moment(a["@timestamp"]).format("YYYY-MM-DD HH:mm:ss")))]),t._v(" "),e("td",[t._v("\n                "+t._s(a.path.join(", "))+"\n              ")])])}),0)]),t._v(" "),e("ul",{staticClass:"pagination pull-left"},[e("li",{staticClass:"active"},[e("span",{staticStyle:{"margin-top":"0.5em",display:"block"}},[e("strong",[t._v(t._s(t.total))]),t._v(" The results show that "+t._s(t.currentPage)+" / "+t._s(t.ceil(t.total/10))+" 页\n              ")])])]),t._v(" "),e("b-pagination",{attrs:{align:"right","total-rows":t.total,"per-page":10},on:{change:t.fetchData},model:{value:t.currentPage,callback:function(a){t.currentPage=a},expression:"currentPage"}})],1),t._v(" "),t._m(1)])])])},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("thead",[a("tr",[a("th",[this._v("Host name")]),this._v(" "),a("th",[this._v("Network Information")]),this._v(" "),a("th",[this._v("Final report")]),this._v(" "),a("th",[this._v("Path list")])])])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"modal-footer"},[a("button",{staticClass:"btn btn-primary",attrs:{"data-dismiss":"modal"}},[this._v("\n          关闭\n        ")])])}]},Aa={name:"Dependency",components:{DependencyDetailModal:e("VU/8")(Pa,$a,!1,null,null,null).exports,DatePicker:tt},data:function(){return{data:[],loading:!1,currentPage:1,hostname:"",key_word:"",total:0,fields:[{key:"vendor",label:"vendor"},{key:"product",label:"product"},{key:"version",label:"version number",tdAttr:{style:"min-width: 150px;"}},{key:"rasp_count",label:"Affect the host"},{key:"button",label:"View details",class:"text-nowrap"}]}},computed:E()({},Object(c.c)(["current_app"])),watch:{current_app:function(){this.fetchData(1)},selected:function(){this.fetchData(1)}},mounted:function(){this.current_app.id&&this.fetchData(1)},methods:{ceil:Math.ceil,fetchData:function(t){var a=this,e={data:{app_id:this.current_app.id,hostname:this.hostname||void 0,key_word:this.key_word||void 0},page:t,perpage:10};return this.request.post("v1/api/dependency/aggr",e).then(function(e){a.currentPage=t,a.data=e.data,a.total=e.total,a.loading=!1})},showDependencyDetail:function(t){this.$refs.dependencyDetailModal.search_data={app_id:this.current_app.id,tag:t.tag,key_word:this.key_word,hostname:this.hostname},this.$refs.dependencyDetailModal.showModal()}}},Sa={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"my-3 my-md-5"},[e("div",{staticClass:"container"},[e("div",{staticClass:"page-header"},[e("h1",{staticClass:"page-title"},[t._v("\n        Class library information\n      ")]),t._v(" "),e("div",{staticClass:"page-options d-flex"},[e("div",{staticClass:"input-icon ml-2"},[t._m(0),t._v(" "),e("b-form-input",{staticClass:"form-control",attrs:{type:"text",placeholder:"Search host/IP/OS"},on:{keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.fetchData(1)}},model:{value:t.hostname,callback:function(a){t.hostname="string"==typeof a?a.trim():a},expression:"hostname"}})],1),t._v(" "),e("div",{staticClass:"input-icon ml-2"},[t._m(1),t._v(" "),e("b-form-input",{staticClass:"form-control",attrs:{type:"text",placeholder:"Search manufacturer or product"},on:{keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.fetchData(1)}},model:{value:t.key_word,callback:function(a){t.key_word="string"==typeof a?a.trim():a},expression:"key_word"}})],1),t._v(" "),e("button",{staticClass:"btn btn-primary ml-2",on:{click:function(a){return t.fetchData(1)}}},[t._v("\n         search for\n        ")])])]),t._v(" "),e("div",{staticClass:"card"},[e("div",{staticClass:"card-body"},[t.loading?e("vue-loading",{attrs:{type:"spiningDubbles",color:"rgb(90, 193, 221)",size:{width:"50px",height:"50px"}}}):t._e(),t._v(" "),!t.loading&&t.total>0?e("nav",[e("ul",{staticClass:"pagination pull-left"},[e("li",{staticClass:"active"},[e("span",{staticStyle:{"margin-top":"0.5em",display:"block"}},[e("strong",[t._v(t._s(t.total))]),t._v("The results show that "+t._s(t.currentPage)+" / "+t._s(t.ceil(t.total/10))+"page\n              ")])])]),t._v(" "),e("b-pagination",{attrs:{align:"right","total-rows":t.total,"per-page":10},on:{change:t.fetchData},model:{value:t.currentPage,callback:function(a){t.currentPage=a},expression:"currentPage"}})],1):t._e(),t._v(" "),e("b-table",{attrs:{hover:"",bordered:"",items:t.data,fields:t.fields},scopedSlots:t._u([{key:"cell(button)",fn:function(a){return[e("b-link",{on:{click:function(e){return t.showDependencyDetail(a.item)}}},[t._v("View details")])]}}])}),t._v(" "),t.loading||0!=t.total?t._e():e("p",{staticClass:"text-center"},[t._v("No data")]),t._v(" "),!t.loading&&t.total>10?e("nav",[e("ul",{staticClass:"pagination pull-left"},[e("li",{staticClass:"active"},[e("span",{staticStyle:{"margin-top":"0.5em",display:"block"}},[e("strong",[t._v(t._s(t.total))]),t._v("The results show that"+t._s(t.currentPage)+" / "+t._s(t.ceil(t.total/10))+" 页\n              ")])])]),t._v(" "),e("b-pagination",{attrs:{align:"right","total-rows":t.total,"per-page":10},on:{change:t.fetchData},model:{value:t.currentPage,callback:function(a){t.currentPage=a},expression:"currentPage"}})],1):t._e()],1)])]),t._v(" "),e("DependencyDetailModal",{ref:"dependencyDetailModal"})],1)},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("span",{staticClass:"input-icon-addon"},[a("i",{staticClass:"fe fe-search"})])},function(){var t=this.$createElement,a=this._self._c||t;return a("span",{staticClass:"input-icon-addon"},[a("i",{staticClass:"fe fe-search"})])}]},Da=e("VU/8")(Aa,Sa,!1,null,null,null).exports,Ea={name:"IastConfigModal",data:function(){return{data:{scan_rate:{max_concurrent_request:20,max_request_interval:1e3,min_request_interval:0},white_url_reg:"",scan_proxy:""},scan_plugin_status:{},byurl_regex_error:!1,modalDisplay:"modal"}},watch:{"data.white_url_reg":function(t,a){this.byurl_regex_error=this.validateRegex(t)}},methods:{showModal:function(t){this.data=t,$("#setConfigModal").modal()},validateRegex:y,getRequest:function(t,a,e){var s={order:a,data:e,headers:{"Content-Type":"application/json"}};return this.request.post(t,s)},setConfigTask:function(){var t=this,a=this.data.host,e=this.data.port,s=this.data.app_id,n=this.data.scan_rate;this.modalDisplay="modal",this.concurrent=isNaN(Number(n.max_concurrent_request))?void 0:Number(n.max_concurrent_request),this.minInterval=isNaN(Number(n.min_request_interval))?void 0:Number(n.min_request_interval),this.maxInterval=isNaN(Number(n.max_request_interval))?void 0:Number(n.max_request_interval),void 0!=this.data.white_url_reg&&this.data.white_url_reg,void 0!=this.data.scan_proxy&&this.data.scan_proxy,!this.byurl_regex_error&&this.concurrent>0&&this.maxInterval>0&&this.minInterval>=0?this.minInterval<=this.maxInterval?this.getRequest(this.data.baseUrl,"setConfig",{host:a,port:e,app_id:s,config:{scan_plugin_status:this.data.scan_plugin_status,scan_rate:{max_concurrent_request:this.concurrent,max_request_interval:this.maxInterval,min_request_interval:this.minInterval},white_url_reg:this.data.white_url_reg,scan_proxy:this.data.scan_proxy}}).then(function(a){0==a.status?(alert("设置成功"),t.concurrent=void 0,t.minInterval=void 0,t.maxInterval=void 0):alert(a.description)}):(this.minInterval=void 0,alert("最小间隔不应超过最大间隔"),this.modalDisplay=!1):this.modalDisplay=!1},setPluginStatus:function(t){this.data.scan_plugin_status[pl].enable=!this.data.scan_plugin_status[pl].enable},reset:function(){this.concurrent=void 0,this.minInterval=void 0,this.maxInterval=void 0}}},ja={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"modal no-fade",attrs:{id:"setConfigModal",tabindex:"-1",role:"dialog"}},[e("div",{staticClass:"modal-dialog modal-lg",attrs:{role:"document"}},[e("div",{staticClass:"modal-content"},[t._m(0),t._v(" "),e("div",{staticClass:"modal-body"},[e("form",{staticClass:"form-horizontal",attrs:{id:""}},[e("div",{staticClass:"form-group"},[t._m(1),t._v(" "),e("div",{staticClass:"row",staticStyle:{"margin-top":"3px"}},[t._l(t.data.scan_plugin_status,function(a,s,n){return[e("div",{staticClass:"col"},[e("label",{staticClass:"custom-switch",staticStyle:{"min-width":"200px"}},[e("input",{directives:[{name:"model",rawName:"v-model",value:a.enable,expression:"value.enable"}],staticClass:"custom-switch-input",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(a.enable)?t._i(a.enable,null)>-1:a.enable},on:{change:function(e){var s=a.enable,n=e.target,i=!!n.checked;if(Array.isArray(s)){var r=t._i(s,null);n.checked?r<0&&t.$set(a,"enable",s.concat([null])):r>-1&&t.$set(a,"enable",s.slice(0,r).concat(s.slice(r+1)))}else t.$set(a,"enable",i)}}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v(t._s(a.show_name))])])])]})],2)]),t._v(" "),e("div",{staticClass:"form-group"},[e("div",{staticClass:"row",staticStyle:{"margin-top":"3px"}},[e("div",{staticClass:"col"},[e("label",[t._v("url whitelist regularity (urls hit by regularization will not be scanned, regular ones will match the request_uri part,\n                    For example, http://test.com/path/eg?p=1&b=2 corresponds to the request_uri part /path/eg?p=1&b=2,\n                    When you don’t want to scan the path starting with path/eg, you can configure it as ^/path/eg)")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.data.white_url_reg,expression:"data.white_url_reg"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.data.white_url_reg},on:{input:function(a){a.target.composing||t.$set(t.data,"white_url_reg",a.target.value)}}}),t._v(" "),e("label",{directives:[{name:"show",rawName:"v-show",value:t.byurl_regex_error,expression:"byurl_regex_error"}],staticStyle:{color:"#ff0000"}},[t._v("*Whitelist is illegal")])])])]),t._v(" "),e("div",{staticClass:"form-group"},[e("div",{staticClass:"row",staticStyle:{"margin-top":"3px"}},[e("div",{staticClass:"col"},[e("label",{attrs:{for:"concurrent",align:"center"}},[t._v("Maximum number of concurrent requests")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.data.scan_rate.max_concurrent_request,expression:"data.scan_rate.max_concurrent_request"}],staticClass:"form-control",attrs:{type:"number",id:"concurrent",placeholder:"20"},domProps:{value:t.data.scan_rate.max_concurrent_request},on:{input:function(a){a.target.composing||t.$set(t.data.scan_rate,"max_concurrent_request",a.target.value)}}}),t._v(" "),e("label",{directives:[{name:"show",rawName:"v-show",value:t.data.scan_rate.max_concurrent_request<=0,expression:"data.scan_rate.max_concurrent_request <= 0"}],staticStyle:{color:"#F00"}},[t._v("*The maximum concurrent number should be greater than 0")])])])]),t._v(" "),e("div",{staticClass:"form-group"},[t._m(2),t._v(" "),e("div",{staticClass:"row",staticStyle:{"margin-top":"3px"}},[e("div",{staticClass:"col"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.data.scan_rate.min_request_interval,expression:"data.scan_rate.min_request_interval"}],staticClass:"form-control",attrs:{type:"number",id:"minInterval",placeholder:"0"},domProps:{value:t.data.scan_rate.min_request_interval},on:{input:function(a){a.target.composing||t.$set(t.data.scan_rate,"min_request_interval",a.target.value)}}}),t._v(" "),e("label",{directives:[{name:"show",rawName:"v-show",value:t.data.scan_rate.min_request_interval<0,expression:"data.scan_rate.min_request_interval < 0"}],staticStyle:{color:"#F00"}},[t._v("*The minimum interval should be greater than or equal to 0")])]),t._v(" "),t._m(3),t._v(" "),e("div",{staticClass:"col"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.data.scan_rate.max_request_interval,expression:"data.scan_rate.max_request_interval"}],staticClass:"form-control",attrs:{type:"number",id:"maxInterval",placeholder:"1000"},domProps:{value:t.data.scan_rate.max_request_interval},on:{input:function(a){a.target.composing||t.$set(t.data.scan_rate,"max_request_interval",a.target.value)}}}),t._v(" "),e("label",{directives:[{name:"show",rawName:"v-show",value:t.data.scan_rate.max_request_interval<=0,expression:"data.scan_rate.max_request_interval <= 0"}],staticStyle:{color:"#F00"}},[t._v("*Maximum interval should be greater than 0")])])])]),t._v(" "),e("div",{staticClass:"form-group"},[e("div",{staticClass:"row",staticStyle:{"margin-top":"3px"}},[e("div",{staticClass:"col"},[e("label",[t._v("Http proxy used by scan request")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.data.scan_proxy,expression:"data.scan_proxy"}],staticClass:"form-control",attrs:{type:"text",id:"scanProxy"},domProps:{value:t.data.scan_proxy},on:{input:function(a){a.target.composing||t.$set(t.data,"scan_proxy",a.target.value)}}})])])])])]),t._v(" "),e("div",{staticClass:"modal-footer"},[e("button",{staticClass:"btn btn-primary pull-left",attrs:{type:"button",disabled:t.byurl_regex_error,"data-dismiss":t.modalDisplay},on:{click:function(a){return t.setConfigTask()}}},[t._v("OK\n        ")]),t._v(" "),e("button",{staticClass:"btn btn-info",attrs:{click:t.reset(),"data-dismiss":"modal"}},[t._v("\n          shut down\n        ")])])])])])},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"modal-header"},[a("h5",{staticClass:"modal-title"},[this._v("\n          Task settings\n        ")]),this._v(" "),a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}})])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"row"},[a("div",{staticClass:"col"},[a("label",[this._v("Please select plugin")])])])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"row",staticStyle:{"margin-top":"3px"}},[a("div",{staticClass:"col"},[a("label",{attrs:{for:"minInterval",align:"center"}},[this._v("Request interval (ms)")])])])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"col",attrs:{align:"middle"}},[a("h5",[this._v("～")])])}]},Ma={name:"Iast",components:{IastConfigModal:e("VU/8")(Ea,ja,!1,null,null,null).exports,DatePicker:tt},data:function(){return{data:[],taskObject:{},config:"",timer:"",refreshFreq:!0,loadIcon:[],loading:!1,currentPage:1,hostname:"",key_word:"",total:0,register:0,baseUrl:"v1/iast",running:"Running",cancel:"termination",pause:"time out",unknown:"Unknown status",unscanned:"not initiated"}},computed:E()({},Object(c.c)(["current_app"])),watch:{current_app:function(){this.fetchData(1)},currentPage:function(){this.fetchData(this.currentPage)}},mounted:function(){this.current_app.id=this.$route.params.app_id,this.current_app.id&&(this.fetchData(1),this.timer=setInterval(this.getInterval,3e3),this.setLoadIcons())},beforeDestroy:function(){clearInterval(this.timer)},methods:{ceil:Math.ceil,getInterval:function(){this.refreshFreq&&this.refreshDriver()},showIastConfigDetail:function(t){this.$refs.showIastConfigDetail.showModal(t)},fetchData:function(t){var a=this,e={order:"getAllTasks",data:{page:this.currentPage,app_id:this.current_app.id}};return this.request.post(this.baseUrl,e).then(function(e){a.page=t,void 0==e.data?(a.status=e.status,a.data=[],a.total=0):(a.status=e.data.status,a.data=e.data.result,a.total=e.data.total),a.register=e.register,a.loading=!1})},getRequest:function(t,a,e){e.app_id=this.current_app.id;var s={order:a,data:e};return this.request.post(t,s)},setLoadIcons:function(){for(var t=0;t<this.data.length;t++)this.loadIcon.push(!1)},getTaskStatus:function(t,a){return void 0==t.id?(this.taskObject[a]=this.unscanned,this.unscanned):(this.taskObject[a]=this.running,this.running)},stopTask:function(t){var a=this;this.loadIcon[t]=!0;var e=this.data[t].id;this.getRequest(this.baseUrl,"stopTask",{scanner_id:Number(e)}).then(function(e){var s=e.status;a.fetchData(a.currentPage),0==s||alert(e.description),a.loadIcon[t]=!1})},startTask:function(t){var a=this;this.loadIcon[t]=!0;var e=this.data[t].host,s=this.data[t].port;this.getRequest(this.baseUrl,"startTask",{host:e,port:s,config:{}}).then(function(e){var s=e.status;a.fetchData(a.currentPage),0==s||alert(e.description),a.loadIcon[t]=!1})},cleanTask:function(t,a){var e=this;if(0==a){if(1==confirm("确认删除任务?")){var s=this.data[t].host,n=this.data[t].port;this.getRequest(this.baseUrl,"cleanTask",{host:s,port:n,url_only:!1}).then(function(t){var a=t.status;e.fetchData(e.currentPage),0==a?alert("Cleared successfully!"):alert(t.description)})}}else if(1==confirm("Are you sure to clear the scan queue?")){s=this.data[t].host,n=this.data[t].port;this.getRequest(this.baseUrl,"cleanTask",{host:s,port:n,url_only:!0}).then(function(t){var a=t.status;e.fetchData(e.currentPage),0==a?alert("Cleared successfully!"):alert(t.description)})}},refreshDriver:function(){this.fetchData(this.currentPage)},getConfig:function(t){var a=this,e=t.host,s=t.port;this.getRequest(this.baseUrl,"getConfig",{host:e,port:s}).then(function(t){0!=t.status&&alert(t.description);var n=t.data;n.host=e,n.port=s,n.baseUrl=a.baseUrl,n.app_id=a.current_app.id,a.showIastConfigDetail(n)})}}},qa={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"my-3 my-md-5"},[e("div",{staticClass:"container"},[e("div",{staticClass:"page-header"},[e("h1",{staticClass:"page-title"},[t._v("\n        Scan task list\n      ")]),t._v(" "),e("div",{staticClass:"page-options d-flex",staticStyle:{"margin-top":"5px"}},[e("div",{staticClass:"p-4"},[e("label",{staticClass:"custom-switch",attrs:{for:"checkRefresh"}},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.refreshFreq,expression:"refreshFreq"}],staticClass:"custom-switch-input",attrs:{type:"checkbox",id:"checkRefresh"},domProps:{value:!0,checked:Array.isArray(t.refreshFreq)?t._i(t.refreshFreq,!0)>-1:t.refreshFreq},on:{change:function(a){var e=t.refreshFreq,s=a.target,n=!!s.checked;if(Array.isArray(e)){var i=t._i(e,!0);s.checked?i<0&&(t.refreshFreq=e.concat([!0])):i>-1&&(t.refreshFreq=e.slice(0,i).concat(e.slice(i+1)))}else t.refreshFreq=n}}}),t._v(" "),e("span",{staticClass:"custom-switch-indicator"}),t._v(" "),e("span",{staticClass:"custom-switch-description"},[t._v("Auto Refresh")])])]),t._v(" "),e("div",{staticClass:"p-2"},[e("button",{staticClass:"btn btn-primary ml-2",attrs:{type:"button"},on:{click:function(a){return t.refreshDriver()}}},[e("span",{staticClass:"fa fa-refresh",attrs:{"aria-hidden":"true"}}),t._v(" Refresh\n          ")])])])]),t._v(" "),e("div",{staticClass:"card"},[e("div",{staticClass:"card-body"},[t.loading?e("vue-loading",{attrs:{type:"spiningDubbles",color:"rgb(90, 193, 221)",size:{width:"50px",height:"50px"}}}):t._e(),t._v(" "),!t.loading&&t.total>0?e("nav",[e("ul",{staticClass:"pagination pull-left"},[e("li",{staticClass:"active"},[e("span",{staticStyle:{"margin-top":"0.5em",display:"block"}},[e("strong",[t._v(t._s(t.total))]),t._v(" The results show that"+t._s(t.currentPage)+" / "+t._s(t.ceil(t.total/10))+"page\n              ")])])]),t._v(" "),e("b-pagination",{attrs:{align:"right","total-rows":t.total,"per-page":10},on:{change:t.fetchData},model:{value:t.currentPage,callback:function(a){t.currentPage=a},expression:"currentPage"}})],1):t._e(),t._v(" "),t.loading?t._e():e("table",{staticClass:"table table-hover table-bordered"},[t._m(0),t._v(" "),e("tbody",t._l(t.data,function(a,s){return e("tr",[e("td",[e("a",[t._v(t._s(a.host)+":"+t._s(a.port))])]),t._v(" "),e("td",[t._v("\n              "+t._s(t.getTaskStatus(a,s))+"\n            ")]),t._v(" "),e("td",[t._v("\n              "+t._s(a.scanned)+"/"+t._s(a.failed)+"/"+t._s(a.total)+"\n            ")]),t._v(" "),e("td",[t._v("\n              "+t._s(0==a.last_time?"—":t.moment(1e3*a.last_time).format("YYYY-MM-DD HH:mm:ss"))+"\n            ")]),t._v(" "),e("td",[void 0==a.id?e("div",[t._v("—")]):e("div",[t._v("CPU "+t._s(a.cpu)+" / MEM "+t._s(a.mem))])]),t._v(" "),e("td",{attrs:{align:"left"}},[e("div",{staticStyle:{"vertical-align":"middle"}},[e("a",{directives:[{name:"show",rawName:"v-show",value:t.taskObject[s]!=t.unscanned,expression:"taskObject[i] != unscanned"}],attrs:{href:"javascript:",disabled:t.taskObject[s]==t.unscanned||t.loadIcon[s]},on:{click:function(a){return t.stopTask(s)}},model:{value:t.taskObject[s],callback:function(a){t.$set(t.taskObject,s,a)},expression:"taskObject[i]"}},[e("i",{directives:[{name:"show",rawName:"v-show",value:t.loadIcon[s],expression:"loadIcon[i]"}],staticClass:"fas fa-spinner fa-spin"}),t._v("\n                 Stop scanning\n                ")]),t._v(" "),e("a",{directives:[{name:"show",rawName:"v-show",value:t.taskObject[s]==t.unscanned,expression:"taskObject[i] ==  unscanned"}],attrs:{href:"javascript:",disabled:t.taskObject[s]==t.running||t.loadIcon[s]},on:{click:function(a){return t.startTask(s)}}},[e("i",{directives:[{name:"show",rawName:"v-show",value:t.loadIcon[s],expression:"loadIcon[i]"}],staticClass:"fas fa-spinner fa-spin"}),t._v("\n                 Start scan\n                ")]),t._v(" "),e("a",{attrs:{href:"javascript:"},on:{click:function(e){return t.getConfig(a)}}},[t._v("\n                 Set up\n                ")]),t._v(" "),e("a",{directives:[{name:"show",rawName:"v-show",value:t.taskObject[s]==t.unscanned,expression:"taskObject[i] == unscanned"}],attrs:{href:"javascript:"},on:{click:function(a){return t.cleanTask(s,!0)}},model:{value:t.status,callback:function(a){t.status=a},expression:"status"}},[t._v("\n                Empty the queue\n                ")]),t._v(" "),e("a",{directives:[{name:"show",rawName:"v-show",value:t.taskObject[s]==t.unscanned,expression:"taskObject[i] == unscanned"}],attrs:{href:"javascript:"},on:{click:function(a){return t.cleanTask(s,!1)}},model:{value:t.status,callback:function(a){t.status=a},expression:"status"}},[t._v("\n                 Delete task\n                ")])])])])}),0)]),t._v(" "),t.loading||0!=t.register?t._e():e("p",{staticClass:"text-center",model:{value:t.register,callback:function(a){t.register=a},expression:"register"}},[t._v("Scanner is not connected or offline")]),t._v(" "),t.loading||0!=t.total||1!=t.register?t._e():e("p",{staticClass:"text-center",model:{value:t.register,callback:function(a){t.register=a},expression:"register"}},[t._v("Connecting")]),t._v(" "),t.loading||0!=t.total||2!=t.register?t._e():e("p",{staticClass:"text-center",model:{value:t.register,callback:function(a){t.register=a},expression:"register"}},[t._v("Scanner is connected, no data temporarily")]),t._v(" "),t.loading||3!=t.register?t._e():e("p",{staticClass:"text-center",model:{value:t.register,callback:function(a){t.register=a},expression:"register"}},[t._v("Response receiving exception")]),t._v(" "),t.loading||4!=t.register?t._e():e("p",{staticClass:"text-center",model:{value:t.register,callback:function(a){t.register=a},expression:"register"}},[t._v("Scanner connection timeout")]),t._v(" "),!t.loading&&t.total>10?e("nav",[e("ul",{staticClass:"pagination pull-left"},[e("li",{staticClass:"active"},[e("span",{staticStyle:{"margin-top":"0.5em",display:"block"}},[e("strong",[t._v(t._s(t.total))]),t._v("The results show that "+t._s(t.currentPage)+" / "+t._s(t.ceil(t.total/10))+" page\n              ")])])]),t._v(" "),e("b-pagination",{attrs:{align:"right","total-rows":t.total,"per-page":10},on:{change:t.fetchData},model:{value:t.currentPage,callback:function(a){t.currentPage=a},expression:"currentPage"}})],1):t._e()],1)])]),t._v(" "),e("IastConfigModal",{ref:"showIastConfigDetail"})],1)},staticRenderFns:[function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("thead",[e("tr",[e("th",{attrs:{nowrap:""}},[t._v("\n              aims\n            ")]),t._v(" "),e("th",{attrs:{nowrap:""}},[t._v("\n             status\n            ")]),t._v(" "),e("th",{attrs:{nowrap:""}},[t._v("\n             Scanned/Failed/Total Tasks\n            ")]),t._v(" "),e("th",[t._v("\n             Finally received the task\n            ")]),t._v(" "),e("th",[t._v("\n              Process resource consumption\n            ")]),t._v(" "),e("th",{attrs:{nowrap:""}},[t._v("\n             operating\n            ")])])])}]},Na=e("VU/8")(Ma,qa,!1,null,null,null).exports,Ra={name:"AddHostModal",data:function(){return{data:{},location:location,agent_url_id:0,agent_urls:[],panel_url:"",rasp_version:"1.3.5"}},computed:E()({},Object(c.c)(["current_app","sticky"])),mounted:function(){var t=this;$("#addHostModal").on("hidden.bs.modal",function(){t.setSticky(!0)})},methods:E()({},Object(c.d)(["setSticky"]),{showModal:function(t){var a=this;return this.request.post("v1/api/server/url/get",{}).then(function(t){a.agent_urls=t.agent_urls,a.panel_url=t.panel_url,a.setSticky(!1),$("#addHostModal").modal()})}})},Ua={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"modal no-fade",attrs:{id:"addHostModal",tabindex:"-1",role:"dialog"}},[e("div",{staticClass:"modal-dialog modal-lg",attrs:{role:"document"}},[e("div",{staticClass:"modal-content"},[t._m(0),t._v(" "),e("div",{staticClass:"modal-body",staticStyle:{"padding-top":"0"}},[0==t.agent_urls.length?e("div",[e("p",[e("br"),t._v("\n              You have not set the Agent server address, please go to\n              "),e("router-link",{attrs:{"data-dismiss":"modal",to:{name:"settings",params:{setting_tab:"panel"}}}},[t._v("[Background settings]")]),t._v(" page added\n            ")],1)]):e("div",[t._m(1),t._v(" "),e("br"),t._v(" "),e("div",{staticClass:"tab-content",attrs:{id:"myTabContent"}},[e("div",{staticClass:"tab-pane fade",attrs:{id:"common-tab"}},[t._m(2),t._v(" "),e("h4",[t._v("Java version")]),t._v(" "),e("pre",[t._v("cloud.enable: true\ncloud.backend_url: "+t._s(t.agent_urls[0])+"\ncloud.app_id: "+t._s(t.current_app.id)+"\ncloud.app_secret: "+t._s(t.current_app.secret)+"\ncloud.heartbeat_interval: 90")]),t._v(" "),e("h4",[t._v("PHP version")]),t._v(" "),e("pre",[t._v("openrasp.app_id="+t._s(t.current_app.id)+"\nopenrasp.app_secret="+t._s(t.current_app.secret)+"            \nopenrasp.backend_url="+t._s(t.agent_urls[0])+"\nopenrasp.heartbeat_interval=90")])]),t._v(" "),e("div",{staticClass:"tab-pane fade",attrs:{id:"batch-tab"}},[t._m(3),t._v(" "),e("h4",[t._v("1. Download the automatic installer")]),t._v(" "),e("pre",{staticStyle:{"white-space":"inherit"}},[t._v("curl https://packages.baidu.com/app/openrasp/release/"+t._s(t.rasp_version)+"/installer.sh -o installer.sh")]),t._v(" "),e("h4",[t._v("2. Execute script")]),t._v(" "),e("pre",{staticStyle:{"white-space":"inherit"}},[t._v("bash installer.sh -i -a "+t._s(t.current_app.id)+" -b "+t._s(t.current_app.secret)+" -c "+t._s(t.agent_urls[t.agent_url_id]))])]),t._v(" "),e("div",{staticClass:"tab-pane fade",attrs:{id:"docker-tab"}},[t._m(4),t._v(" "),e("h4",[t._v("Java Tomcat container example")]),t._v(" "),e("pre",[t._v("ADD https://packages.baidu.com/app/openrasp/release/"+t._s(t.rasp_version)+"/rasp-java.tar.gz /tmp\nRUN cd /tmp \\\n    && tar -xf rasp-java.tar.* \\\n    && /jdk/bin/java -jar rasp-*/RaspInstall.jar -install /tomcat/ -heartbeat 90 -appid "+t._s(t.current_app.id)+" -appsecret "+t._s(t.current_app.secret)+" -backendurl "+t._s(t.agent_urls[t.agent_url_id])+" \\\n    && rm -rf rasp-*\n#For Alpine Linux containers, system dependencies need to be installed\n# RUN apk add --no-cache libcurl libstdc++")]),t._v(" "),e("h4",[t._v("Java SpringBoot container example")]),t._v(" "),e("pre",[t._v("ADD https://packages.baidu.com/app/openrasp/release/"+t._s(t.rasp_version)+'/rasp-java.tar.gz /tmp\nRUN cd /tmp \\\n    && tar -xf rasp-java.tar.* \\\n    && mv rasp-*/rasp/ /rasp/ \\\n    && rm -f rasp-java.tar.gz\n# For Alpine Linux containers, system dependencies need to be installed\n# RUN apk add --no-cache libcurl libstdc++\n\nRUN echo "cloud.enable: true" >> /rasp/conf/openrasp.yml \\\n    && echo "cloud.backend_url: '+t._s(t.agent_urls[t.agent_url_id])+'" >> /rasp/conf/openrasp.yml \\\n    && echo "cloud.app_id: '+t._s(t.current_app.id)+'" >> /rasp/conf/openrasp.yml \\\n    && echo "cloud.app_secret: '+t._s(t.current_app.secret)+'" >> /rasp/conf/openrasp.yml\n\n#For JDK9, additional--add-opens java.base/jdk.internal.loader=ALL-UNNAMED 参数\nCMD java -javaagent:"/rasp/rasp.jar" -jar /springboot.jar')]),t._v(" "),e("h4",[t._v("PHP container example")]),t._v(" "),e("pre",[t._v("ADD https://packages.baidu.com/app/openrasp/release/"+t._s(t.rasp_version)+"/rasp-php-linux.tar.bz2 /tmp/\nRUN cd /tmp \\\n    && tar -xf rasp-php-linux.tar.bz2 \\\n    && php rasp-php-*/install.php -d /opt/rasp/ --heartbeat 90 --backend-url "+t._s(t.agent_urls[t.agent_url_id])+" --app-id "+t._s(t.current_app.id)+" --app-secret "+t._s(t.current_app.secret)+" \\\n    && rm -rf rasp-php*")])]),t._v(" "),e("div",{staticClass:"tab-pane fade show active",attrs:{id:"java-tab"}},[e("h4",[t._v("1. Download the Java Agent installation package")]),t._v(" "),e("pre",{staticStyle:{"white-space":"inherit"}},[t._v("curl https://packages.baidu.com/app/openrasp/release/"+t._s(t.rasp_version)+"/rasp-java.tar.gz -o rasp-java.tar .gz"),e("br"),t._v("tar -xvf rasp-java.tar.gz"),e("br"),t._v("cd rasp-*/")]),t._v(" "),e("h4",[t._v("2. Execute RaspInstall to install")]),t._v(" "),e("p",[t._v("Please replace /path/to/tomcat as your server path first, and then execute the command to install")]),t._v(" "),e("pre",{staticStyle:{"white-space":"inherit"}},[t._v("java -jar RaspInstall.jar -heartbeat 90 -appid "+t._s(t.current_app.id)+" -appsecret "+t._s(t.current_app.secret)+" -backendurl "+t._s(t.agent_urls[t.agent_url_id])+" -install "),e("font",{attrs:{color:"red"}},[t._v("/path/to/tomcat")])],1),t._v(" "),e("h4",[t._v("3. Restart Tomcat/JBoss/WebLogic/SpringBoot application server")]),t._v(" "),t._m(5)]),t._v(" "),e("div",{staticClass:"tab-pane fade",attrs:{id:"php-tab"}},[e("h4",[t._v("1. Download the PHP installation package")]),t._v(" "),e("pre",{staticStyle:{"white-space":"inherit"}},[t._v("curl https://packages.baidu.com/app/openrasp/release/"+t._s(t.rasp_version)+"/rasp-php-linux.tar.bz2 -o rasp-php -linux.tar.bz2"),e("br"),t._v("tar -xvf rasp-php-linux.tar.bz2"),e("br"),t._v("cd rasp-*/")]),t._v(" "),e("h4",[t._v("2. Execute install.php to install it")]),t._v(" "),e("pre",{staticStyle:{"white-space":"inherit"}},[t._v("php install.php -d "),e("font",{attrs:{color:"red"}},[t._v("/opt/rasp")]),t._v(" --heartbeat 90 --app-id "+t._s(t.current_app.id)+" --app-secret "+t._s(t.current_app.secret)+" --backend-url "+t._s(t.agent_urls[t.agent_url_id]))],1),t._v(" "),e("h4",[t._v("3. Restart the PHP-FPM or Apache server")]),t._v(" "),e("pre",{staticStyle:{"white-space":"inherit"}},[t._v("service php-fpm restart")]),t._v(" "),e("p",[t._v("-or-")]),t._v(" "),e("pre",{staticStyle:{"white-space":"inherit"}},[t._v("apachectl -k restart")])]),t._v(" "),e("div",{staticClass:"tab-pane fade",attrs:{id:"iast-tab"}},[e("h4",[t._v("1. Download or upgrade the Fuzz tool")]),t._v(" "),e("pre",{staticStyle:{"white-space":"inherit"}},[t._v("pip3 install --upgrade git+https://github.com/baidu-security/openrasp-iast")]),t._v(" "),e("h4",[t._v("2. Configure MySQL server-use the MySQL root account to execute the following commands to authorize")]),t._v(" "),e("pre",[t._v("DROP DATABASE IF EXISTS openrasp;\nCREATE DATABASE openrasp default charset utf8mb4 COLLATE utf8mb4_general_ci;\ngrant all privileges on openrasp.* to 'rasp'@'%' identified by 'rasp123';\ngrant all privileges on openrasp.* to 'rasp'@'localhost' identified by 'rasp123';\n")]),t._v(" "),e("h4",[t._v("3. Configure Fuzz Tool-Please correct the MySQL server address")]),t._v(" "),e("pre",{staticStyle:{"white-space":"inherit"}},[t._v("openrasp-iast config -a "+t._s(t.current_app.id)+" -b "+t._s(t.current_app.secret)+" -c "+t._s(t.panel_url)+" -m mysql://rasp:rasp123@127.0.0.1/openrasp")]),t._v(" "),e("h4",[t._v("4. Start the Fuzz tool")]),t._v(" "),e("pre",{staticStyle:{"white-space":"inherit"}},[t._v("openrasp-iast start -f")]),t._v(" "),e("p",[t._v("-Or start in the background-")]),t._v(" "),e("pre",{staticStyle:{"white-space":"inherit"}},[t._v("openrasp-iast start")])])])])]),t._v(" "),t._m(6)])])])},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"modal-header"},[a("h5",{staticClass:"modal-title"},[this._v("\nAdd host          ")]),this._v(" "),a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}})])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("ul",{staticClass:"nav nav-tabs",attrs:{id:"myTab",role:"tablist"}},[e("li",{staticClass:"nav-item"},[e("a",{staticClass:"nav-link",attrs:{"data-toggle":"tab",href:"#common-tab"}},[t._v("\n                  Manual installation\n                ")])]),t._v(" "),e("li",{staticClass:"nav-item"},[e("a",{staticClass:"nav-link",attrs:{"data-toggle":"tab",href:"#batch-tab"}},[t._v("\n                  Batch deployment\n                ")])]),t._v(" "),e("li",{staticClass:"nav-item"},[e("a",{staticClass:"nav-link",attrs:{"data-toggle":"tab",href:"#docker-tab"}},[t._v("\n                  Docker deployment\n                ")])]),t._v(" "),e("li",{staticClass:"nav-item"},[e("a",{staticClass:"nav-link active",attrs:{"data-toggle":"tab",href:"#java-tab"}},[t._v("\n                  Java server\n                ")])]),t._v(" "),e("li",{staticClass:"nav-item"},[e("a",{staticClass:"nav-link",attrs:{"data-toggle":"tab",href:"#php-tab"}},[t._v("\n                  PHP server\n                ")])]),t._v(" "),e("li",{staticClass:"nav-item"},[e("a",{staticClass:"nav-link",attrs:{"data-toggle":"tab",href:"#iast-tab"}},[t._v("\n                  Fuzz tool installation\n                ")])])])},function(){var t=this.$createElement,a=this._self._c||t;return a("p",[this._v("The OpenRASP automatic installation program can cover most scenarios. If your environment cannot be installed automatically, please refer to "),a("a",{attrs:{href:"https://rasp.baidu.com/doc/install/software.html",target:"_blank"}},[this._v(" Install the client")]),this._v(" for manual installation. The following are the key parameters required to connect to the management backend. Please attach the Java version to conf/openrasp.yml, and the PHP version to the ini file. ")])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"alert alert-warning"},[this._v("\n                 Batch deployment scripts will automatically install and restart applications. For more information, please see\n                  "),a("a",{staticClass:"active router-link-active",attrs:{target:"_blank",href:"https://rasp.baidu.com/doc/install/deploy.html"}},[this._v("large scale deployment")]),this._v("\n                  Documentation\n                ")])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"alert alert-warning"},[this._v("\n                 Just add OpenRASP during the mirroring phase. For more information, please see\n                  "),a("a",{staticClass:"active router-link-active",attrs:{target:"_blank",href:"https://rasp.baidu.com/doc/install/deploy.html#container"}},[this._v("Large-scale deployment")]),this._v("\n                  文档\n                ")])},function(){var t=this.$createElement,a=this._self._c||t;return a("pre",{staticStyle:{"white-space":"inherit"}},[this._v("/path/to/tomcat/bin/shutdown.sh"),a("br"),this._v("/path/to/tomcat/bin/startup.sh")])},function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"modal-footer"},[a("a",{staticClass:"btn btn-secondary mr-auto",attrs:{href:"https://rasp.baidu.com/doc/install/software.html",target:"_blank"}},[this._v("\n            Learn more\n          ")]),this._v(" "),a("button",{staticClass:"btn btn-primary",attrs:{"data-dismiss":"modal"}},[this._v("\n           Close\n          ")])])}]},Ta={name:"Navigation",components:{AddHostModal:e("VU/8")(Ra,Ua,!1,null,null,null).exports},data:function(){return{keyword:"",no_plugin:!1,all_log:!1,is_default_password:!1,apps:[],total:0,loading:!1}},computed:E()({},Object(c.c)(["current_app","app_list","app_count","sticky"]),{app_list_filtered:function(){var t=this.keyword.toLowerCase();return""===t&&(this.total=this.app_count),this.apps.length>0?this.apps.filter(function(a){return-1!=a.name.toLowerCase().indexOf(t)}):this.app_list.filter(function(a){return-1!=a.name.toLowerCase().indexOf(t)})}}),watch:{current_app:function(t){this.no_plugin=!this.current_app.selected_plugin_id||!this.current_app.selected_plugin_id.length,this.all_log=!1,this.no_plugin||(this.all_log=this.current_app.algorithm_config.meta.all_log),this.$router.push({name:this.$route.name,params:{app_id:t.id}})},keyword:{handler:function(){var t=this;clearTimeout(this.timeout),this.timeout=setTimeout(function(){t.loadApps(t.keyword)},100)},deep:!0}},methods:E()({},Object(c.b)(["loadAppList"]),Object(c.d)(["setCurrentApp"]),Object(c.d)(["setSticky"]),{loadApps:function(t){var a=this;return this.loading=!0,this.request.post("v1/api/app/get",{name:t,page:1,perpage:50}).then(function(t){a.apps=t.data,a.total=t.total,a.loading=!1})},showAddHostModal:function(){this.$refs.addHost.showModal()},doLogout:function(){return this.request.post("v1/user/logout",{}).then(function(t){o.a.set("RASP_AUTH_ID",null),location.href="/#/login"})}}),mounted:function(){var t=this;this.request.post("v1/api/server/url/get",{}).then(function(a){if(a)if(a.panel_url)console.log("panel_url already configured");else{console.log("panel_url not set, initializing");var e=location.href.split(/\?|#/)[0];t.request.post("v1/api/server/url",{panel_url:e,agent_urls:[e]}).then(function(t){})}}),this.request.post("/v1/user/default",{}).then(function(a){a&&(t.is_default_password=a.is_default)})}},La={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("div",{staticClass:"header py-4"},[e("div",{staticClass:"container"},[e("div",{staticClass:"d-flex"},[e("div",{staticClass:"dropdown"},[e("a",{staticClass:"nav-link pr-0 leading-none",staticStyle:{"padding-left":"0"},attrs:{href:"javascript:","data-toggle":"dropdown"}},[e("span",{staticClass:"avatar",style:{"background-image":t.current_app.language?"url(/static/images/lang/"+t.current_app.language+".png)":void 0}}),t._v(" "),e("span",{staticClass:"ml-2 d-none d-lg-block"},[t._m(0),t._v(" "),e("small",{staticClass:"text-default d-block mt-1"},[t._v("\n                "+t._s(t.current_app.name)+"\n              ")])])]),t._v(" "),e("div",{staticClass:"dropdown-menu dropdown-menu-left dropdown-menu-arrow"},[e("div",{staticClass:"form-group",staticStyle:{margin:"6px 15px 10px 15px"}},[e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.keyword,expression:"keyword",modifiers:{trim:!0}}],staticClass:"form-control form-control-sm",attrs:{type:"text"},domProps:{value:t.keyword},on:{input:function(a){a.target.composing||(t.keyword=a.target.value.trim())},blur:function(a){return t.$forceUpdate()}}})]),t._v(" "),e("div",{staticStyle:{"max-height":"300px",overflow:"scroll"}},t._l(t.app_list_filtered,function(a){return e("a",{key:a.id,staticClass:"dropdown-item",attrs:{href:"javascript:"},on:{click:function(e){return e.preventDefault(),t.setCurrentApp(a)}}},[e("i",{staticClass:"dropdown-icon fe fe-lock"}),t._v("\n                "+t._s(a.name)+"\n              ")])}),0),t._v(" "),e("div",{staticClass:"dropdown-divider"}),t._v(" "),e("router-link",{class:{"dropdown-item":!0,active:!1},attrs:{to:{name:"settings",params:{setting_tab:"app"}}}},[e("i",{staticClass:"dropdown-icon fe fe-settings"}),t._v("\n              Application management ("+t._s(t.total)+")\n            ")])],1)]),t._v(" "),e("div",{staticClass:"d-flex order-lg-2 ml-auto"},[e("div",{staticClass:"nav-item d-none d-md-flex"},[e("a",{staticClass:"btn btn-sm btn-outline-primary",attrs:{href:"javascript:"},on:{click:t.showAddHostModal}},[t._v("\n              Add host\n            ")])]),t._v(" "),e("div",{staticClass:"dropdown"},[t._m(1),t._v(" "),e("div",{staticClass:"dropdown-menu dropdown-menu-right dropdown-menu-arrow",attrs:{"x-placement":"bottom-end"}},[e("RouterLink",{staticClass:"dropdown-item",attrs:{to:{name:"exceptions",params:{app_id:t.current_app.id}}}},[e("i",{staticClass:"dropdown-icon fe fe-alert-circle"}),t._v("\n                Exception log\n              ")]),t._v(" "),e("RouterLink",{staticClass:"dropdown-item",attrs:{to:{name:"crash",params:{app_id:t.current_app.id}}}},[e("i",{staticClass:"dropdown-icon fe fe-alert-triangle"}),t._v("\n                Crash information\n              ")]),t._v(" "),e("RouterLink",{staticClass:"dropdown-item",attrs:{to:{name:"audit",params:{app_id:t.current_app.id}}}},[e("i",{staticClass:"dropdown-icon fe fe-user-check"}),t._v("\n                Operation audit\n              ")]),t._v(" "),t._m(2),t._v(" "),t._m(3),t._v(" "),e("div",{staticClass:"dropdown-divider"}),t._v(" "),e("a",{staticClass:"dropdown-item",attrs:{href:"javascript:"},on:{click:function(a){return t.doLogout()}}},[e("i",{staticClass:"dropdown-icon fe fe-log-out"}),t._v(" sign out\n              ")])],1)])]),t._v(" "),t._m(4)])])]),t._v(" "),e("div",{staticClass:"header collapse d-lg-flex p-0",attrs:{id:"headerMenuCollapse"}},[e("div",{staticClass:"container"},[e("div",{staticClass:"row align-items-center"},[e("div",{staticClass:"col-lg order-lg-first"},[t.current_app.id?e("ul",{staticClass:"nav nav-tabs border-0 flex-column flex-lg-row"},[e("li",{staticClass:"nav-item"},[e("RouterLink",{staticClass:"nav-link",attrs:{to:{name:"dashboard",params:{app_id:t.current_app.id}}}},[e("i",{staticClass:"fe fe-home"}),t._v("\n                Safety overview\n              ")])],1),t._v(" "),e("li",{staticClass:"nav-item"},[e("RouterLink",{staticClass:"nav-link",attrs:{to:{name:"vulns",params:{app_id:t.current_app.id}}}},[e("i",{staticClass:"fe fe-eye"}),t._v("\n                Vulnerability list\n              ")])],1),t._v(" "),e("li",{staticClass:"nav-item"},[e("RouterLink",{staticClass:"nav-link",attrs:{to:{name:"events",params:{app_id:t.current_app.id}}}},[e("i",{staticClass:"fe fe-bell"}),t._v("\n                Attack\n              ")])],1),t._v(" "),e("li",{staticClass:"nav-item dropdown"},[e("RouterLink",{staticClass:"nav-link",attrs:{to:{name:"baseline",params:{app_id:t.current_app.id}}}},[e("i",{staticClass:"fe fe-check-square"}),t._v("\n                Security baseline\n              ")])],1),t._v(" "),e("li",{staticClass:"nav-item"},[e("RouterLink",{staticClass:"nav-link",attrs:{to:{name:"hosts",params:{app_id:t.current_app.id}}}},[e("i",{staticClass:"fe fe-cloud"}),t._v("\n                Host management\n              ")])],1),t._v(" "),e("li",{staticClass:"nav-item"},[e("RouterLink",{staticClass:"nav-link",attrs:{to:{name:"iast",params:{app_id:t.current_app.id}}}},[e("i",{staticClass:"fa fa-paper-plane-o"}),t._v("\n                scanner\n              ")])],1),t._v(" "),e("li",{staticClass:"nav-item"},[e("RouterLink",{staticClass:"nav-link",attrs:{to:{name:"plugins",params:{app_id:t.current_app.id}}}},[e("i",{staticClass:"fe fe-zap"}),t._v("\n                Plugin management\n              ")])],1),t._v(" "),e("li",{staticClass:"nav-item"},[e("RouterLink",{staticClass:"nav-link",attrs:{to:{name:"dependency",params:{app_id:t.current_app.id}}}},[e("i",{staticClass:"fe fe-code"}),t._v("\n                Class library information\n              ")])],1),t._v(" "),e("li",{staticClass:"nav-item dropdown"},[e("RouterLink",{staticClass:"nav-link",attrs:{to:{name:"settings",params:{setting_tab:"general",app_id:t.current_app.id}}}},[e("i",{staticClass:"fe fe-settings"}),t._v("\n                System settings\n              ")])],1)]):t._e()])])])]),t._v(" "),t.is_default_password?e("div",{staticClass:"alert alert-warning",staticStyle:{"margin-bottom":"0"}},[e("div",{staticClass:"container"},[t._v("\n      You have not changed the default background password, you can go to \n      "),e("router-link",{attrs:{to:{name:"settings",params:{setting_tab:"auth"}}}},[t._v("Login authentication")]),t._v(" settings\n    ")],1)]):t._e(),t._v(" "),t.no_plugin?e("div",{staticClass:"alert alert-warning"},[e("div",{staticClass:"container"},[e("strong",[t._v("Attention!")]),t._v(" The current application does not have any detection plug-ins, please go to\n      "),e("router-link",{attrs:{to:{name:"plugins"}}},[t._v("plugin page")]),t._v(" for configuration\n    ")],1)]):t._e(),t._v(" "),t.all_log?e("div",{staticClass:"alert alert-warning"},[e("div",{staticClass:"container"},[t._v('\n      Currently running in "Logging" mode, you can go to\n      '),e("router-link",{attrs:{to:{name:"settings",params:{setting_tab:"algorithm"}}}},[t._v("Protection settings")]),t._v(" Close\n    ")],1)]):t._e(),t._v(" "),e("AddHostModal",{ref:"addHost"})],1)},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("span",{staticClass:"text-muted",staticStyle:{"margin-left":"-2px"}},[this._v("\n                Current application\n                "),a("i",{staticClass:"fa fa-caret-down"})])},function(){var t=this.$createElement,a=this._self._c||t;return a("a",{staticClass:"nav-link pr-0 leading-none",attrs:{href:"javascript:","data-toggle":"dropdown"}},[a("span",{staticClass:"ml-2 d-none d-lg-block"},[a("span",{staticClass:"text-default"},[this._v("\n                  openrasp "),a("i",{staticClass:"fa fa-caret-down"})]),this._v(" "),a("small",{staticClass:"text-muted d-block mt-1"},[this._v("\n                  Administrator rights\n                ")])])])},function(){var t=this.$createElement,a=this._self._c||t;return a("a",{staticClass:"dropdown-item",attrs:{href:"https://rasp.baidu.com/doc",target:"_blank"}},[a("i",{staticClass:"dropdown-icon fe fe-file-text"}),this._v(" Help document\n              ")])},function(){var t=this.$createElement,a=this._self._c||t;return a("a",{staticClass:"dropdown-item",attrs:{href:"https://rasp.baidu.com/#section-support",target:"_blank"}},[a("i",{staticClass:"dropdown-icon fa fa-qq"}),this._v(" Technical Support\n              ")])},function(){var t=this.$createElement,a=this._self._c||t;return a("a",{staticClass:"header-toggler d-lg-none ml-3 ml-lg-0",attrs:{href:"#","data-toggle":"collapse","data-target":"#headerMenuCollapse"}},[a("span",{staticClass:"header-toggler-icon"})])}]},Oa={name:"Footer",data:function(){return{cloud:{version:"Getting",commit_id:"",build_time:""},fe:{version:"1.0.0",commit_id:"Unknown",build_time:"Unknown"}}},methods:{getVersion:function(){var t=this;this.request.post("v1/version",{}).then(function(a){t.cloud=a})}},mounted:function(){this.getVersion()}},Ia={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("footer",{staticClass:"footer"},[e("div",{staticClass:"container"},[e("div",{staticClass:"row align-items-center flex-row-reverse"},[t._m(0),t._v(" "),e("div",{staticClass:"col-12 col-lg-auto mt-3 mt-lg-0 text-center"},[t._v("\n        Copyright © 2017-2020 Baidu, Inc. "+t._s(t.cloud.version)+" ("+t._s(t.cloud.commit_id.substr(0,8))+")，Compile time "+t._s(t.cloud.build_time)+"\n      ")])])])])},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"col-auto ml-lg-auto"},[a("div",{staticClass:"row align-items-center"},[a("div",{staticClass:"col-auto"},[a("ul",{staticClass:"list-inline list-inline-dots mb-0"},[a("li",{staticClass:"list-inline-item"},[a("a",{attrs:{href:"https://rasp.baidu.com/",target:"_blank"}},[this._v("Official website")])]),this._v(" "),a("li",{staticClass:"list-inline-item"},[a("a",{attrs:{href:"https://rasp.baidu.com/#section-books",target:"_blank"}},[this._v("Best Practices")])])])])])])}]},Fa={name:"Main",components:{Navigation:e("VU/8")(Ta,La,!1,null,null,null).exports,Footer:e("VU/8")(Oa,Ia,!1,null,null,null).exports}},Ha={render:function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"page",attrs:{id:"main"}},[a("div",{staticStyle:{"min-height":"calc(100vh - 67px)"}},[a("Navigation"),this._v(" "),a("RouterView",{staticStyle:{"min-height":"100%","margin-bottom":"-50px"}})],1),this._v(" "),a("Footer",{staticStyle:{height:"67px"}})],1)},staticRenderFns:[]},za=e("VU/8")(Fa,Ha,!1,null,null,null).exports;s.default.use(r.a);var Va=new r.a({routes:[{path:"/login",name:"login",component:S},{path:"/",beforeEnter:function(t,a,e){o.a.get("RASP_AUTH_ID")?x.dispatch("loadAppList",t.params.app_id).then(function(){return e()}).catch(function(t){console.error(t),e({name:"500"})}):e({name:"login",query:{next:location.href}})},component:za,children:[{path:"dashboard/:app_id",name:"dashboard",component:z},{path:"hosts/:app_id/",name:"hosts",component:mt},{path:"audit/:app_id/",name:"audit",component:la},{path:"dependency/:app_id/",name:"dependency",component:Da},{path:"iast/:app_id/",name:"iast",component:Na},{path:"settings/:setting_tab/:app_id/",name:"settings",component:Gt},{path:"plugins/:app_id/",name:"plugins",component:na},{path:"baseline/:app_id/",name:"baseline",component:st},{path:"crash/:app_id/",name:"crash",component:ot},{path:"events/:app_id/",name:"events",component:ha},{path:"vulns/:app_id/",name:"vulns",component:ba},{path:"exceptions/:app_id/",name:"exceptions",component:xa},{path:"*",redirect:{name:"dashboard"}}]},{path:"*",redirect:{name:"dashboard"}}],linkExactActiveClass:"active"}),Ya=e("wvfG"),Ba=e.n(Ya),Wa=e("Tqaz"),Xa=(e("K3J8"),e("Jmt5"),e("9M+g"),e("kD4L"),e("lkn4"),e("x9ll"),e("fUvK"),e("f4zI"));s.default.mixin({filters:{capitalize:function(t){return t?(t=t.toString()).charAt(0).toUpperCase()+t.slice(1):""}},components:{VueLoading:Xa.VueLoading},data:function(){return{request:w}},mounted:function(){$(document).on("click.bs.dropdown.data-api",".dropdown .keep-open-on-click",function(t){t.stopPropagation()})},methods:{moment:function(){return W.a.apply(void 0,arguments)}}}),s.default.use(Ba.a),s.default.use(Wa.a),window.$=window.jQuery=e("7t+N"),s.default.config.productionTip=!1,s.default.prototype.$http=p.a,new s.default({el:"#app",router:Va,store:x,render:function(t){return t(i)}})},kD4L:function(t,a){},lkn4:function(t,a){},uslO:function(t,a,e){var s={"./af":"3CJN","./af.js":"3CJN","./ar":"3MVc","./ar-dz":"tkWw","./ar-dz.js":"tkWw","./ar-kw":"j8cJ","./ar-kw.js":"j8cJ","./ar-ly":"wPpW","./ar-ly.js":"wPpW","./ar-ma":"dURR","./ar-ma.js":"dURR","./ar-sa":"7OnE","./ar-sa.js":"7OnE","./ar-tn":"BEem","./ar-tn.js":"BEem","./ar.js":"3MVc","./az":"eHwN","./az.js":"eHwN","./be":"3hfc","./be.js":"3hfc","./bg":"lOED","./bg.js":"lOED","./bm":"hng5","./bm.js":"hng5","./bn":"aM0x","./bn-bd":"1C9R","./bn-bd.js":"1C9R","./bn.js":"aM0x","./bo":"w2Hs","./bo.js":"w2Hs","./br":"OSsP","./br.js":"OSsP","./bs":"aqvp","./bs.js":"aqvp","./ca":"wIgY","./ca.js":"wIgY","./cs":"ssxj","./cs.js":"ssxj","./cv":"N3vo","./cv.js":"N3vo","./cy":"ZFGz","./cy.js":"ZFGz","./da":"YBA/","./da.js":"YBA/","./de":"DOkx","./de-at":"8v14","./de-at.js":"8v14","./de-ch":"Frex","./de-ch.js":"Frex","./de.js":"DOkx","./dv":"rIuo","./dv.js":"rIuo","./el":"CFqe","./el.js":"CFqe","./en-au":"Sjoy","./en-au.js":"Sjoy","./en-ca":"Tqun","./en-ca.js":"Tqun","./en-gb":"hPuz","./en-gb.js":"hPuz","./en-ie":"ALEw","./en-ie.js":"ALEw","./en-il":"QZk1","./en-il.js":"QZk1","./en-in":"yJfC","./en-in.js":"yJfC","./en-nz":"dyB6","./en-nz.js":"dyB6","./en-sg":"NYST","./en-sg.js":"NYST","./eo":"Nd3h","./eo.js":"Nd3h","./es":"LT9G","./es-do":"7MHZ","./es-do.js":"7MHZ","./es-mx":"USNP","./es-mx.js":"USNP","./es-us":"INcR","./es-us.js":"INcR","./es.js":"LT9G","./et":"XlWM","./et.js":"XlWM","./eu":"sqLM","./eu.js":"sqLM","./fa":"2pmY","./fa.js":"2pmY","./fi":"nS2h","./fi.js":"nS2h","./fil":"rMbQ","./fil.js":"rMbQ","./fo":"OVPi","./fo.js":"OVPi","./fr":"tzHd","./fr-ca":"bXQP","./fr-ca.js":"bXQP","./fr-ch":"VK9h","./fr-ch.js":"VK9h","./fr.js":"tzHd","./fy":"g7KF","./fy.js":"g7KF","./ga":"U5Iz","./ga.js":"U5Iz","./gd":"nLOz","./gd.js":"nLOz","./gl":"FuaP","./gl.js":"FuaP","./gom-deva":"VGQH","./gom-deva.js":"VGQH","./gom-latn":"+27R","./gom-latn.js":"+27R","./gu":"rtsW","./gu.js":"rtsW","./he":"Nzt2","./he.js":"Nzt2","./hi":"ETHv","./hi.js":"ETHv","./hr":"V4qH","./hr.js":"V4qH","./hu":"xne+","./hu.js":"xne+","./hy-am":"GrS7","./hy-am.js":"GrS7","./id":"yRTJ","./id.js":"yRTJ","./is":"upln","./is.js":"upln","./it":"FKXc","./it-ch":"/E8D","./it-ch.js":"/E8D","./it.js":"FKXc","./ja":"ORgI","./ja.js":"ORgI","./jv":"JwiF","./jv.js":"JwiF","./ka":"RnJI","./ka.js":"RnJI","./kk":"j+vx","./kk.js":"j+vx","./km":"5j66","./km.js":"5j66","./kn":"gEQe","./kn.js":"gEQe","./ko":"eBB/","./ko.js":"eBB/","./ku":"kI9l","./ku.js":"kI9l","./ky":"6cf8","./ky.js":"6cf8","./lb":"z3hR","./lb.js":"z3hR","./lo":"nE8X","./lo.js":"nE8X","./lt":"/6P1","./lt.js":"/6P1","./lv":"jxEH","./lv.js":"jxEH","./me":"svD2","./me.js":"svD2","./mi":"gEU3","./mi.js":"gEU3","./mk":"Ab7C","./mk.js":"Ab7C","./ml":"oo1B","./ml.js":"oo1B","./mn":"CqHt","./mn.js":"CqHt","./mr":"5vPg","./mr.js":"5vPg","./ms":"ooba","./ms-my":"G++c","./ms-my.js":"G++c","./ms.js":"ooba","./mt":"oCzW","./mt.js":"oCzW","./my":"F+2e","./my.js":"F+2e","./nb":"FlzV","./nb.js":"FlzV","./ne":"/mhn","./ne.js":"/mhn","./nl":"3K28","./nl-be":"Bp2f","./nl-be.js":"Bp2f","./nl.js":"3K28","./nn":"C7av","./nn.js":"C7av","./oc-lnc":"KOFO","./oc-lnc.js":"KOFO","./pa-in":"pfs9","./pa-in.js":"pfs9","./pl":"7LV+","./pl.js":"7LV+","./pt":"ZoSI","./pt-br":"AoDM","./pt-br.js":"AoDM","./pt.js":"ZoSI","./ro":"wT5f","./ro.js":"wT5f","./ru":"ulq9","./ru.js":"ulq9","./sd":"fW1y","./sd.js":"fW1y","./se":"5Omq","./se.js":"5Omq","./si":"Lgqo","./si.js":"Lgqo","./sk":"OUMt","./sk.js":"OUMt","./sl":"2s1U","./sl.js":"2s1U","./sq":"V0td","./sq.js":"V0td","./sr":"f4W3","./sr-cyrl":"c1x4","./sr-cyrl.js":"c1x4","./sr.js":"f4W3","./ss":"7Q8x","./ss.js":"7Q8x","./sv":"Fpqq","./sv.js":"Fpqq","./sw":"DSXN","./sw.js":"DSXN","./ta":"+7/x","./ta.js":"+7/x","./te":"Nlnz","./te.js":"Nlnz","./tet":"gUgh","./tet.js":"gUgh","./tg":"5SNd","./tg.js":"5SNd","./th":"XzD+","./th.js":"XzD+","./tk":"+WRH","./tk.js":"+WRH","./tl-ph":"3LKG","./tl-ph.js":"3LKG","./tlh":"m7yE","./tlh.js":"m7yE","./tr":"k+5o","./tr.js":"k+5o","./tzl":"iNtv","./tzl.js":"iNtv","./tzm":"FRPF","./tzm-latn":"krPU","./tzm-latn.js":"krPU","./tzm.js":"FRPF","./ug-cn":"To0v","./ug-cn.js":"To0v","./uk":"ntHu","./uk.js":"ntHu","./ur":"uSe8","./ur.js":"uSe8","./uz":"XU1s","./uz-latn":"/bsm","./uz-latn.js":"/bsm","./uz.js":"XU1s","./vi":"0X8Q","./vi.js":"0X8Q","./x-pseudo":"e/KL","./x-pseudo.js":"e/KL","./yo":"YXlc","./yo.js":"YXlc","./zh-cn":"Vz2w","./zh-cn.js":"Vz2w","./zh-hk":"ZUyn","./zh-hk.js":"ZUyn","./zh-mo":"+WA1","./zh-mo.js":"+WA1","./zh-tw":"BbgG","./zh-tw.js":"BbgG"};function n(t){return e(i(t))}function i(t){var a=s[t];if(!(a+1))throw new Error("Cannot find module '"+t+"'.");return a}n.keys=function(){return Object.keys(s)},n.resolve=i,t.exports=n,n.id="uslO"},x9ll:function(t,a){}},["NHnr"]);
//# sourceMappingURL=app.f319d3bdc698d6a07133.js.map